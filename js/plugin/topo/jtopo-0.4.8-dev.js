!
    function(window) {
        function guid() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
                return v.toString(16);
            });
        }
        function Element() {
            this.initialize = function() {
                this.elementType = "element",
                this.serializedProperties = ["elementType", "id", "topoLevel", "parentLevel", "nextLevel"],
                this.propertiesStack = [],
                this.id = guid(),
                this.nextLevel = "0"
            }
            ,
            this.distroy = function() {
            }
            ,
            this.removeHandler = function() {
            }
            ,
            this.attr = function(a, b) {
                if (null  != a && null  != b)
                    this[a] = b;
                else if (null  != a)
                    return this[a];
                return this
            }
            ,
            this.save = function() {
                var a = this
                ,
                b = {};
                this.serializedProperties.forEach(function(c) {
                    b[c] = a[c]
                }
                ),
                this.propertiesStack.push(b)
            }
            ,
            this.restore = function() {
                if (null  != this.propertiesStack && 0 != this.propertiesStack.length) {
                    var a = this
                    ,
                    b = this.propertiesStack.pop();
                    this.serializedProperties.forEach(function(c) {
                        a[c] = b[c]
                    }
                    )
                }
            }
            ,
            this.toJson = function() {
                var a = this
                ,
                b = "{"
                ,
                c = this.serializedProperties.length;
                return this.serializedProperties.forEach(function(d, e) {
                    var f = a[d];
                    if (typeof f == "number") {
                        if (d == "width" || d == "height") {
                            f = Math.round(f);
                        } else {
                            f = Math.round(f * 100) / 100;
                        }
                    }
                    "string" == typeof f && (f = '"' + f + '"'),
                    b += '"' + d + '":' + f,
                    c > e + 1 && (b += ",")
                }
                ),
                b += "}"
            }
        }
        CanvasRenderingContext2D.prototype.JTopoRoundRect = function(a, b, c, d, e) {
            "undefined" == typeof e && (e = 5),
            this.beginPath(),
            this.moveTo(a + e, b),
            this.lineTo(a + c - e, b),
            this.quadraticCurveTo(a + c, b, a + c, b + e),
            this.lineTo(a + c, b + d - e),
            this.quadraticCurveTo(a + c, b + d, a + c - e, b + d),
            this.lineTo(a + e, b + d),
            this.quadraticCurveTo(a, b + d, a, b + d - e),
            this.lineTo(a, b + e),
            this.quadraticCurveTo(a, b, a + e, b),
            this.closePath()
        },
        CanvasRenderingContext2D.prototype.JTopoDashedLineTo = function(a, b, c, d, e) {
            "undefined" == typeof e && (e = 5);
            var f = c - a
            ,
            g = d - b
            ,
            h = Math.floor(Math.sqrt(f * f + g * g))
            ,
            i = 0 >= e ? h : h / e
            ,
            j = g / h * e
            ,
            k = f / h * e;
            this.beginPath();
            for (var l = 0; i > l; l++)
                l % 2 ? this.lineTo(a + l * k, b + l * j) : this.moveTo(a + l * k, b + l * j);
            this.stroke();
            // this.closePath();
        },
        CanvasRenderingContext2D.prototype.JTopoDashedLineToMy = function(a, b, c, d, e) {
            "undefined" == typeof e && (e = 5);
            var f = c - a
            ,
            g = d - b
            ,
            h = Math.floor(Math.sqrt(f * f + g * g))
            ,
            i = 0 >= e ? h : h / e
            ,
            j = g / h * e
            ,
            k = f / h * e;
            for (var l = 0; i > l; l++)
                l % 2 ? this.lineTo(a + l * k, b + l * j) : this.moveTo(a + l * k, b + l * j);
        },
        CanvasRenderingContext2D.prototype.JTopoRoundDashedRect = function (a, b, c, d, e, f){
            "undefined" == typeof e && (e = 5),
            "undefined" == typeof f && (f = 5),
            this.moveTo(a + e, b),
            this.JTopoDashedLineToMy(a + e, b,a + c - e, b, f);
            this.quadraticCurveTo(a + c, b, a + c, b + e),
            this.JTopoDashedLineToMy(a + c, b + e,a + c, b + d - e, f);
            this.quadraticCurveTo(a + c, b + d, a + c - e, b + d),
            this.JTopoDashedLineToMy(a + c - e, b + d,a + e, b + d, f),
            this.quadraticCurveTo(a, b + d, a, b + d - e),
            this.JTopoDashedLineToMy(a, b + d - e,a, b + e, f),
            this.quadraticCurveTo(a, b, a + e, b)
        }
        ,
        JTopo = {
            version: "0.4.8",
            zIndex_Container: 1,
            zIndex_Link: 2,
            zIndex_Node: 3,
            SceneMode: {
                normal: "normal",
                drag: "drag",
                edit: "edit",
                select: "select"
            },
            MouseCursor: {
                normal: "default",
                pointer: "pointer",
                top_left: "nw-resize",
                top_center: "n-resize",
                top_right: "ne-resize",
                middle_left: "e-resize",
                middle_right: "e-resize",
                bottom_left: "ne-resize",
                bottom_center: "n-resize",
                bottom_right: "nw-resize",
                move: "move",
                open_hand: " 8 8, default",
                closed_hand: " 8 8, default"
            }
        },
        JTopo.Element = Element,
        window.JTopo = JTopo;
        var defaultImg = new Image;
        defaultImg.src = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMjEuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI0MHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCA0MCA0MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDAgNDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7b3BhY2l0eTowLjM1O2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0MXtvcGFjaXR5OjAuMjQ7ZmlsbDojRkZGRkZGO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0MntmaWxsOiM4MzgzODM7fQoJLnN0M3tvcGFjaXR5OjAuMzU7fQoJLnN0NHtvcGFjaXR5OjAuMjQ7ZmlsbDojRkZGRkZGO30KCS5zdDV7ZmlsbDojRkZGRkZGO30KPC9zdHlsZT4KPGc+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDAsNi4ydjI3LjVjMCwzLjQtMi44LDYuMy02LjMsNi4zSDYuMmMtMiwwLTMuNy0wLjktNC45LTIuM2MxLjEsMC45LDIuNCwxLjQsMy45LDEuNGgyNy41ICAgYzMuNCwwLDYuMy0yLjgsNi4zLTYuM1Y1LjNjMC0xLjUtMC41LTIuOC0xLjQtMy45QzM5LjEsMi41LDQwLDQuMyw0MCw2LjJ6Ii8+Cgk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzguNiwyLjNjLTEuMS0wLjktMi40LTEuNC0zLjktMS40SDcuMmMtMy40LDAtNi4zLDIuOC02LjMsNi4zdjI3LjVjMCwxLjUsMC41LDIuOCwxLjQsMy45ICAgQzAuOSwzNy41LDAsMzUuNywwLDMzLjdWNi4yYzAtMy40LDIuOC02LjMsNi4zLTYuM2gyNy41QzM1LjcsMCwzNy41LDAuOSwzOC42LDIuM3oiLz4KPC9nPgo8Zz4KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik00MCwzMy44YzAsMy41LTIuNyw2LjItNi4yLDYuMkg2LjNDMi45LDQwLDAsMzcuMiwwLDMzLjhWNi4zQzAsMi44LDIuOSwwLDYuMywwaDI3LjVDMzcuMywwLDQwLDIuOCw0MCw2LjMgICBWMzMuOHoiLz4KPC9nPgo8Zz4KCTxwYXRoIGNsYXNzPSJzdDMiIGQ9Ik00MCw2LjN2MjcuNWMwLDMuNC0yLjgsNi4zLTYuMyw2LjNINi4zYy0yLDAtMy43LTAuOS00LjktMi4zYzEuMSwwLjksMi40LDEuNCwzLjksMS40aDI3LjUgICBjMy40LDAsNi4zLTIuOCw2LjMtNi4zVjUuM2MwLTEuNS0wLjUtMi44LTEuNC0zLjlDMzkuMSwyLjUsNDAsNC4zLDQwLDYuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zOC42LDIuM2MtMS4xLTAuOS0yLjQtMS40LTMuOS0xLjRINy4yYy0zLjQsMC02LjMsMi44LTYuMyw2LjN2MjcuNWMwLDEuNSwwLjUsMi44LDEuNCwzLjkgICBDMC45LDM3LjUsMCwzNS43LDAsMzMuOFY2LjNDMCwyLjgsMi44LDAsNi4zLDBoMjcuNUMzNS43LDAsMzcuNSwwLjksMzguNiwyLjN6Ii8+CjwvZz4KPGc+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTguMSwxMy40YzAsMCwwLDAuOCwwLjgsMC44YzAuOCwwLDAuOC0wLjcsMC44LTAuOFY4LjZjMC0wLjksMC43LTEuNiwxLjYtMS42SDE2YzAsMCwwLjgsMCwwLjgtMC44ICAgICBjMC0wLjgtMC43LTAuOC0wLjgtMC44aC00LjhjLTEuNywwLTMuMiwxLjQtMy4yLDMuMlYxMy40IE0zMS4yLDE0LjJjMC44LDAsMC44LTAuNywwLjgtMC44VjguNmMwLTEuNy0xLjQtMy4yLTMuMi0zLjJIMjQgICAgIGMwLDAtMC44LDAtMC44LDAuOEMyMy4yLDcsMjQsNywyNCw3aDQuOGMwLjksMCwxLjYsMC43LDEuNiwxLjZ2NC44QzMwLjQsMTMuNCwzMC40LDE0LjIsMzEuMiwxNC4yIE04LjksMTguNCAgICAgYy0wLjgsMC0wLjgsMC43LTAuOCwwLjh2NC44YzAsMS43LDEuNCwzLjIsMy4yLDMuMkgxNmMwLDAsMC44LDAsMC44LTAuOGMwLTAuOC0wLjctMC44LTAuOC0wLjhoLTQuOGMtMC45LDAtMS42LTAuNy0xLjYtMS42ICAgICB2LTQuOEM5LjYsMTkuMSw5LjYsMTguNCw4LjksMTguNCBNMzEuOSwxOS4xYzAsMCwwLTAuOC0wLjgtMC44Yy0wLjgsMC0wLjgsMC43LTAuOCwwLjh2NC44YzAsMC45LTAuNywxLjYtMS42LDEuNkgyNCAgICAgYzAsMC0wLjgsMC0wLjgsMC44YzAsMC44LDAuNywwLjgsMC44LDAuOGg0LjhjMS43LDAsMy4yLTEuNCwzLjItMy4yVjE5LjEiLz4KCQk8L2c+CgkJPGc+CgkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik0yMCwyMC4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjFjMCwwLjYsMC41LDEuMSwxLjEsMS4xYzAuNiwwLDEuMS0wLjUsMS4xLTEuMUMyMS4yLDIwLjcsMjAuNywyMC4yLDIwLDIwLjIgICAgIEwyMCwyMC4yeiBNMjIuOCwxMC45QzIyLjEsMTAuMywyMS4yLDEwLDIwLDEwYy0xLjEsMC0yLDAuMy0yLjcsMC45Yy0wLjcsMC42LTEsMS4zLTEuMSwyLjJsMS45LDAuMmMwLjEtMC42LDAuNC0xLDAuNy0xLjMgICAgIGMwLjMtMC4zLDAuOC0wLjQsMS4zLTAuNGMwLjUsMCwxLDAuMSwxLjMsMC40YzAuMywwLjMsMC41LDAuNiwwLjUsMWMwLDAuMy0wLjEsMC41LTAuMywwLjhjLTAuMSwwLjEtMC41LDAuNS0xLjEsMC45ICAgICBjLTAuNiwwLjUtMSwwLjktMS4yLDEuM2MtMC4yLDAuNC0wLjMsMC45LTAuMywxLjVjMCwwLjEsMCwwLjIsMCwwLjVoMHYxLjVoMS44VjE4aDBjMC0wLjYsMC0wLjksMC4xLTEuMiAgICAgYzAuMS0wLjIsMC40LTAuNSwwLjgtMC45YzAuOC0wLjcsMS40LTEuMiwxLjYtMS42YzAuMy0wLjQsMC40LTAuOCwwLjQtMS4zQzIzLjgsMTIuMywyMy41LDExLjYsMjIuOCwxMC45TDIyLjgsMTAuOXogTTIyLjgsMTAuOSAgICAgIi8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTcuNywzNC41di00LjdoNC40djQuNmgtMC43di0wLjJIOC40djAuMkg3Ljd6IE05LjMsMzAuNEg4LjR2MC45QzguOCwzMSw5LjEsMzAuNyw5LjMsMzAuNHogTTguNywzMS43ICAgIGMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjN2MC42YzAuNC0wLjEsMC43LTAuMSwxLTAuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjNDOSwzMS41LDguOCwzMS42LDguNywzMS43eiBNOC43LDMyLjggICAgYzAuOSwwLjEsMS43LDAuMiwyLjQsMC40TDExLDMzLjdoMC40di0xLjdjLTAuMSwwLjEtMC4yLDAuMy0wLjMsMC40Yy0wLjUtMC4xLTAuOS0wLjItMS4zLTAuNGMtMC4yLDAuMS0wLjQsMC4xLTAuNiwwLjIgICAgYzAuNSwwLjEsMS4xLDAuMSwxLjYsMC4ybC0wLjEsMC41Yy0wLjUtMC4xLTEuMS0wLjItMS44LTAuM2wwLjEtMC40Yy0wLjIsMC0wLjMsMC4xLTAuNSwwLjFjLTAuMS0wLjEtMC4xLTAuMy0wLjItMC40djEuN0gxMSAgICBjLTAuNy0wLjEtMS41LTAuMy0yLjQtMC40TDguNywzMi44eiBNMTAsMzEuNWMwLjItMC4xLDAuNC0wLjIsMC41LTAuNEg5LjVDOS42LDMxLjMsOS44LDMxLjQsMTAsMzEuNXogTTExLjMsMzAuN3YwLjQgICAgYy0wLjIsMC4yLTAuNCwwLjQtMC43LDAuNmMwLjMsMC4xLDAuNiwwLjEsMC45LDAuMnYtMS41SDEwYy0wLjEsMC4xLTAuMSwwLjItMC4yLDAuM0gxMS4zeiIvPgoJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik0xNS41LDI5LjZoMC43djEuM2gxLjJ2MC42SDE0YzAsMC4yLDAsMC40LDAsMC42aDIuNXYyLjNoLTAuN3YtMS42aC0xLjhjLTAuMSwwLjctMC40LDEuMi0wLjgsMS43ICAgIGMtMC4yLTAuMi0wLjQtMC40LTAuNi0wLjZjMC41LTAuNSwwLjgtMS4yLDAuOC0yLjR2LTEuOUgxNHYxLjJoMS40VjI5LjZ6Ii8+CgkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTE3LjcsMzEuNmgyVjMxaC0xLjd2LTAuNmgxLjd2LTAuN2gwLjd2MC43aDEuOFYzMWgtMS44djAuNmgydjAuNmgtMS44YzAuNSwwLjYsMS4xLDEsMS45LDEuMyAgICBjLTAuMiwwLjItMC4zLDAuNC0wLjUsMC42Yy0wLjYtMC40LTEuMi0wLjgtMS42LTEuNHYxLjdoLTAuN3YtMS43Yy0wLjQsMC41LTAuOSwxLTEuNiwxLjRjLTAuMi0wLjItMC4zLTAuNC0wLjUtMC42ICAgIGMwLjgtMC40LDEuNC0wLjgsMS45LTEuNGgtMS44VjMxLjZ6Ii8+CgkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTI0LjMsMzIuN2MwLDAuMywwLjEsMC42LDAuMSwwLjdjLTAuNSwwLjMtMC44LDAuNi0xLDAuOUwyMywzMy44YzAuMS0wLjEsMC4xLTAuMiwwLjEtMC40di0xLjZoLTAuNXYtMC43ICAgIGgxLjJ2MS45TDI0LjMsMzIuN3ogTTIzLjQsMjkuN2MwLjIsMC4zLDAuNCwwLjYsMC43LDAuOUwyMy41LDMxYy0wLjItMC4zLTAuNC0wLjctMC42LTFMMjMuNCwyOS43eiBNMjUsMzIuN2wwLjYsMC40ICAgIGMtMC40LDAuNS0wLjgsMS0xLjEsMS40Yy0wLjItMC4yLTAuNC0wLjMtMC42LTAuNUMyNC4zLDMzLjcsMjQuNywzMy4yLDI1LDMyLjd6IE0yNC40LDI5LjloMi44djIuN2gtMi44VjI5Ljl6IE0yNi41LDMydi0xLjUgICAgaC0xLjRWMzJIMjYuNXogTTI2LjUsMzIuN2MwLjQsMC40LDAuNywwLjksMS4xLDEuM2wtMC42LDAuNGMtMC4zLTAuNS0wLjctMS0xLTEuNEwyNi41LDMyLjd6Ii8+CgkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTMwLjMsMzMuNWMwLDAuNi0wLjMsMC45LTAuOCwwLjljLTAuMSwwLTAuMywwLTAuNiwwYzAtMC4zLTAuMS0wLjUtMC4yLTAuN2MwLjIsMCwwLjQsMCwwLjUsMCAgICBjMC4yLDAsMC4zLTAuMSwwLjMtMC4zYzAsMCwwLTAuMiwwLTAuN0gyOWMtMC4xLDAuOC0wLjQsMS40LTAuOSwxLjhjLTAuMi0wLjItMC4zLTAuNC0wLjUtMC42YzAuNC0wLjMsMC42LTAuNywwLjctMS4yaC0wLjZ2LTAuNiAgICBoMC43YzAtMC4xLDAtMC4zLDAtMC4zaDAuN2MwLDAuMSwwLDAuMiwwLDAuM2gxLjJDMzAuMywzMi41LDMwLjMsMzIuOSwzMC4zLDMzLjV6IE0zMC4yLDMxLjZoLTIuNHYtMS44aDIuNFYzMS42eiBNMjkuNiwzMC40ICAgIGgtMS4xVjMxaDEuMVYzMC40eiBNMzAuNiwzMC4yaDAuNnYzLjFoLTAuNlYzMC4yeiBNMzEuNiwyOS43aDAuN3Y0YzAsMC41LTAuMiwwLjgtMC42LDAuOGMtMC4xLDAtMC40LDAtMC44LDAgICAgYzAtMC4xLTAuMS0wLjQtMC4yLTAuN2MwLjMsMCwwLjUsMCwwLjcsMGMwLjIsMCwwLjItMC4xLDAuMi0wLjNWMjkuN3oiLz4KCTwvZz4KPC9nPgo8L3N2Zz4=';
        var faultEventImage = new Image;
        faultEventImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjQ0cHgiIGhlaWdodD0iNDRweCIgdmlld0JveD0iMCAwIDQ0IDQ0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NCA0NDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgo8IVtDREFUQVsNCgkuc3Qwe29wYWNpdHk6MDtmaWxsOiNGRkZGRkY7fQ0KCS5zdDF7ZmlsbDojRjQzQjNCO30NCgkuc3Qye2ZpbGw6I0ZGRkZGRjt9DQpdXT4KPC9zdHlsZT4KPHJlY3QgY2xhc3M9InN0MCIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjQ0Ii8+CjxnPgoJPHBhdGggY2xhc3M9InN0MSIgZD0iTTQxLjksNDEuMkgyLjFjLTEuNiwwLTIuNi0xLjctMS44LTMuMUwyMC4yLDMuOWMwLjgtMS40LDIuOC0xLjQsMy42LDBMNDMuNywzOEM0NC41LDM5LjQsNDMuNSw0MS4yLDQxLjksNDEuMiAgIHoiLz4KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0yMi4xLDI5LjRjLTAuOSwwLTEuNy0wLjgtMS43LTEuN1YxNC4zYzAtMC45LDAuOC0xLjcsMS43LTEuN2MwLjksMCwxLjcsMC44LDEuNywxLjd2MTMuNSAgIEMyMy44LDI4LjYsMjMuMSwyOS40LDIyLjEsMjkuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0yMi4xLDM2LjFjLTAuNCwwLTAuOS0wLjItMS4yLTAuNWMtMC4zLTAuMy0wLjUtMC44LTAuNS0xLjJjMC0wLjQsMC4yLTAuOSwwLjUtMS4yYzAuNi0wLjYsMS43LTAuNiwyLjQsMCAgIGMwLjMsMC4zLDAuNSwwLjgsMC41LDEuMmMwLDAuNC0wLjIsMC45LTAuNSwxLjJDMjMsMzUuOSwyMi42LDM2LjEsMjIuMSwzNi4xeiIvPgo8L2c+Cjwvc3ZnPg==";
        var performEventImage = new Image;
        performEventImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjQ0cHgiIGhlaWdodD0iNDRweCIgdmlld0JveD0iMCAwIDQ0IDQ0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NCA0NDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgo8IVtDREFUQVsNCgkuc3Qwe29wYWNpdHk6MDtmaWxsOiNGRkZGRkY7fQ0KCS5zdDF7ZmlsbDojRUZDNDFBO30NCgkuc3Qye2ZpbGw6I0ZGRkZGRjt9DQpdXT4KPC9zdHlsZT4KPHJlY3QgY2xhc3M9InN0MCIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjQ0Ii8+CjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjIyIiBjeT0iMjIiIHI9IjIxIi8+CjxnPgoJPHBhdGggY2xhc3M9InN0MiIgZD0iTTIyLDI3Yy0wLjksMC0xLjctMC44LTEuNy0xLjdWMTEuOWMwLTAuOSwwLjgtMS43LDEuNy0xLjdjMC45LDAsMS43LDAuOCwxLjcsMS43djEzLjUgICBDMjMuNywyNi4zLDIyLjksMjcsMjIsMjd6Ii8+Cgk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNMjIsMzMuOGMtMC40LDAtMC45LTAuMi0xLjItMC41Yy0wLjMtMC4zLTAuNS0wLjgtMC41LTEuMmMwLTAuNCwwLjItMC45LDAuNS0xLjJjMC42LTAuNiwxLjctMC42LDIuNCwwICAgYzAuMywwLjMsMC41LDAuOCwwLjUsMS4yYzAsMC40LTAuMiwwLjktMC41LDEuMkMyMi45LDMzLjYsMjIuNSwzMy44LDIyLDMzLjh6Ii8+CjwvZz4KPC9zdmc+";
        var normalImage = new Image;
        normalImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxOHB4IiBoZWlnaHQ9IjE4cHgiIHZpZXdCb3g9IjEgLTEgMTggMTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMSAtMSAxOCAxODsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMV8pO30KCS5zdDJ7ZmlsbDp1cmwoI1NWR0lEXzJfKTt9Cgkuc3Qze29wYWNpdHk6MC41NTtmaWxsOnVybCgjU1ZHSURfM18pO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NHtvcGFjaXR5OjAuNTU7ZmlsbDp1cmwoI1NWR0lEXzRfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KPC9zdHlsZT4KPGc+Cgk8Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSIxMCIgY3k9IjgiIHI9IjgiLz4KCQoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTAiIHkxPSIxIiB4Mj0iMTAiIHkyPSIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDE2KSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNTFBNjJBIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojNjRDQzM0Ii8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QxIiBjeD0iMTAiIGN5PSI4IiByPSI3Ii8+CgkKCQk8cmFkaWFsR3JhZGllbnQgaWQ9IlNWR0lEXzJfIiBjeD0iMTAiIGN5PSI4Ljc1IiByPSI2LjI1IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMTYpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNjRDQzM0Ii8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCNUI1O3N0b3Atb3BhY2l0eTowIi8+Cgk8L3JhZGlhbEdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMTAiIGN5PSI3LjMiIHI9IjYuMyIvPgoJCgkJPHJhZGlhbEdyYWRpZW50IGlkPSJTVkdJRF8zXyIgY3g9IjEwLjIwNiIgY3k9IjkuOTA5NiIgcj0iNi4xMjcyIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMjU5NyAwIDAgLTAuOTYyNiAtMi44NTY1IDE1LjQzOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUI1QjU7c3RvcC1vcGFjaXR5OjAiLz4KCTwvcmFkaWFsR3JhZGllbnQ+Cgk8ZWxsaXBzZSBjbGFzcz0ic3QzIiBjeD0iMTAiIGN5PSI1LjkiIHJ4PSI3LjciIHJ5PSI1LjkiLz4KCQoJCTxyYWRpYWxHcmFkaWVudCBpZD0iU1ZHSURfNF8iIGN4PSIxMC4yMDYiIGN5PSIxMC41NjMyIiByPSI0LjE0MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMS4yNTk3IDAgMCAtMC45NjI2IC0yLjg1NjUgMTUuNDM5KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6I0ZGRkZGRiIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0I1QjVCNTtzdG9wLW9wYWNpdHk6MCIvPgoJPC9yYWRpYWxHcmFkaWVudD4KCTxlbGxpcHNlIGNsYXNzPSJzdDQiIGN4PSIxMCIgY3k9IjUuMyIgcng9IjUuMiIgcnk9IjQiLz4KPC9nPgo8L3N2Zz4=";
        var unknownImage = new Image;
        unknownImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxOHB4IiBoZWlnaHQ9IjE4cHgiIHZpZXdCb3g9IjEgLTEgMTggMTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMSAtMSAxOCAxODsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMV8pO30KCS5zdDJ7ZmlsbDp1cmwoI1NWR0lEXzJfKTt9Cgkuc3Qze29wYWNpdHk6MC41NTtmaWxsOnVybCgjU1ZHSURfM18pO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NHtvcGFjaXR5OjAuNTU7ZmlsbDp1cmwoI1NWR0lEXzRfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KPC9zdHlsZT4KPGc+Cgk8Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSIxMCIgY3k9IjgiIHI9IjgiLz4KCQoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTAiIHkxPSIxIiB4Mj0iMTAiIHkyPSIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDE2KSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNkU2RDZCIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojOTY5NTkzIi8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QxIiBjeD0iMTAiIGN5PSI4IiByPSI3Ii8+CgkKCQk8cmFkaWFsR3JhZGllbnQgaWQ9IlNWR0lEXzJfIiBjeD0iMTAiIGN5PSI4Ljc1IiByPSI2LjI1IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMTYpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojOTY5NTkzIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCNUI1O3N0b3Atb3BhY2l0eTowIi8+Cgk8L3JhZGlhbEdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMTAiIGN5PSI3LjMiIHI9IjYuMyIvPgoJCgkJPHJhZGlhbEdyYWRpZW50IGlkPSJTVkdJRF8zXyIgY3g9IjEwLjIwNiIgY3k9IjkuOTA5NiIgcj0iNi4xMjcyIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMjU5NyAwIDAgLTAuOTYyNiAtMi44NTY1IDE1LjQzOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUI1QjU7c3RvcC1vcGFjaXR5OjAiLz4KCTwvcmFkaWFsR3JhZGllbnQ+Cgk8ZWxsaXBzZSBjbGFzcz0ic3QzIiBjeD0iMTAiIGN5PSI1LjkiIHJ4PSI3LjciIHJ5PSI1LjkiLz4KCQoJCTxyYWRpYWxHcmFkaWVudCBpZD0iU1ZHSURfNF8iIGN4PSIxMC4yMDYiIGN5PSIxMC41NjMyIiByPSI0LjE0MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMS4yNTk3IDAgMCAtMC45NjI2IC0yLjg1NjUgMTUuNDM5KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6I0ZGRkZGRiIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0I1QjVCNTtzdG9wLW9wYWNpdHk6MCIvPgoJPC9yYWRpYWxHcmFkaWVudD4KCTxlbGxpcHNlIGNsYXNzPSJzdDQiIGN4PSIxMCIgY3k9IjUuMyIgcng9IjUuMiIgcnk9IjQiLz4KPC9nPgo8L3N2Zz4=";
        var faultImage = new Image;
        faultImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxOHB4IiBoZWlnaHQ9IjE4cHgiIHZpZXdCb3g9IjEgLTEgMTggMTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMSAtMSAxOCAxODsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMV8pO30KCS5zdDJ7ZmlsbDp1cmwoI1NWR0lEXzJfKTt9Cgkuc3Qze29wYWNpdHk6MC41NTtmaWxsOnVybCgjU1ZHSURfM18pO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NHtvcGFjaXR5OjAuNTU7ZmlsbDp1cmwoI1NWR0lEXzRfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KPC9zdHlsZT4KPGc+Cgk8Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSIxMCIgY3k9IjgiIHI9IjgiLz4KCQoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTAiIHkxPSIxIiB4Mj0iMTAiIHkyPSIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDE2KSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojQkYzRjMyIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojRTc0QzNDIi8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QxIiBjeD0iMTAiIGN5PSI4IiByPSI3Ii8+CgkKCQk8cmFkaWFsR3JhZGllbnQgaWQ9IlNWR0lEXzJfIiBjeD0iMTAiIGN5PSI4Ljc1IiByPSI2LjI1IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMTYpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojRTc0QzNDIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCNUI1O3N0b3Atb3BhY2l0eTowIi8+Cgk8L3JhZGlhbEdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMTAiIGN5PSI3LjMiIHI9IjYuMyIvPgoJCgkJPHJhZGlhbEdyYWRpZW50IGlkPSJTVkdJRF8zXyIgY3g9IjEwLjIwNiIgY3k9IjkuOTA5NiIgcj0iNi4xMjcyIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMjU5NyAwIDAgLTAuOTYyNiAtMi44NTY1IDE1LjQzOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUI1QjU7c3RvcC1vcGFjaXR5OjAiLz4KCTwvcmFkaWFsR3JhZGllbnQ+Cgk8ZWxsaXBzZSBjbGFzcz0ic3QzIiBjeD0iMTAiIGN5PSI1LjkiIHJ4PSI3LjciIHJ5PSI1LjkiLz4KCQoJCTxyYWRpYWxHcmFkaWVudCBpZD0iU1ZHSURfNF8iIGN4PSIxMC4yMDYiIGN5PSIxMC41NjMyIiByPSI0LjE0MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMS4yNTk3IDAgMCAtMC45NjI2IC0yLjg1NjUgMTUuNDM5KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6I0ZGRkZGRiIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0I1QjVCNTtzdG9wLW9wYWNpdHk6MCIvPgoJPC9yYWRpYWxHcmFkaWVudD4KCTxlbGxpcHNlIGNsYXNzPSJzdDQiIGN4PSIxMCIgY3k9IjUuMyIgcng9IjUuMiIgcnk9IjQiLz4KPC9nPgo8L3N2Zz4=";
        var performImage = new Image;
        performImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxOHB4IiBoZWlnaHQ9IjE4cHgiIHZpZXdCb3g9IjEgLTEgMTggMTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMSAtMSAxOCAxODsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNGRkZGRkY7fQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMV8pO30KCS5zdDJ7ZmlsbDp1cmwoI1NWR0lEXzJfKTt9Cgkuc3Qze29wYWNpdHk6MC41NTtmaWxsOnVybCgjU1ZHSURfM18pO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NHtvcGFjaXR5OjAuNTU7ZmlsbDp1cmwoI1NWR0lEXzRfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KPC9zdHlsZT4KPGc+Cgk8Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSIxMCIgY3k9IjgiIHI9IjgiLz4KCQoJCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTAiIHkxPSIxIiB4Mj0iMTAiIHkyPSIxNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDE2KSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojRDk5QzJCIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZCOTMzIi8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QxIiBjeD0iMTAiIGN5PSI4IiByPSI3Ii8+CgkKCQk8cmFkaWFsR3JhZGllbnQgaWQ9IlNWR0lEXzJfIiBjeD0iMTAiIGN5PSI4Ljc1IiByPSI2LjI1IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgMTYpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZCOTMzIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCNUI1O3N0b3Atb3BhY2l0eTowIi8+Cgk8L3JhZGlhbEdyYWRpZW50PgoJPGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMTAiIGN5PSI3LjMiIHI9IjYuMyIvPgoJCgkJPHJhZGlhbEdyYWRpZW50IGlkPSJTVkdJRF8zXyIgY3g9IjEwLjIwNiIgY3k9IjkuOTA5NiIgcj0iNi4xMjcyIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMjU5NyAwIDAgLTAuOTYyNiAtMi44NTY1IDE1LjQzOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUI1QjU7c3RvcC1vcGFjaXR5OjAiLz4KCTwvcmFkaWFsR3JhZGllbnQ+Cgk8ZWxsaXBzZSBjbGFzcz0ic3QzIiBjeD0iMTAiIGN5PSI1LjkiIHJ4PSI3LjciIHJ5PSI1LjkiLz4KCQoJCTxyYWRpYWxHcmFkaWVudCBpZD0iU1ZHSURfNF8iIGN4PSIxMC4yMDYiIGN5PSIxMC41NjMyIiByPSI0LjE0MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMS4yNTk3IDAgMCAtMC45NjI2IC0yLjg1NjUgMTUuNDM5KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6I0ZGRkZGRiIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0I1QjVCNTtzdG9wLW9wYWNpdHk6MCIvPgoJPC9yYWRpYWxHcmFkaWVudD4KCTxlbGxpcHNlIGNsYXNzPSJzdDQiIGN4PSIxMCIgY3k9IjUuMyIgcng9IjUuMiIgcnk9IjQiLz4KPC9nPgo8L3N2Zz4=";
        var authorImage = new Image;
        authorImage.src = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIxIC0xIDE4IDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDEgLTEgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojRkZGRkZGO30KCS5zdDF7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9Cgkuc3Qye2ZpbGw6dXJsKCNTVkdJRF8yXyk7fQoJLnN0M3tvcGFjaXR5OjAuNTU7ZmlsbDp1cmwoI1NWR0lEXzNfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDR7b3BhY2l0eTowLjU1O2ZpbGw6dXJsKCNTVkdJRF80Xyk7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cjwvc3R5bGU+CjxnPgoJPGNpcmNsZSBjbGFzcz0ic3QwIiBjeD0iMTAiIGN5PSI4IiByPSI4Ii8+CgkKCQk8bGluZWFyR3JhZGllbnQgaWQ9IlNWR0lEXzFfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjEwIiB5MT0iMSIgeDI9IjEwIiB5Mj0iMTUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCAxNikiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzBGN0JBRCIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzEzOTdENSIvPgoJPC9saW5lYXJHcmFkaWVudD4KCTxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjEwIiBjeT0iOCIgcj0iNyIvPgoJCgkJPHJhZGlhbEdyYWRpZW50IGlkPSJTVkdJRF8yXyIgY3g9IjEwIiBjeT0iOC43NSIgcj0iNi4yNSIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDE2KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzEzOTdENSIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6I0I1QjVCNTtzdG9wLW9wYWNpdHk6MCIvPgoJPC9yYWRpYWxHcmFkaWVudD4KCTxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjEwIiBjeT0iNy4zIiByPSI2LjMiLz4KCQoJCTxyYWRpYWxHcmFkaWVudCBpZD0iU1ZHSURfM18iIGN4PSIxMC4yMDYiIGN5PSI5LjkwOTYiIHI9IjYuMTI3MiIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxLjI1OTcgMCAwIC0wLjk2MjYgLTIuODU2NSAxNS40MzkpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZGRkZGIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCNUI1O3N0b3Atb3BhY2l0eTowIi8+Cgk8L3JhZGlhbEdyYWRpZW50PgoJPGVsbGlwc2UgY2xhc3M9InN0MyIgY3g9IjEwIiBjeT0iNS45IiByeD0iNy43IiByeT0iNS45Ii8+CgkKCQk8cmFkaWFsR3JhZGllbnQgaWQ9IlNWR0lEXzRfIiBjeD0iMTAuMjA2IiBjeT0iMTAuNTYzMiIgcj0iNC4xNDA1IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMjU5NyAwIDAgLTAuOTYyNiAtMi44NTY1IDE1LjQzOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUI1QjU7c3RvcC1vcGFjaXR5OjAiLz4KCTwvcmFkaWFsR3JhZGllbnQ+Cgk8ZWxsaXBzZSBjbGFzcz0ic3Q0IiBjeD0iMTAiIGN5PSI1LjMiIHJ4PSI1LjIiIHJ5PSI0Ii8+CjwvZz4KPC9zdmc+';
        var configImage = new Image;
        configImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDE4IDE4OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6IzUwQTU1MDt9Cgkuc3Qxe2ZpbGw6dXJsKCNTVkdJRF8xXyk7fQoJLnN0MntmaWxsOnVybCgjU1ZHSURfMl8pO30KCS5zdDN7ZmlsbDojNUQ1RDVEO30KCS5zdDR7ZmlsbDojNDk4RTQ5O30KCS5zdDV7ZmlsbDp1cmwoI1NWR0lEXzNfKTt9Cgkuc3Q2e2ZpbGw6I0ZGRkZGRjt9Cgkuc3Q3e2ZpbGw6IzJFNDkyRTt9Cjwvc3R5bGU+CjxnPgoJPHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSIxMi43LDQuNiAxMi42LDQuNyA5LjksMTMuNCA4LjcsMTMuNCA4LjYsMTMuMyA2LjUsOS4yIDUuMyw5LjIgNS4zLDguMiA3LjYsOC4yIDcuNyw4LjMgNy43LDguMyAgICA5LjMsMTEuNiA5LjMsMTEuNSA5LjMsMTEuNSAxMCw5LjIgMTEuNCw0LjYgICIvPgoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTksMUM0LjYsMSwxLDQuNiwxLDlzMy42LDgsOCw4YzQuNCwwLDgtMy42LDgtOFMxMy40LDEsOSwxeiBNOSwxNS4yYy0zLjQsMC02LjItMi44LTYuMi02LjJTNS42LDIuOCw5LDIuOCAgIGMzLjQsMCw2LjIsMi44LDYuMiw2LjJTMTIuNCwxNS4yLDksMTUuMnoiLz4KCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNy45MDE1IiB5MT0iNi4xNDk5IiB4Mj0iMTIuMjEyOCIgeTI9IjEwLjU1NjQiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzVDQjg1QyIvPgoJCTxzdG9wIG9mZnNldD0iMC4xNzU4IiBzdHlsZT0ic3RvcC1jb2xvcjojQjBEMUIwIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjIwODMiIHN0eWxlPSJzdG9wLWNvbG9yOiNBNUNFQTUiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuMzY5NiIgc3R5bGU9InN0b3AtY29sb3I6IzcwQkU3MCIvPgoJCTxzdG9wIG9mZnNldD0iMC40NDg1IiBzdHlsZT0ic3RvcC1jb2xvcjojNUNCODVDIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjUxNzUiIHN0eWxlPSJzdG9wLWNvbG9yOiM2MUJBNjEiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNjAzMiIgc3R5bGU9InN0b3AtY29sb3I6IzcxQkU3MSIvPgoJCTxzdG9wIG9mZnNldD0iMC42OTc3IiBzdHlsZT0ic3RvcC1jb2xvcjojOEFDNjhBIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjc5NzkiIHN0eWxlPSJzdG9wLWNvbG9yOiNBREQwQUQiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuODA2MSIgc3R5bGU9InN0b3AtY29sb3I6I0IwRDFCMCIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzVDQjg1QyIvPgoJPC9saW5lYXJHcmFkaWVudD4KCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTIuNyw0LjYgMTIuNiw0LjcgOS45LDEzLjQgOC43LDEzLjQgOC42LDEzLjMgNi41LDkuMiA1LjMsOS4yIDUuMyw4LjIgNy42LDguMiA3LjcsOC4zIDcuNyw4LjMgICAgOS4zLDExLjYgOS4zLDExLjUgOS4zLDExLjUgMTAsOS4yIDExLjQsNC42ICAiLz4KCTxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMl8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNC4xMTUyIiB5MT0iNC4wMDc4IiB4Mj0iMTMuNzE4IiB5Mj0iMTMuODIyNSI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNUNCODVDIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjE3NTgiIHN0eWxlPSJzdG9wLWNvbG9yOiNCMEQxQjAiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuMjA4MyIgc3R5bGU9InN0b3AtY29sb3I6I0E1Q0VBNSIvPgoJCTxzdG9wIG9mZnNldD0iMC4zNjk2IiBzdHlsZT0ic3RvcC1jb2xvcjojNzBCRTcwIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjQ0ODUiIHN0eWxlPSJzdG9wLWNvbG9yOiM1Q0I4NUMiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNTE3NSIgc3R5bGU9InN0b3AtY29sb3I6IzYxQkE2MSIvPgoJCTxzdG9wIG9mZnNldD0iMC42MDMyIiBzdHlsZT0ic3RvcC1jb2xvcjojNzFCRTcxIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjY5NzciIHN0eWxlPSJzdG9wLWNvbG9yOiM4QUM2OEEiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNzk3OSIgc3R5bGU9InN0b3AtY29sb3I6I0FERDBBRCIvPgoJCTxzdG9wIG9mZnNldD0iMC44MDYxIiBzdHlsZT0ic3RvcC1jb2xvcjojQjBEMUIwIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojNUNCODVDIi8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPHBhdGggY2xhc3M9InN0MiIgZD0iTTkuMSwxLjNDOSwxLjMsOSwxLjMsOS4xLDEuM2MtMC4xLDAtMC4xLDAtMC4xLDBjLTIuMSwwLTQsMC45LTUuNCwyLjNDMi4xLDQuOSwxLjMsNi45LDEuMyw5ICAgYzAsMS42LDAuNSwzLjEsMS4zLDQuM2wwLDBjMC4yLDAuMywwLjQsMC42LDAuNywwLjljMC4yLDAuMiwwLjMsMC40LDAuNSwwLjVjMC4zLDAuMiwwLjYsMC41LDAuOSwwLjdjMCwwLDAsMCwwLDAgICBjMS4yLDAuOCwyLjcsMS4zLDQuMywxLjNIOWMyLjEsMCw0LTAuOSw1LjQtMi4zYzEuNC0xLjQsMi4zLTMuMywyLjMtNS41QzE2LjcsNC43LDEzLjMsMS4zLDkuMSwxLjN6IE05LDE1LjIgICBjLTMuNCwwLTYuMi0yLjgtNi4yLTYuMlM1LjYsMi44LDksMi44YzMuNCwwLDYuMiwyLjgsNi4yLDYuMlMxMi40LDE1LjIsOSwxNS4yeiIvPgoJPHBvbHlnb24gY2xhc3M9InN0MyIgcG9pbnRzPSIxMi43LDQuNiAxMi42LDQuNyA5LjksMTMuNCA4LjcsMTMuNCA4LjYsMTMuMyA2LjUsOS4yIDUuMyw5LjIgNS4zLDguMiA3LjYsOC4yIDcuNyw4LjMgNy43LDguMyAgICA5LjMsMTEuNiA5LjMsMTEuNSA5LjMsMTEuNSAxMCw5LjIgMTEuNCw0LjYgICIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTE2LjcsOWMwLDQuMy0zLjUsNy43LTcuNyw3LjdjMCwwLDAsMC0wLjEsMGM0LjMsMCw3LjctMy41LDcuNy03LjdjMC00LjMtMy40LTcuNy03LjctNy43YzAsMCwwLDAsMC4xLDAgICBDMTMuMywxLjMsMTYuNyw0LjcsMTYuNyw5eiIvPgoJPGc+CgkJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8zXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI1LjMxMzYiIHkxPSI5IiB4Mj0iMTIuNjg5MSIgeTI9IjkiPgoJCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNCMEQxQjAiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjExOTIiIHN0eWxlPSJzdG9wLWNvbG9yOiNBNUNFQTUiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjcxMDciIHN0eWxlPSJzdG9wLWNvbG9yOiM3MEJFNzAiLz4KCQkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojNUNCODVDIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMTEuNCw0LjZMMTAsOS4ybC0wLjcsMi4ydjBsMCwwLjFMNy43LDguM0w3LjYsOC4ySDUuM3YwLjloMS4ybDIuMSw0LjFsMC4xLDAuMWgxLjNsMi43LTguN2wwLTAuMUgxMS40eiIvPgoJPC9nPgoJPGc+CgkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTEyLjUsNC42bDAsMC4xbC0yLjcsOC41SDguNmwwLjEsMC4xaDEuM2wyLjctOC43bDAtMC4xSDEyLjV6IE02LjQsOUg1LjN2MC4xaDEuMkw2LjQsOXoiLz4KCTwvZz4KCTxnPgoJCTxwYXRoIGNsYXNzPSJzdDciIGQ9Ik0xMS40LDQuNkwxMCw5LjJsLTAuNywyLjJ2MGwwLjEsMC4ybDIuMS03aDEuMWwwLTAuMUgxMS40eiBNNy42LDguMkg1LjN2MC45aDAuMVY4LjNoMi4yTDcuNiw4LjJ6Ii8+Cgk8L2c+Cgk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNOS4xLDE2LjdDOSwxNi43LDksMTYuNyw5LjEsMTYuN2MtNC4zLDAtNy44LTMuNS03LjgtNy43YzAtNC4zLDMuNS03LjcsNy43LTcuN2MwLDAsMCwwLDAuMSwwICAgQzQuOCwxLjMsMS40LDQuNywxLjQsOUMxLjQsMTMuMyw0LjgsMTYuNyw5LjEsMTYuN3oiLz4KPC9nPgo8L3N2Zz4=";
        var unconfigImage = new Image;
        unconfigImage.src = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxOHB4IiBoZWlnaHQ9IjE4cHgiIHZpZXdCb3g9IjAgMCAxOCAxOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojOEU5NTk3O30KCS5zdDF7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9Cgkuc3Qye2ZpbGw6dXJsKCNTVkdJRF8yXyk7fQoJLnN0M3tmaWxsOnVybCgjU1ZHSURfM18pO30KCS5zdDR7ZmlsbDojNUQ1RDVEO30KCS5zdDV7ZmlsbDojODE4Njg3O30KCS5zdDZ7ZmlsbDojRkZGRkZGO30KCS5zdDd7ZmlsbDp1cmwoI1NWR0lEXzRfKTt9Cgkuc3Q4e2ZpbGw6IzIzMTgxNTt9Cjwvc3R5bGU+CjxnPgoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTkuNSwxMS45YzAuMSwwLjIsMC4yLDAuMywwLjIsMC42YzAsMC4zLTAuMSwwLjUtMC4zLDAuN2MtMC4yLDAuMi0wLjQsMC4zLTAuNywwLjNjLTAuMywwLTAuNi0wLjEtMC44LTAuMyAgIGMwLDAsMCwwLDAsMGMwLDAsMCwwLDAsMGMwLDAtMC4xLTAuMS0wLjEtMC4xbDAsMGMtMC4xLTAuMi0wLjItMC4zLTAuMi0wLjZjMC0wLjMsMC4xLTAuNSwwLjMtMC43YzAuMi0wLjIsMC41LTAuMywwLjctMC4zICAgYzAuMywwLDAuNSwwLjEsMC43LDAuM2wwLDBDOS40LDExLjgsOS40LDExLjgsOS41LDExLjlDOS41LDExLjgsOS41LDExLjgsOS41LDExLjlDOS41LDExLjksOS41LDExLjksOS41LDExLjl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTEuMyw2LjVjMCwwLjEsMCwwLjEsMCwwLjJjMCwwLjIsMCwwLjMsMCwwLjRjMCwwLjEsMCwwLjItMC4xLDAuM2MwLDAuMS0wLjEsMC4zLTAuMiwwLjQgICBjLTAuMSwwLjItMC4zLDAuNC0wLjUsMC43Yy0wLjEsMC4xLTAuMiwwLjItMC4zLDAuM2MtMC4xLDAtMC4xLDAuMS0wLjIsMC4xQzkuOSw5LDkuOCw5LjEsOS43LDkuMmMwLDAtMC4xLDAuMS0wLjEsMC4xICAgQzkuNSw5LjQsOS41LDkuNSw5LjQsOS41YzAsMC4xLTAuMSwwLjEtMC4xLDAuMWMwLDAsMCwwLjEtMC4xLDAuMWMtMC4xLDAuMS0wLjEsMC4zLTAuMSwwLjRjMCwwLDAsMC4xLDAsMC4xYzAsMC4xLDAsMC4yLDAuMSwwLjMgICBjMCwwLDAsMC4xLDAuMSwwLjFINy45YzAsMCwwLTAuMSwwLTAuMWMwLDAsMC0wLjEsMC0wLjFjMC0wLjItMC4xLTAuNC0wLjEtMC42YzAtMC4yLDAtMC40LDAuMS0wLjZjMC0wLjEsMC0wLjEsMC4xLTAuMiAgIGMwLDAsMCwwLDAsMEM4LDkuMSw4LjEsOC45LDguMiw4LjhjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjItMC4xLDAuMy0wLjJjMCwwLDAuMS0wLjEsMC4xLTAuMSAgIEM5LDgsOS4xLDcuOSw5LjIsNy45YzAuMS0wLjEsMC4xLTAuMiwwLjItMC4zYzAtMC4xLDAuMS0wLjIsMC4xLTAuMmMwLDAsMCwwLDAsMGMwLTAuMSwwLTAuMSwwLTAuMmMwLTAuMSwwLTAuMiwwLTAuMyAgIGMwLDAsMC0wLjEsMC0wLjFjMCwwLDAtMC4xLDAtMC4xYzAsMCwwLDAsMC0wLjFjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLTAuMWMwLDAsMC0wLjEtMC4xLTAuMWMwLDAsMCwwLDAtMC4xbDAsMCAgIGMwLDAtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwYzAsMCwwLDAsMCwwYzAsMCwwLDAtMC4xLDBjMCwwLDAsMC0wLjEsMEM5LDYuMiw5LDYuMSw4LjksNi4xYzAsMCwwLDAtMC4xLDBjMCwwLTAuMSwwLTAuMSwwICAgYzAsMC0wLjEsMC0wLjEsMGMwLDAtMC4xLDAtMC4xLDBjLTAuMiwwLTAuNCwwLTAuNiwwLjFjLTAuMiwwLTAuMywwLjEtMC41LDAuMkM3LjMsNi40LDcuMiw2LjUsNyw2LjZDNi45LDYuNiw2LjksNi43LDYuOCw2LjggICBjMCwwLTAuMSwwLjEtMC4xLDAuMVY1LjJDNy4zLDQuOCw4LDQuNiw4LjgsNC42YzAuOCwwLDEuNCwwLjIsMS45LDAuNmgwYzAuMSwwLjEsMC4yLDAuMSwwLjIsMC4yYzAsMCwwLDAsMCwwYzAsMCwwLjEsMC4xLDAuMSwwLjEgICBjMCwwLjEsMC4xLDAuMSwwLjEsMC4yYzAsMC4xLDAuMSwwLjEsMC4xLDAuMmMwLDAsMCwwLjEsMC4xLDAuMmMwLDAsMCwwLDAsMC4xYzAsMC4xLDAsMC4xLDAsMC4yYzAsMCwwLDAsMCwwICAgQzExLjMsNi4zLDExLjMsNi40LDExLjMsNi41eiIvPgoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTksMUM0LjYsMSwxLDQuNiwxLDljMCw0LjQsMy42LDgsOCw4YzQuNCwwLDgtMy42LDgtOEMxNyw0LjYsMTMuNCwxLDksMXogTTE1LjIsOWMwLDMuNC0yLjgsNi4yLTYuMiw2LjIgICBjLTMuNCwwLTYuMi0yLjgtNi4yLTYuMmMwLTMuNCwyLjgtNi4yLDYuMi02LjJDMTIuNCwyLjgsMTUuMiw1LjYsMTUuMiw5eiIvPgoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI4LjA2MzMiIHkxPSIxMS44MDYzIiB4Mj0iOS4zMTE3IiB5Mj0iMTMuMDgyMyI+CgkJPHN0b3Agb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojQUJCMEIxIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjE3NTgiIHN0eWxlPSJzdG9wLWNvbG9yOiNGREZERkYiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuMjI2NyIgc3R5bGU9InN0b3AtY29sb3I6I0VBRUJFRCIvPgoJCTxzdG9wIG9mZnNldD0iMC4zNzU2IiBzdHlsZT0ic3RvcC1jb2xvcjojQjVCQUJCIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjQ0ODUiIHN0eWxlPSJzdG9wLWNvbG9yOiNBMUE3QTgiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNTQyNSIgc3R5bGU9InN0b3AtY29sb3I6I0E2QUNBRCIvPgoJCTxzdG9wIG9mZnNldD0iMC42NTkyIiBzdHlsZT0ic3RvcC1jb2xvcjojQjZCQUJBIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjc4NzQiIHN0eWxlPSJzdG9wLWNvbG9yOiNDRkQwQ0YiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuODA2MSIgc3R5bGU9InN0b3AtY29sb3I6I0QzRDREMyIvPgoJCTxzdG9wIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzhGOTY5NyIvPgoJPC9saW5lYXJHcmFkaWVudD4KCTxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik05LjUsMTEuOWMwLjEsMC4yLDAuMiwwLjMsMC4yLDAuNmMwLDAuMy0wLjEsMC41LTAuMywwLjdjLTAuMiwwLjItMC40LDAuMy0wLjcsMC4zYy0wLjMsMC0wLjYtMC4xLTAuOC0wLjMgICBjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLDBjMCwwLTAuMS0wLjEtMC4xLTAuMWwwLDBjLTAuMS0wLjItMC4yLTAuMy0wLjItMC42YzAtMC4zLDAuMS0wLjUsMC4zLTAuN2MwLjItMC4yLDAuNS0wLjMsMC43LTAuMyAgIGMwLjMsMCwwLjUsMC4xLDAuNywwLjNsMCwwQzkuNCwxMS44LDkuNCwxMS44LDkuNSwxMS45QzkuNSwxMS44LDkuNSwxMS44LDkuNSwxMS45QzkuNSwxMS45LDkuNSwxMS45LDkuNSwxMS45eiIvPgoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI2Ljc4NTEiIHkxPSI1LjQ0NTQiIHgyPSIxMC40NjI1IiB5Mj0iOS4yMDQiPgoJCTxzdG9wIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6I0FCQjBCMSIvPgoJCTxzdG9wIG9mZnNldD0iMC4xNzU4IiBzdHlsZT0ic3RvcC1jb2xvcjojRkRGREZGIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjIyNjciIHN0eWxlPSJzdG9wLWNvbG9yOiNFQUVCRUQiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuMzc1NiIgc3R5bGU9InN0b3AtY29sb3I6I0I1QkFCQiIvPgoJCTxzdG9wIG9mZnNldD0iMC40NDg1IiBzdHlsZT0ic3RvcC1jb2xvcjojQTFBN0E4Ii8+CgkJPHN0b3Agb2Zmc2V0PSIwLjU0MjUiIHN0eWxlPSJzdG9wLWNvbG9yOiNBNkFDQUQiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNjU5MiIgc3R5bGU9InN0b3AtY29sb3I6I0I2QkFCQSIvPgoJCTxzdG9wIG9mZnNldD0iMC43ODc0IiBzdHlsZT0ic3RvcC1jb2xvcjojQ0ZEMENGIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjgwNjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNEM0Q0RDMiLz4KCQk8c3RvcCBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiM4Rjk2OTciLz4KCTwvbGluZWFyR3JhZGllbnQ+Cgk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNMTEuMyw2LjVjMCwwLjEsMCwwLjEsMCwwLjJjMCwwLjIsMCwwLjMsMCwwLjRjMCwwLjEsMCwwLjItMC4xLDAuM2MwLDAuMS0wLjEsMC4zLTAuMiwwLjQgICBjLTAuMSwwLjItMC4zLDAuNC0wLjUsMC43Yy0wLjEsMC4xLTAuMiwwLjItMC4zLDAuM2MtMC4xLDAtMC4xLDAuMS0wLjIsMC4xQzkuOSw5LDkuOCw5LjEsOS43LDkuMmMwLDAtMC4xLDAuMS0wLjEsMC4xICAgQzkuNSw5LjQsOS41LDkuNSw5LjQsOS41YzAsMC4xLTAuMSwwLjEtMC4xLDAuMWMwLDAsMCwwLjEtMC4xLDAuMWMtMC4xLDAuMS0wLjEsMC4zLTAuMSwwLjRjMCwwLDAsMC4xLDAsMC4xYzAsMC4xLDAsMC4yLDAuMSwwLjMgICBjMCwwLDAsMC4xLDAuMSwwLjFINy45YzAsMCwwLTAuMSwwLTAuMWMwLDAsMC0wLjEsMC0wLjFjMC0wLjItMC4xLTAuNC0wLjEtMC42YzAtMC4yLDAtMC40LDAuMS0wLjZjMC0wLjEsMC0wLjEsMC4xLTAuMiAgIGMwLDAsMCwwLDAsMEM4LDkuMSw4LjEsOC45LDguMiw4LjhjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjItMC4xLDAuMy0wLjJjMCwwLDAuMS0wLjEsMC4xLTAuMSAgIEM5LDgsOS4xLDcuOSw5LjIsNy45YzAuMS0wLjEsMC4xLTAuMiwwLjItMC4zYzAtMC4xLDAuMS0wLjIsMC4xLTAuMmMwLDAsMCwwLDAsMGMwLTAuMSwwLTAuMSwwLTAuMmMwLTAuMSwwLTAuMiwwLTAuMyAgIGMwLDAsMC0wLjEsMC0wLjFjMCwwLDAtMC4xLDAtMC4xYzAsMCwwLDAsMC0wLjFjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLTAuMWMwLDAsMC0wLjEtMC4xLTAuMWMwLDAsMCwwLDAtMC4xbDAsMCAgIGMwLDAtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwYzAsMCwwLDAsMCwwYzAsMCwwLDAtMC4xLDBjMCwwLDAsMC0wLjEsMEM5LDYuMiw5LDYuMSw4LjksNi4xYzAsMCwwLDAtMC4xLDBjMCwwLTAuMSwwLTAuMSwwICAgYzAsMC0wLjEsMC0wLjEsMGMwLDAtMC4xLDAtMC4xLDBjLTAuMiwwLTAuNCwwLTAuNiwwLjFjLTAuMiwwLTAuMywwLjEtMC41LDAuMkM3LjMsNi40LDcuMiw2LjUsNyw2LjZDNi45LDYuNiw2LjksNi43LDYuOCw2LjggICBjMCwwLTAuMSwwLjEtMC4xLDAuMVY1LjJDNy4zLDQuOCw4LDQuNiw4LjgsNC42YzAuOCwwLDEuNCwwLjIsMS45LDAuNmgwYzAuMSwwLjEsMC4yLDAuMSwwLjIsMC4yYzAsMCwwLDAsMCwwYzAsMCwwLjEsMC4xLDAuMSwwLjEgICBjMCwwLjEsMC4xLDAuMSwwLjEsMC4yYzAsMC4xLDAuMSwwLjEsMC4xLDAuMmMwLDAsMCwwLjEsMC4xLDAuMmMwLDAsMCwwLDAsMC4xYzAsMC4xLDAsMC4xLDAsMC4yYzAsMCwwLDAsMCwwICAgQzExLjMsNi4zLDExLjMsNi40LDExLjMsNi41eiIvPgoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8zXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI0LjExNTkiIHkxPSI0LjAwNiIgeDI9IjEzLjcyMDQiIHkyPSIxMy44MjI1Ij4KCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNBQkIwQjEiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuMTc1OCIgc3R5bGU9InN0b3AtY29sb3I6I0ZERkRGRiIvPgoJCTxzdG9wIG9mZnNldD0iMC4yMjY3IiBzdHlsZT0ic3RvcC1jb2xvcjojRUFFQkVEIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjM3NTYiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNUJBQkIiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNDQ4NSIgc3R5bGU9InN0b3AtY29sb3I6I0ExQTdBOCIvPgoJCTxzdG9wIG9mZnNldD0iMC41NDI1IiBzdHlsZT0ic3RvcC1jb2xvcjojQTZBQ0FEIi8+CgkJPHN0b3Agb2Zmc2V0PSIwLjY1OTIiIHN0eWxlPSJzdG9wLWNvbG9yOiNCNkJBQkEiLz4KCQk8c3RvcCBvZmZzZXQ9IjAuNzg3NCIgc3R5bGU9InN0b3AtY29sb3I6I0NGRDBDRiIvPgoJCTxzdG9wIG9mZnNldD0iMC44MDYxIiBzdHlsZT0ic3RvcC1jb2xvcjojRDNENEQzIi8+CgkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojOEY5Njk3Ii8+Cgk8L2xpbmVhckdyYWRpZW50PgoJPHBhdGggY2xhc3M9InN0MyIgZD0iTTkuMSwxLjNDOSwxLjMsOSwxLjMsOS4xLDEuM2MtMC4xLDAtMC4xLDAtMC4xLDBjLTIuMSwwLTQsMC45LTUuNCwyLjNDMi4xLDQuOSwxLjMsNi45LDEuMyw5ICAgYzAsMi4xLDAuOSw0LjEsMi4zLDUuNWMxLjQsMS40LDMuMywyLjMsNS40LDIuM2MwLDAsMCwwLDAuMSwwYzAsMCwwLDAsMC4xLDBjNC4yLDAsNy43LTMuNSw3LjctNy43QzE2LjcsNC43LDEzLjMsMS4zLDkuMSwxLjN6ICAgIE05LDE1LjJjLTMuNCwwLTYuMi0yLjgtNi4yLTYuMmMwLTMuNCwyLjgtNi4yLDYuMi02LjJjMy40LDAsNi4yLDIuOCw2LjIsNi4yQzE1LjIsMTIuNCwxMi40LDE1LjIsOSwxNS4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTkuNSwxMS45YzAuMSwwLjIsMC4yLDAuMywwLjIsMC42YzAsMC4zLTAuMSwwLjUtMC4zLDAuN2MtMC4yLDAuMi0wLjQsMC4zLTAuNywwLjNjLTAuMywwLTAuNi0wLjEtMC44LTAuMyAgIGMwLDAsMCwwLDAsMGMwLDAsMCwwLDAsMGMwLDAtMC4xLTAuMS0wLjEtMC4xbDAsMGMtMC4xLTAuMi0wLjItMC4zLTAuMi0wLjZjMC0wLjMsMC4xLTAuNSwwLjMtMC43YzAuMi0wLjIsMC41LTAuMywwLjctMC4zICAgYzAuMywwLDAuNSwwLjEsMC43LDAuM2wwLDBDOS40LDExLjgsOS40LDExLjgsOS41LDExLjlDOS41LDExLjgsOS41LDExLjgsOS41LDExLjlDOS41LDExLjksOS41LDExLjksOS41LDExLjl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMTEuMyw2LjdjMCwwLjIsMCwwLjMsMCwwLjRjMCwwLjEsMCwwLjItMC4xLDAuM2MwLDAuMS0wLjEsMC4zLTAuMiwwLjRjLTAuMSwwLjItMC4zLDAuNC0wLjUsMC43ICAgYy0wLjEsMC4xLTAuMiwwLjItMC4zLDAuM2MtMC4xLDAtMC4xLDAuMS0wLjIsMC4xQzkuOSw5LDkuOCw5LjEsOS43LDkuMmMwLDAtMC4xLDAuMS0wLjEsMC4xQzkuNSw5LjQsOS41LDkuNSw5LjQsOS41ICAgYzAsMC4xLTAuMSwwLjEtMC4xLDAuMWMwLDAsMCwwLjEtMC4xLDAuMWMtMC4xLDAuMS0wLjEsMC4zLTAuMSwwLjRjMCwwLDAsMC4xLDAsMC4xYzAsMC4xLDAsMC4yLDAuMSwwLjNjMCwwLDAsMC4xLDAuMSwwLjFINy45ICAgYzAsMCwwLTAuMSwwLTAuMWMwLDAsMC0wLjEsMC0wLjFjMC0wLjItMC4xLTAuNC0wLjEtMC42YzAtMC4yLDAtMC40LDAuMS0wLjZjMC0wLjEsMC0wLjEsMC4xLTAuMmMwLDAsMCwwLDAsMCAgIEM4LDkuMSw4LjEsOC45LDguMiw4LjhjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjEtMC4xLDAuMi0wLjJjMC4xLTAuMSwwLjItMC4xLDAuMy0wLjJjMCwwLDAuMS0wLjEsMC4xLTAuMSAgIEM5LDgsOS4xLDcuOSw5LjIsNy45YzAuMS0wLjEsMC4xLTAuMiwwLjItMC4zYzAtMC4xLDAuMS0wLjIsMC4xLTAuMmMwLDAsMCwwLDAsMGMwLTAuMSwwLTAuMSwwLTAuMmMwLTAuMSwwLTAuMiwwLTAuMyAgIGMwLDAsMC0wLjEsMC0wLjFjMCwwLDAtMC4xLDAtMC4xYzAsMCwwLDAsMC0wLjFjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLTAuMWMwLDAsMC0wLjEtMC4xLTAuMWMwLDAsMCwwLDAtMC4xbDAsMCAgIGMwLDAtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwYzAsMCwwLDAsMCwwYzAsMCwwLDAtMC4xLDBjMCwwLDAsMC0wLjEsMEM5LDYuMiw5LDYuMSw4LjksNi4xYzAsMCwwLDAtMC4xLDBjMCwwLTAuMSwwLTAuMSwwICAgYzAsMC0wLjEsMC0wLjEsMGMwLDAtMC4xLDAtMC4xLDBjLTAuMiwwLTAuNCwwLTAuNiwwLjFjLTAuMiwwLTAuMywwLjEtMC41LDAuMkM3LjMsNi40LDcuMiw2LjUsNyw2LjZDNi45LDYuNiw2LjksNi43LDYuOCw2LjggICBjMCwwLTAuMSwwLjEtMC4xLDAuMVY1LjJDNy4zLDQuOCw4LDQuNiw4LjgsNC42YzAuOCwwLDEuNCwwLjIsMS45LDAuNmgwYzAuMSwwLjEsMC4yLDAuMSwwLjIsMC4yYzAsMCwwLDAsMCwwYzAsMCwwLjEsMC4xLDAuMSwwLjEgICBjMCwwLjEsMC4xLDAuMSwwLjEsMC4yYzAsMC4xLDAuMSwwLjEsMC4xLDAuMmMwLDAsMCwwLjEsMC4xLDAuMmMwLDAsMCwwLDAsMC4xYzAsMC4xLDAsMC4xLDAsMC4yYzAsMCwwLDAsMCwwYzAsMC4xLDAsMC4xLDAsMC4yICAgQzExLjMsNi42LDExLjMsNi42LDExLjMsNi43eiIvPgoJPHBhdGggY2xhc3M9InN0NSIgZD0iTTE2LjcsOWMwLDQuMy0zLjUsNy43LTcuNyw3LjdjMCwwLDAsMC0wLjEsMGM0LjMsMCw3LjctMy41LDcuNy03LjdjMC00LjMtMy40LTcuNy03LjctNy43YzAsMCwwLDAsMC4xLDAgICBDMTMuMywxLjMsMTYuNyw0LjcsMTYuNyw5eiIvPgoJPHBhdGggY2xhc3M9InN0NiIgZD0iTTkuMSwxNi43QzksMTYuNyw5LDE2LjcsOS4xLDE2LjdjLTQuMywwLTcuOC0zLjUtNy44LTcuN2MwLTQuMywzLjUtNy43LDcuNy03LjdjMCwwLDAsMCwwLjEsMCAgIEM0LjgsMS4zLDEuNCw0LjcsMS40LDlDMS40LDEzLjMsNC44LDE2LjcsOS4xLDE2Ljd6Ii8+Cgk8Zz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9IlNWR0lEXzRfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjYuNjczOSIgeTE9IjguOTk4NyIgeDI9IjExLjMyODgiIHkyPSI4Ljk5ODciPgoJCQk8c3RvcCBvZmZzZXQ9IjAiIHN0eWxlPSJzdG9wLWNvbG9yOiNGREZERkYiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjMwNDUiIHN0eWxlPSJzdG9wLWNvbG9yOiNEOERBREMiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjc3MTQiIHN0eWxlPSJzdG9wLWNvbG9yOiNBM0E5QUEiLz4KCQkJPHN0b3Agb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojOEY5Njk3Ii8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNOS41LDExLjlDOS41LDExLjksOS41LDExLjksOS41LDExLjlDOS41LDExLjgsOS41LDExLjgsOS41LDExLjljLTAuMS0wLjEtMC4xLTAuMS0wLjEtMC4xbDAsMCAgICBjLTAuMi0wLjItMC40LTAuMy0wLjctMC4zYy0wLjMsMC0wLjUsMC4xLTAuNywwLjNjLTAuMiwwLjItMC4zLDAuNC0wLjMsMC43YzAsMC4yLDAuMSwwLjQsMC4yLDAuNmwwLDBjMCwwLDAuMSwwLjEsMC4xLDAuMSAgICBjMCwwLDAsMCwwLDBjMC4yLDAuMiwwLjUsMC4zLDAuOCwwLjNjMC4zLDAsMC41LTAuMSwwLjctMC4zYzAuMi0wLjIsMC4zLTAuNCwwLjMtMC43QzkuNywxMi4yLDkuNywxMiw5LjUsMTEuOXogTTExLjMsNi41ICAgIGMwLTAuMSwwLTAuMSwwLTAuMmMwLDAsMCwwLDAsMGMwLTAuMSwwLTAuMSwwLTAuMmMwLDAsMCwwLDAtMC4xYzAtMC4xLDAtMC4xLTAuMS0wLjJjMC0wLjEtMC4xLTAuMS0wLjEtMC4yICAgIGMwLTAuMS0wLjEtMC4xLTAuMS0wLjJjMC0wLjEtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwYy0wLjEtMC4xLTAuMS0wLjEtMC4yLTAuMmgwYy0wLjUtMC40LTEuMS0wLjYtMS45LTAuNiAgICBDOCw0LjYsNy4zLDQuOCw2LjcsNS4ydjEuN2MwLDAsMC4xLTAuMSwwLjEtMC4xQzYuOSw2LjcsNi45LDYuNiw3LDYuNmMwLjEtMC4xLDAuMy0wLjIsMC41LTAuM2MwLjItMC4xLDAuMy0wLjEsMC41LTAuMiAgICBjMC4yLTAuMSwwLjQtMC4xLDAuNi0wLjFjMCwwLDAuMSwwLDAuMSwwYzAsMCwwLjEsMCwwLjEsMGMwLDAsMC4xLDAsMC4xLDBjMCwwLDAsMCwwLjEsMGMwLjEsMCwwLjEsMCwwLjIsMC4xYzAsMCwwLDAsMC4xLDAgICAgYzAsMCwwLDAsMC4xLDBjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLDBjMCwwLDAuMSwwLjEsMC4xLDAuMWwwLDBjMCwwLDAsMCwwLDAuMWMwLDAsMCwwLjEsMC4xLDAuMWMwLDAsMCwwLDAsMC4xYzAsMCwwLDAsMCwwICAgIGMwLDAsMCwwLDAsMC4xYzAsMCwwLDAuMSwwLDAuMWMwLDAsMCwwLjEsMCwwLjFjMCwwLjEsMCwwLjIsMCwwLjNjMCwwLjEsMCwwLjEsMCwwLjJjMCwwLDAsMCwwLDBjMCwwLjEtMC4xLDAuMi0wLjEsMC4yICAgIGMwLDAuMS0wLjEsMC4yLTAuMiwwLjNDOS4xLDcuOSw5LDgsOSw4LjFjMCwwLTAuMSwwLjEtMC4xLDAuMUM4LjgsOC4zLDguNyw4LjMsOC42LDguNEM4LjUsOC41LDguNSw4LjUsOC40LDguNiAgICBDOC4zLDguNyw4LjMsOC43LDguMiw4LjhDOC4xLDguOSw4LDkuMSw3LjksOS4zYzAsMCwwLDAsMCwwYzAsMC4xLTAuMSwwLjEtMC4xLDAuMmMtMC4xLDAuMi0wLjEsMC40LTAuMSwwLjZjMCwwLjIsMCwwLjQsMC4xLDAuNiAgICBjMCwwLDAsMC4xLDAsMC4xYzAsMCwwLDAuMSwwLDAuMWgxLjVjMCwwLDAtMC4xLTAuMS0wLjFjMC0wLjEtMC4xLTAuMi0wLjEtMC4zYzAsMCwwLTAuMSwwLTAuMWMwLTAuMSwwLTAuMywwLjEtMC40ICAgIGMwLDAsMC0wLjEsMC4xLTAuMWMwLDAsMC4xLTAuMSwwLjEtMC4xYzAtMC4xLDAuMS0wLjEsMC4xLTAuMmMwLDAsMC4xLTAuMSwwLjEtMC4xQzkuOCw5LjEsOS45LDksMTAuMSw4LjljMC4xLDAsMC4xLTAuMSwwLjItMC4xICAgIGMwLjEtMC4xLDAuMi0wLjIsMC4zLTAuM2MwLjItMC4yLDAuNC0wLjQsMC41LTAuN2MwLjEtMC4xLDAuMS0wLjMsMC4yLTAuNGMwLTAuMSwwLjEtMC4yLDAuMS0wLjNjMC0wLjEsMC0wLjMsMC0wLjQgICAgQzExLjMsNi42LDExLjMsNi42LDExLjMsNi41eiIvPgoJPC9nPgoJPHBhdGggY2xhc3M9InN0OCIgZD0iTTkuNSwxMS45QzkuNSwxMS45LDkuNSwxMS44LDkuNSwxMS45Yy0wLjItMC4yLTAuNS0wLjItMC43LTAuMmMtMC4zLDAtMC41LDAuMS0wLjcsMC4zICAgYy0wLjIsMC4yLTAuMywwLjQtMC4zLDAuN2MwLDAuMiwwLjEsMC4zLDAuMiwwLjVjMCwwLDAsMCwwLjEsMC4xYzAsMCwwLDAsMCwwYzAsMCwwLDAsMCwwYzAsMC0wLjEtMC4xLTAuMS0wLjFsMCwwICAgYy0wLjEtMC4yLTAuMi0wLjMtMC4yLTAuNmMwLTAuMywwLjEtMC41LDAuMy0wLjdjMC4yLTAuMiwwLjUtMC4zLDAuNy0wLjNjMC4zLDAsMC41LDAuMSwwLjcsMC4zbDAsMEM5LjQsMTEuOCw5LjQsMTEuOCw5LjUsMTEuOSAgIEM5LjUsMTEuOCw5LjUsMTEuOCw5LjUsMTEuOUM5LjUsMTEuOSw5LjUsMTEuOSw5LjUsMTEuOXoiLz4KCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik0xMC44LDUuM0MxMC44LDUuMywxMC44LDUuMywxMC44LDUuM0MxMC44LDUuMywxMC44LDUuMywxMC44LDUuM2MtMC41LTAuNC0xLjItMC42LTItMC42ICAgYy0wLjgsMC0xLjUsMC4yLTIuMSwwLjZ2MS41YzAsMC0wLjEsMC4xLTAuMSwwLjFWNS4yQzcuMyw0LjgsOCw0LjYsOC44LDQuNmMwLjgsMCwxLjQsMC4yLDEuOSwwLjZoMGMwLDAsMC4xLDAsMC4xLDAuMSAgIGMwLDAsMCwwLDAsMEMxMC44LDUuMywxMC44LDUuMywxMC44LDUuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik05LjcsNy4xYzAsMC4yLTAuMSwwLjUtMC4yLDAuN0M5LjMsOCw5LjEsOC4yLDguNyw4LjVjLTAuNiwwLjUtMC45LDEtMC45LDEuN2MwLDAuMiwwLDAuMywwLjEsMC41ICAgYzAsMCwwLDAuMSwwLDAuMUg3LjljMCwwLDAtMC4xLDAtMC4xYzAsMCwwLTAuMSwwLTAuMWMwLTAuMi0wLjEtMC40LTAuMS0wLjZjMC0wLjIsMC0wLjQsMC4xLTAuNmMwLTAuMSwwLTAuMSwwLjEtMC4yYzAsMCwwLDAsMCwwICAgQzgsOS4xLDguMSw4LjksOC4yLDguOGMwLjEtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDAuMi0wLjIsMC4zLTAuMmMwLDAsMC4xLTAuMSwwLjEtMC4xICAgQzksOCw5LjEsNy45LDkuMiw3LjljMC4xLTAuMSwwLjEtMC4yLDAuMi0wLjNjMC0wLjEsMC4xLTAuMiwwLjEtMC4yYzAsMCwwLDAsMCwwYzAtMC4xLDAtMC4xLDAtMC4yYzAtMC4xLDAtMC4yLDAtMC4zICAgYzAsMCwwLTAuMSwwLTAuMWMwLDAsMC0wLjEsMC0wLjFjMCwwLDAsMCwwLTAuMWMwLDAsMCwwLDAsMGMwLDAsMCwwLDAtMC4xYzAsMCwwLTAuMS0wLjEtMC4xYzAsMCwwLDAsMC0wLjFjMCwwLDAsMCwwLDAgICBDOS42LDYuNiw5LjcsNi44LDkuNyw3LjF6Ii8+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNOS4yLDYuMkM5LDYsOC43LDYsOC40LDZDNy45LDYsNy4zLDYuMSw2LjgsNi41YzAsMC0wLjEsMC4xLTAuMSwwLjF2MC4yYzAsMCwwLjEtMC4xLDAuMS0wLjEgICAgQzYuOSw2LjcsNi45LDYuNiw3LDYuNmMwLjEtMC4xLDAuMy0wLjIsMC41LTAuM2MwLjItMC4xLDAuMy0wLjEsMC41LTAuMmMwLjIsMCwwLjQtMC4xLDAuNi0wLjFjMCwwLDAuMSwwLDAuMSwwYzAsMCwwLjEsMCwwLjEsMCAgICBjMCwwLDAuMSwwLDAuMSwwYzAsMCwwLDAsMC4xLDBDOSw2LjEsOSw2LjIsOS4yLDYuMkM5LjEsNi4yLDkuMiw2LjIsOS4yLDYuMkM5LjIsNi4zLDkuMiw2LjMsOS4yLDYuMkM5LjIsNi4zLDkuMiw2LjIsOS4yLDYuMnogICAgIE0xMS4zLDYuNWMwLTAuMSwwLTAuMSwwLTAuMmMwLDAsMCwwLDAsMGMwLTAuMSwwLTAuMSwwLTAuMmMwLDAsMCwwLDAtMC4xYzAtMC4xLDAtMC4xLTAuMS0wLjJjMC0wLjEtMC4xLTAuMS0wLjEtMC4yICAgIGMwLTAuMS0wLjEtMC4xLTAuMS0wLjJjMC0wLjEtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwbDAsMGMwLDAtMC4xLTAuMS0wLjEtMC4xYzAsMCwwLDAsMCwwLjFjMC4zLDAuMywwLjQsMC44LDAuNCwxLjMgICAgYzAsMC40LTAuMSwwLjgtMC4zLDEuMWMtMC4yLDAuMy0wLjUsMC43LTEsMS4xQzkuNiw5LjEsOS4zLDkuNCw5LjIsOS41Yy0wLjEsMC4yLTAuMSwwLjQtMC4xLDAuNmMwLDAuMiwwLDAuNCwwLjEsMC42SDcuOCAgICBjMCwwLDAsMCwwLDBjMCwwLDAsMC4xLDAsMC4xaDEuNWMwLDAsMC0wLjEtMC4xLTAuMWMwLTAuMS0wLjEtMC4yLTAuMS0wLjNjMCwwLDAtMC4xLDAtMC4xYzAtMC4xLDAtMC4zLDAuMS0wLjQgICAgYzAsMCwwLTAuMSwwLjEtMC4xYzAsMCwwLjEtMC4xLDAuMS0wLjFjMC0wLjEsMC4xLTAuMSwwLjEtMC4yYzAsMCwwLjEtMC4xLDAuMS0wLjFDOS44LDkuMSw5LjksOSwxMC4xLDguOWMwLjEsMCwwLjEtMC4xLDAuMi0wLjEgICAgYzAuMS0wLjEsMC4yLTAuMiwwLjMtMC4zYzAuMi0wLjIsMC40LTAuNCwwLjUtMC43YzAuMS0wLjEsMC4xLTAuMywwLjItMC40YzAtMC4xLDAtMC4yLDAuMS0wLjNjMC0wLjEsMC0wLjMsMC0wLjQgICAgQzExLjMsNi42LDExLjMsNi42LDExLjMsNi41eiBNOS41LDExLjlDOS41LDExLjksOS41LDExLjksOS41LDExLjlDOS41LDExLjgsOS41LDExLjgsOS41LDExLjljLTAuMS0wLjEtMC4xLTAuMS0wLjEtMC4xICAgIEM5LjQsMTEuOCw5LjUsMTEuOCw5LjUsMTEuOWMwLDAuMSwwLjEsMC4zLDAuMSwwLjVjMCwwLjMtMC4xLDAuNS0wLjMsMC43Yy0wLjIsMC4yLTAuNCwwLjMtMC43LDAuM2MtMC4zLDAtMC41LTAuMS0wLjctMC4yICAgIGMwLDAsMCwwLTAuMSwwYzAsMCwwLjEsMC4xLDAuMSwwLjFjMCwwLDAsMCwwLDBjMC4yLDAuMiwwLjUsMC4zLDAuOCwwLjNjMC4zLDAsMC41LTAuMSwwLjctMC4zYzAuMi0wLjIsMC4zLTAuNCwwLjMtMC43ICAgIEM5LjcsMTIuMiw5LjcsMTIsOS41LDExLjl6Ii8+Cgk8L2c+CjwvZz4KPC9zdmc+";

        JTopo.imgRepo = {
            defaultImg : defaultImg,
            faultEventImage : faultEventImage,
            performEventImage : performEventImage,
            normalImage : normalImage,
            unknownImage : unknownImage,
            faultImage : faultImage,
            performImage : performImage,
            authorImage : authorImage,
            configImage : configImage,
            unconfigImage : unconfigImage
        }
    }
    (window),
    /*mark : util*/
    function(JTopo) {
        function MessageBus(messageName) {
            var b = this;
            this.name = messageName,
                this.messageMap = {},
                this.messageCount = 0,
                this.subscribe = function(eventType, eventHandel) {
                    var d = b.messageMap[eventType];
                    null  == d && (b.messageMap[eventType] = []),
                        b.messageMap[eventType].push(eventHandel),
                        b.messageCount++
                }
                ,
                this.unsubscribe = function(eventType) {
                    var c = b.messageMap[eventType];
                    null  != c && (b.messageMap[eventType] = null ,
                        delete b.messageMap[eventType],
                        b.messageCount--)
                }
                ,
                this.publish = function(eventType, event, delay) {
                    var e = b.messageMap[eventType];
                    if (null  != e)
                        for (var f = 0; f < e.length; f++)
                            delay ? !
                                function(a, b) {
                                    setTimeout(function() {
                                            a(b)
                                        }
                                        , 10)
                                }
                                (e[f], event) : e[f](event)
                }
        }
        function getDistance(a, b, c, d) {
            var e, f;
            return null  == c && null  == d ? (e = b.x - a.x,
                f = b.y - a.y) : (e = c - a,
                f = d - b),
                Math.sqrt(e * e + f * f)
        }
        function getElementsBound(a) {
            for (var b = {
                left: Number.MAX_VALUE,
                right: Number.MIN_VALUE,
                top: Number.MAX_VALUE,
                bottom: Number.MIN_VALUE
            }, c = 0; c < a.length; c++) {
                var d = a[c];
                if(d instanceof JTopo.Link){
                    var path = d.getPath();
                    path.map(function (item){
                        b.left > item.x && (b.left = item.x/*,
                        b.leftNode = item*/),
                    b.right < item.x /*+ item.width*/ && (b.right = item.x /*+ item.width*//*,
                        b.rightNode = item*/),
                    b.top > item.y && (b.top = item.y/*,
                        b.topNode = item*/),
                    b.bottom < item.y /*+ item.height*/ && (b.bottom = item.y /*+ item.height*//*,
                        b.bottomNode = item*/)
                    })
                }else {
                    d instanceof JTopo.Link || (b.left > d.x && (b.left = d.x,
                        b.leftNode = d),
                    b.right < d.x + d.width && (b.right = d.x + d.width,
                        b.rightNode = d),
                    b.top > d.y && (b.top = d.y,
                        b.topNode = d),
                    b.bottom < d.y + d.height && (b.bottom = d.y + d.height,
                        b.bottomNode = d))
                }
            }
            return b.width = b.right - b.left,
                b.height = b.bottom - b.top,
                b
        }
        function mouseCoords(a) {
            return a = cloneEvent(a),
            a.pageX || (a.pageX = a.clientX + document.body.scrollLeft - document.body.clientLeft,
                a.pageY = a.clientY + document.body.scrollTop - document.body.clientTop),
                a
        }
        function getEventPosition(a) {
            return a = mouseCoords(a)
        }
        function rotatePoint(a, b, c, d, e) {
            var f = c - a
                ,
                g = d - b
                ,
                h = Math.sqrt(f * f + g * g)
                ,
                i = Math.atan2(g, f) + e;
            return {
                x: a + Math.cos(i) * h,
                y: b + Math.sin(i) * h
            }
        }
        function rotatePoints(a, b, c) {
            for (var d = [], e = 0; e < b.length; e++) {
                var f = rotatePoint(a.x, a.y, b[e].x, b[e].y, c);
                d.push(f)
            }
            return d
        }
        function $foreach(a, b, c) {
            function d(e) {
                e != a.length && (b(a[e]),
                    setTimeout(function() {
                            d(++e)
                        }
                        , c))
            }
            if (0 != a.length) {
                var e = 0;
                d(e)
            }
        }
        function $for(a, b, c, d) {
            function e(a) {
                a != b && (c(b),
                    setTimeout(function() {
                            e(++a)
                        }
                        , d))
            }
            if (!(a > b)) {
                var f = 0;
                e(f)
            }
        }
        function cloneEvent(a) {
            var b = {};
            for (var c in a)
                "returnValue" != c && "keyLocation" != c && (b[c] = a[c]);
            return b
        }
        function clone(a) {
            var b = {};
            for (var c in a)
                b[c] = a[c];
            return b
        }
        function isPointInRect(a, b) {
            var c = b.x
                ,
                d = b.y
                ,
                e = b.width
                ,
                f = b.height;
            return a.x > c && a.x < c + e && a.y > d && a.y < d + f
        }
        function isPointInLine(a, b, c) {
            var d = JTopo.util.getDistance(b, c)
                ,
                e = JTopo.util.getDistance(b, a)
                ,
                f = JTopo.util.getDistance(c, a)
                ,
                g = Math.abs(e + f - d) <= .5;
            return g
        }
        function removeFromArray(a, b) {
            for (var c = 0; c < a.length; c++) {
                var d = a[c];
                if (d === b) {
                    a = a.del(c);
                    break
                }
            }
            return a
        }
        function randomColor() {
            return Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random()) + "," + Math.floor(255 * Math.random())
        }
        function isIntsect() {}
        function getProperties(a, b) {
            for (var c = "", d = 0; d < b.length; d++) {
                d > 0 && (c += ",");
                var e = a[b[d]];
                "string" == typeof e ? e = '"' + e + '"' : void 0 == e && (e = null ),
                    c += b[d] + ":" + e
            }
            return c
        }
        function loadStageFromJson(json, canvas) {
            var obj = eval(json)
                ,
                stage = new JTopo.Stage(canvas);
            for (var k in stageObj)
                if ("scenes" != k)
                    stage[k] = obj[k];
                else
                    for (var scenes = obj.scenes, i = 0; i < scenes.length; i++) {
                        var sceneObj = scenes[i]
                            ,
                            scene = new JTopo.Scene(stage);
                        for (var p in sceneObj)
                            if ("elements" != p)
                                scene[p] = sceneObj[p];
                            else
                                for (var nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {
                                    var elementObj = elements[m],
                                        type = elementObj.elementType,
                                        element;
                                    "Node" == type && (element = new JTopo.Node);
                                    for (var mk in elementObj)
                                        element[mk] = elementObj[mk];
                                    nodeMap[element.text] = element,
                                        scene.add(element)
                                }
                    }
            return stage
        }
        function toJson(a) {
            var b = "backgroundColor,visible,mode,rotate,alpha,scaleX,scaleY,shadow,translateX,translateY,areaSelect,paintAll".split(",")
                ,
                c = "text,elementType,x,y,width,height,visible,alpha,rotate,scaleX,scaleY,fillColor,shadow,transformAble,zIndex,dragable,selected,showSelected,font,fontColor,textPosition,textOffsetX,textOffsetY".split(",")
                ,
                d = "{";
            d += "frames:" + a.frames,
                d += ", scenes:[";
            for (var e = 0; e < a.childs.length; e++) {
                var f = a.childs[e];
                d += "{",
                    d += getProperties(f, b),
                    d += ", elements:[";
                for (var g = 0; g < f.childs.length; g++) {
                    var h = f.childs[g];
                    g > 0 && (d += ","),
                        d += "{",
                        d += getProperties(h, c),
                        d += "}"
                }
                d += "]}"
            }
            return d += "]",
                d += "}"
        }
        function changeColor(a, b, c, d, e) {
            var d = c.split(","),
            e = parseInt(d[0]),
            f = parseInt(d[1]),
            g = parseInt(d[2]),
            h = canvas.width = b.width,
            i = canvas.height = b.height;
            a.clearRect(0, 0, canvas.width, canvas.height),
            a.drawImage(b, 0, 0);
            for (var j = a.getImageData(0, 0, b.width, b.height), k = j.data, l = 0; h > l; l++) for (var m = 0; i > m; m++) {
                var n = 4 * (l + m * h);
                0 != k[n + 3] && (null != e && (k[n + 0] += e), null != f && (k[n + 1] += f), null != g && (k[n + 2] += g))
            }
            a.putImageData(j, 0, 0, 0, 0, b.width, b.height);
            var o = canvas.toDataURL();
            return o
        }
        function genImageAlarm(a, b) {
            try {
                var c = a.src + b;
                if (alarmImageCache[c]) return alarmImageCache[c];
                var d = new Image;
                return d.src = changeColor(graphics, a, b),
                alarmImageCache[c] = d,
                d
            } catch (e) { console.error(e); return null;}
        }
        function getOffsetPosition(a) {
            if (!a)
                return {
                    left: 0,
                    top: 0
                };
            var b = 0
                ,
                c = 0;
            if ("getBoundingClientRect" in document.documentElement)
                var d = a.getBoundingClientRect()
                    ,
                    e = a.ownerDocument
                    ,
                    f = e.body
                    ,
                    g = e.documentElement
                    ,
                    h = g.clientTop || f.clientTop || 0
                    ,
                    i = g.clientLeft || f.clientLeft || 0
                    ,
                    b = d.top + (self.pageYOffset || g && g.scrollTop || f.scrollTop) - h
                    ,
                    c = d.left + (self.pageXOffset || g && g.scrollLeft || f.scrollLeft) - i;
            else
                do
                    b += a.offsetTop || 0,
                        c += a.offsetLeft || 0,
                        a = a.offsetParent;
                while (a);
            return {
                left: c,
                top: b
            }
        }
        function lineF(a, b, c, d) {
            function e(a) {
                return a * f + g
            }
            var f = (d - b) / (c - a)
                ,
                g = b - a * f;
            return e.k = f,
                e.b = g,
                e.x1 = a,
                e.x2 = c,
                e.y1 = b,
                e.y2 = d,
                e
        }
        function inRange(a, b, c) {
            var d = Math.abs(b - c)
                ,
                e = Math.abs(b - a)
                ,
                f = Math.abs(c - a)
                ,
                g = Math.abs(d - (e + f));
            return 1e-6 > g ? !0 : !1
        }
        function isPointInLineSeg(a, b, c) {
            return inRange(a, c.x1, c.x2) && inRange(b, c.y1, c.y2)
        }
        function intersection(a, b) {
            var c, d;
            return a.k == b.k ? null  : (1 / 0 == a.k || a.k == -1 / 0 ? (c = a.x1,
                d = b(a.x1)) : 1 / 0 == b.k || b.k == -1 / 0 ? (c = b.x1,
                d = a(b.x1)) : (c = (b.b - a.b) / (a.k - b.k),
                d = a(c)),
                0 == isPointInLineSeg(c, d, a) ? null  : 0 == isPointInLineSeg(c, d, b) ? null  : {
                    x: c,
                    y: d
                })
        }
        function intersectionLineBound(a, b) {
            var c = JTopo.util.lineF(b.left, b.top, b.left, b.bottom)
                ,
                d = JTopo.util.intersection(a, c);
            return null  == d && (c = JTopo.util.lineF(b.left, b.top, b.right, b.top),
                d = JTopo.util.intersection(a, c),
            null  == d && (c = JTopo.util.lineF(b.right, b.top, b.right, b.bottom),
                d = JTopo.util.intersection(a, c),
            null  == d && (c = JTopo.util.lineF(b.left, b.bottom, b.right, b.bottom),
                d = JTopo.util.intersection(a, c)))),
                d
        }
        requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
            function(a) {
                setTimeout(a, 1e3 / 24)
            }
            ,
            Array.prototype.del = function(a) {
                if ("number" != typeof a) {
                    for (var b = 0; b < this.length; b++)
                        if (this[b] === a)
                            return this.slice(0, b).concat(this.slice(b + 1, this.length));
                    return this
                }
                return 0 > a ? this : this.slice(0, a).concat(this.slice(a + 1, this.length))
            }
            ,
        [].indexOf || (Array.prototype.indexOf = function(a) {
                for (var b = 0; b < this.length; b++)
                    if (this[b] === a)
                        return b;
                return -1
            }
        ),
        window.console || (window.console = {
            log: function() {},
            info: function() {},
            debug: function() {},
            warn: function() {},
            error: function() {}
        });
        var canvas = document.createElement("canvas")
            ,
            graphics = canvas.getContext("2d")
            ,
            alarmImageCache = {};
        JTopo.util = {
            rotatePoint: rotatePoint,
            rotatePoints: rotatePoints,
            getDistance: getDistance,
            getEventPosition: getEventPosition,
            mouseCoords: mouseCoords,
            MessageBus: MessageBus,
            isFirefox: navigator.userAgent.indexOf("Firefox") > 0,
            isIE: !(!window.attachEvent || -1 !== navigator.userAgent.indexOf("Opera")),
            isChrome: null  != navigator.userAgent.toLowerCase().match(/chrome/),
            clone: clone,
            isPointInRect: isPointInRect,
            isPointInLine: isPointInLine,
            removeFromArray: removeFromArray,
            cloneEvent: cloneEvent,
            randomColor: randomColor,
            isIntsect: isIntsect,
            toJson: toJson,
            loadStageFromJson: loadStageFromJson,
            getElementsBound: getElementsBound,
            genImageAlarm: genImageAlarm,
            getOffsetPosition: getOffsetPosition,
            lineF: lineF,
            intersection: intersection,
            intersectionLineBound: intersectionLineBound
        },
            window.$for = $for,
            window.$foreach = $foreach
    }
    (JTopo),
    /*mark : stage*/
    function(JTopo) {
        function eagleEye(a) {
            return {
                hgap: 16,
                visible: !1,
                exportCanvas: document.createElement("canvas"),
                getImage: function(b, c) {
                    var d = a.getBound()
                        ,
                        e = 1
                        ,
                        f = 1;
                    this.exportCanvas.width = a.canvas.width,
                        this.exportCanvas.height = a.canvas.height,
                        null  != b && null  != c ? (this.exportCanvas.width = b,
                            this.exportCanvas.height = c,
                            e = b / d.width,
                            f = c / d.height) : (d.width > a.canvas.width && (this.exportCanvas.width = d.width),
                        d.height > a.canvas.height && (this.exportCanvas.height = d.height));
                    var g = this.exportCanvas.getContext("2d");
                    return a.childs.length > 0 && (g.save(),
                        g.clearRect(0, 0, this.exportCanvas.width, this.exportCanvas.height),
                        a.childs.forEach(function(a) {
                                1 == a.visible && (a.save(),
                                    a.translateX = 0,
                                    a.translateY = 0,
                                    a.scaleX = 1,
                                    a.scaleY = 1,
                                    g.scale(e, f),
                                d.left < 0 && (a.translateX = Math.abs(d.left)),
                                d.top < 0 && (a.translateY = Math.abs(d.top)),
                                    a.paintAll = !0,
                                    a.repaint(g),
                                    a.paintAll = !1,
                                    a.restore())
                            }
                        ),
                        g.restore()),
                        this.exportCanvas.toDataURL("image/png")
                },
                canvas: document.createElement("canvas"),
                update: function() {
                    this.eagleImageDatas = this.getData(a)
                },
                setSize: function(a, b) {
                    this.width = this.canvas.width = a,
                        this.height = this.canvas.height = b
                },
                getData: function(b, c) {
                    function d(a) {
                        var b = a.stage.canvas.width
                            ,
                            c = a.stage.canvas.height
                            ,
                            d = b / a.scaleX / 2
                            ,
                            e = c / a.scaleY / 2;
                        return {
                            translateX: a.translateX + d - d * a.scaleX,
                            translateY: a.translateY + e - e * a.scaleY
                        }
                    }
                    null  != j && null  != k ? this.setSize(b, c) : this.setSize(200, 160);
                    var e = this.canvas.getContext("2d");
                    if (a.childs.length > 0) {
                        e.save(),
                            e.clearRect(0, 0, this.canvas.width, this.canvas.height),
                            a.childs.forEach(function(a) {
                                    1 == a.visible && (a.save(),
                                        a.centerAndZoom(null , null , e),
                                        a.repaint(e),
                                        a.restore())
                                }
                            );
                        var f = d(a.childs[0])
                            ,
                            g = f.translateX * (this.canvas.width / a.canvas.width) * a.childs[0].scaleX
                            ,
                            h = f.translateY * (this.canvas.height / a.canvas.height) * a.childs[0].scaleY
                            ,
                            i = a.getBound()
                            ,
                            j = a.canvas.width / a.childs[0].scaleX / i.width
                            ,
                            k = a.canvas.height / a.childs[0].scaleY / i.height;
                        j > 1 && (j = 1),
                        k > 1 && (j = 1),
                            g *= j,
                            h *= k,
                        i.left < 0 && (g -= Math.abs(i.left) * (this.width / i.width)),
                        i.top < 0 && (h -= Math.abs(i.top) * (this.height / i.height)),
                            e.save(),
                            e.lineWidth = 1,
                            e.strokeStyle = "rgba(0,255,0,1)";
                        //画鹰眼区拖放的长方形小块
                        e.strokeRect(-g, -h, e.canvas.width * j, e.canvas.height * k),
                            e.restore();
                        var l = null ;
                        try {
                            l = e.getImageData(0, 0, e.canvas.width, e.canvas.height)
                        } catch (m) {}
                        return l
                    }
                    return null
                },
                paint: function() {
                    if (null  != this.eagleImageDatas) {
                        var b = a.graphics;
                        b.save(),
                            b.fillStyle = "rgba(211,211,211,0.3)",
                            b.fillRect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1),
                            b.fill(),
                            b.save(),
                            b.lineWidth = 1,
                            b.strokeStyle = "rgba(0,0,0,1)",
                            b.rect(a.canvas.width - this.canvas.width - 2 * this.hgap, a.canvas.height - this.canvas.height - 1, a.canvas.width - this.canvas.width, this.canvas.height + 1),
                            b.stroke(),
                            b.restore(),
                            b.putImageData(this.eagleImageDatas, a.canvas.width - this.canvas.width - this.hgap, a.canvas.height - this.canvas.height),
                            b.restore()
                    } else
                        this.eagleImageDatas = this.getData(a)
                },
                /**
                 * 鼠标在鹰眼区域拖拽时的动作
                 * @param a mouse系列事件名
                 * @param b event事件信息
                 * @param c stage对象
                 */
                eventHandler: function(a, b, c) {
                    var d = b.x
                        ,
                        e = b.y;
                    //操作点位于鹰眼区域
                    if (d > c.canvas.width - this.canvas.width && e > c.canvas.height - this.canvas.height) {
                        if (d = b.x - this.canvas.width,
                                e = b.y - this.canvas.height,
                            "mousedown" == a && (this.lastTranslateX = c.childs[0].translateX,
                                this.lastTranslateY = c.childs[0].translateY),
                            "mousedrag" == a && c.childs.length > 0) {
                            var f = b.dx
                                ,
                                g = b.dy
                                ,
                                h = c.getBound()
                                ,
                                i = this.canvas.width / c.childs[0].scaleX / h.width
                                ,
                                j = this.canvas.height / c.childs[0].scaleY / h.height;
                            //比例位移
                            c.childs[0].translateX = this.lastTranslateX - f / i,
                                c.childs[0].translateY = this.lastTranslateY - g / j
                        }
                    } else {
                        return;
                    }
                    ;
                }
            }
        }

        /**
         *
         * @param 事件传递顺序:stage->scene->node，事件处理相反
         * @constructor
         */
        function Stage(c) {
            /**
             * 转换原生的event对象
             * @param b event对象
             */
            function d(b) {
                var c = JTopo.util.getEventPosition(b)
                    ,
                    d = JTopo.util.getOffsetPosition(stage.canvas);
                return c.offsetLeft = c.pageX - d.left,
                    c.offsetTop = c.pageY - d.top,
                    c.x = c.offsetLeft,
                    c.y = c.offsetTop,
                    c.target = null ,
                    c
            }
            function e(a) {
                document.onselectstart = function() {
                    return !1
                }
                    ,
                    this.mouseOver = !0;
                var b = d(a);
                stage.dispatchEventToScenes("mouseover", b),
                    stage.dispatchEvent("mouseover", b)
            }
            function f(a) {
                p = setTimeout(function() {
                        o = !0
                    }
                    , 500),
                    document.onselectstart = function() {
                        return !0
                    }
                ;
                var b = d(a);
                stage.dispatchEventToScenes("mouseout", b),
                    stage.dispatchEvent("mouseout", b),
                    stage.needRepaint = 0 == stage.animate ? !1 : !0
            }
            function g(a) {
                var b = d(a);
                stage.mouseDown = !0,
                    stage.mouseDownX = b.x,
                    stage.mouseDownY = b.y,
                    stage.dispatchEventToScenes("mousedown", b),
                    stage.dispatchEvent("mousedown", b)
            }
            function h(a) {
                var b = d(a);
                stage.dispatchEventToScenes("mouseup", b),
                    stage.dispatchEvent("mouseup", b),
                    stage.mouseDown = !1,
                    stage.needRepaint = 0 == stage.animate ? !1 : !0
            }
            function i(a) {
                p && (window.clearTimeout(p),
                    p = null ),
                    o = !1;
                var b = d(a);
                stage.mouseDown ? 0 == a.button && (b.dx = b.x - stage.mouseDownX,
                    b.dy = b.y - stage.mouseDownY,
                    stage.dispatchEventToScenes("mousedrag", b),
                    stage.dispatchEvent("mousedrag", b),
                1 == stage.eagleEye.visible && stage.eagleEye.update()) : (stage.dispatchEventToScenes("mousemove", b),
                    stage.dispatchEvent("mousemove", b))
            }
            function j(a) {
                var b = d(a);
                stage.dispatchEventToScenes("click", b),
                    stage.dispatchEvent("click", b)
            }
            function k(a) {
                var b = d(a);
                stage.dispatchEventToScenes("dbclick", b),
                    stage.dispatchEvent("dbclick", b)
            }
            function l(a) {
                var b = d(a);
                stage.dispatchEventToScenes("mousewheel", b),
                    stage.dispatchEvent("mousewheel", b),
                null  != stage.wheelZoom && (a.preventDefault ? a.preventDefault() : (a = a || window.event,
                    a.returnValue = !1),
                1 == stage.eagleEye.visible && stage.eagleEye.update())
            }

            /**
             * 实现事件处理：canvas无法监听具体里面是哪个元素的事件
             * 把事件绑定到canvas对应的DOM对象，然后再用事件分发机制处理（消息总线）
             * @param b 创建Stage对象时传入的Canvas对象
             */
            function initJtopoEvent(b) {
                //事件绑定浏览器兼容性处理：非IE，用addEventlistener(type,fn,false)只监听冒泡事件,为true会监听捕获事件
                JTopo.util.isIE || !window.addEventListener ? (b.onmouseout = f,
                    b.onmouseover = e,
                    b.onmousedown = g,
                    b.onmouseup = h,
                    b.onmousemove = i,
                    b.onclick = j,
                    b.ondblclick = k,
                    b.onmousewheel = l,
                    b.touchstart = g,
                    b.touchmove = i,
                    b.touchend = h) : (b.addEventListener("mouseout", f),
                    b.addEventListener("mouseover", e),
                    b.addEventListener("mousedown", g),
                    b.addEventListener("mouseup", h),
                    b.addEventListener("mousemove", i),
                    b.addEventListener("click", j),
                    b.addEventListener("dblclick", k),
                    JTopo.util.isFirefox ? b.addEventListener("DOMMouseScroll", l) : b.addEventListener("mousewheel", l)),
                window.addEventListener && (window.addEventListener("keydown", function(b) {
                        stage.dispatchEventToScenes("keydown", JTopo.util.cloneEvent(b));
                        var c = b.keyCode;
                        (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event,
                            b.returnValue = !1))
                    }
                    , !0),
                    window.addEventListener("keyup", function(b) {
                            stage.dispatchEventToScenes("keyup", JTopo.util.cloneEvent(b));
                            var c = b.keyCode;
                            (37 == c || 38 == c || 39 == c || 40 == c) && (b.preventDefault ? b.preventDefault() : (b = b || window.event,
                                b.returnValue = !1))
                        }
                        , !0))
            }
            JTopo.stage = this;
            var stage = this;

            //Stage对象初始化方法，初始化画布，画图对象和初始状态
            this.initialize = function(c) {
                initJtopoEvent(c),
                    this.canvas = c,
                    this.id = "",
                    this.graphics = c.getContext("2d"),
                    this.childs = [],
                    this.frames = 24,
                    this.messageBus = new JTopo.util.MessageBus,
                    this.eagleEye = eagleEye(this),
                    this.wheelZoom = null ,
                    this.mouseDownX = 0,
                    this.mouseDownY = 0,
                    this.mouseDown = !1,
                    this.mouseOver = !1,
                    this.needRepaint = !0,
                    this.serializedProperties = ["wheelZoom", "width", "height", "id", "topoLevel", "parentLevel", "nextLevel"],
                    this.nextLevel = "0"
            }
                ,
            null  != c && this.initialize(c);

            var o = !0
                ,
                p = null ;
            //禁用右键菜单
            document.oncontextmenu = function() {
                return o
            }
                ,
                this.dispatchEventToScenes = function(eventType, event) {
                    //鼠标移动到鹰眼区域，触发联动位移操作
                    if (0 != this.frames && (this.needRepaint = !0),
                        1 == this.eagleEye.visible && -1 != eventType.indexOf("mouse")) {
                        var c = event.x
                            ,
                            d = event.y;
                        if (c > this.width - this.eagleEye.width && d > this.height - this.eagleEye.height)
                            return void this.eagleEye.eventHandler(eventType, event, this);
                    }
                    //对每个scene对象调用事件处理函数
                    this.childs.forEach(function(c) {
                            if (1 == c.visible) {
                                var d = c[eventType + "Handler"];
                                if (null  == d)
                                    throw new Error("Function not found:" + eventType + "Handler");
                                d.call(c, event)
                            }
                        }
                    )
                }
                ,
                this.add = function(a) {
                    for (var b = 0; b < this.childs.length; b++)
                        if (this.childs[b] === a)
                            return;
                    a.addTo(this),
                        this.childs.push(a)
                }
                ,
                this.remove = function(a) {
                    if (null  == a)
                        throw new Error("Stage.remove出错: 参数为null!");
                    for (var b = 0; b < this.childs.length; b++)
                        if (this.childs[b] === a)
                            return a.stage = null ,
                                this.childs = this.childs.del(b),
                                this;
                    return this
                }
                ,
                this.clear = function() {
                    this.childs = []
                }
                ,
                this.addEventListener = function(a, b) {
                    var c = this
                        ,
                        d = function(a) {
                            b.call(c, a)
                        }
                        ;
                    return this.messageBus.subscribe(a, d),
                        this
                }
                ,
                this.removeEventListener = function(a) {
                    this.messageBus.unsubscribe(a)
                }
                ,
                this.removeAllEventListener = function() {
                    this.messageBus = new JTopo.util.MessageBus
                }
                ,
                this.dispatchEvent = function(a, b) {
                    //执行事件处理器
                    return this.messageBus.publish(a, b),
                        this
                }
            ;
            var q = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(",")
                ,
                r = this;
            //绑定事件处理器,订阅事件
            q.forEach(function(a) {
                    r[a] = function(b) {
                        null  != b ? this.addEventListener(a, b) : this.dispatchEvent(a)
                    }
                }
            ),
                this.saveImageInfo = function(a, b) {
                    var c = this.eagleEye.getImage(a, b)
                        ,
                        d = window.open("about:blank");
                    return d.document.write("<img src='" + c + "' alt='from canvas'/>"),
                        this
                }
                ,
                this.saveAsLocalImage = function(a, b) {
                    var c = this.eagleEye.getImage(a, b);
                    return c.replace("image/png", "image/octet-stream"),
                        window.location.href = c,
                        this
                }
                ,
                this.paint = function() {
                    null  != this.canvas && (this.graphics.save(),
                        this.graphics.clearRect(0, 0, this.width, this.height),
                        this.childs.forEach(function(a) {
                                1 == a.visible && a.repaint(stage.graphics)
                            }
                        ),
                    1 == this.eagleEye.visible && this.eagleEye.paint(this),
                        this.graphics.restore())
                }
                ,
                this.repaint = function() {
                    0 != this.frames && (this.frames < 0 && 0 == this.needRepaint || (this.paint(),
                    this.frames < 0 && (this.needRepaint = !1)))
                }
                ,
                this.zoom = function(a) {
                    this.childs.forEach(function(b) {
                            0 != b.visible && b.zoom(a,a)
                        }
                    )
                }
                ,
                this.zoomOut = function(a) {
                    this.childs.forEach(function(b) {
                            0 != b.visible && b.zoomOut(a)
                        }
                    )
                }
                ,
                this.zoomIn = function(a) {
                    this.childs.forEach(function(b) {
                            0 != b.visible && b.zoomIn(a)
                        }
                    )
                }
                ,
                this.centerAndZoom = function() {
                    this.childs.forEach(function(a) {
                            0 != a.visible && a.centerAndZoom()
                        }
                    )
                }
                ,
                this.setCenter = function(a, b) {
                    var c = this;
                    this.childs.forEach(function(d) {
                            var e = a - c.canvas.width / 2
                                ,
                                f = b - c.canvas.height / 2;
                            d.translateX = -e,
                                d.translateY = -f
                        }
                    )
                }
                ,
                this.getBound = function() {
                    var a = {
                        left: Number.MAX_VALUE,
                        right: Number.MIN_VALUE,
                        top: Number.MAX_VALUE,
                        bottom: Number.MIN_VALUE
                    };
                    return this.childs.forEach(function(b) {
                            var c = b.getElementsBound();
                            c.left < a.left && (a.left = c.left,
                                a.leftNode = c.leftNode),
                            c.top < a.top && (a.top = c.top,
                                a.topNode = c.topNode),
                            c.right > a.right && (a.right = c.right,
                                a.rightNode = c.rightNode),
                            c.bottom > a.bottom && (a.bottom = c.bottom,
                                a.bottomNode = c.bottomNode)
                        }
                    ),
                        a.width = a.right - a.left,
                        a.height = a.bottom - a.top,
                        a
                }
                ,
                this.toJson = function() {
                    {
                        var b = this
                            ,
                            c = '{"version":"' + JTopo.version + '","deviceNum":"",';
                        this.serializedProperties.length
                    }
                    return this.serializedProperties.forEach(function(a) {
                            var d = b[a];
                            "string" == typeof d && (d = '"' + d + '"'),
                                c += '"' + a + '":' + d + ","
                        }
                    ),
                        c += '"childs":[',
                        this.childs.forEach(function(a) {
                                c += a.toJson()
                            }
                        ),
                        c += "]",
                        c += "}"
                }
                ,
                function() {
                    0 == stage.frames ? setTimeout(arguments.callee, 100) : stage.frames < 0 ? (stage.repaint(),
                        setTimeout(arguments.callee, 1e3 / -stage.frames)) : (stage.repaint(),
                        setTimeout(arguments.callee, 1e3 / stage.frames))
                }
                (),
                setTimeout(function() {
                        stage.mousewheel(function(a) {
                                if( (this.myTopoStyle && a.ctrlKey) || !this.myTopoStyle ){
                                    var b = null  == a.wheelDelta ? a.detail : a.wheelDelta;
                                    null  != this.wheelZoom && (b > 0 ? this.zoomIn(this.wheelZoom) : this.zoomOut(this.wheelZoom))
                                }
                            }
                        ),
                            stage.paint()
                    }
                    , 300),
                setTimeout(function() {
                        stage.paint()
                    }
                    , 1e3),
                setTimeout(function() {
                        stage.paint()
                    }
                    , 3e3)
        }
        Stage.prototype = {
            get width() {
                return this.canvas.width
            },
            get height() {
                return this.canvas.height
            },
            set cursor(a) {
                this.canvas.style.cursor = a
            },
            get cursor() {
                return this.canvas.style.cursor
            },
            set mode(a) {
                this.childs.forEach(function(b) {
                        b.mode = a
                    }
                )
            }
        },
            JTopo.Stage = Stage
    }
    (JTopo),
    /*mark : scene*/
    function(JTopo) {
        function Scene(c) {
            function d(a, b, c, d) {
                return function(e) {
                    e.beginPath(),
                        e.strokeStyle = "rgba(0,0,236,0.5)",
                        e.fillStyle = "rgba(0,0,236,0.1)",
                        e.rect(a, b, c, d),
                        e.fill(),
                        e.stroke(),
                        e.closePath()
                }
            }
            var e = this;
            this.initialize = function() {
                Scene.prototype.initialize.apply(this, arguments),
                    this.messageBus = new JTopo.util.MessageBus,
                    this.elementType = "scene",
                    this.childs = [],
                    this.zIndexMap = {},
                    this.zIndexArray = [],
                    this.backgroundColor = "255,255,255",
                    this.background = null,
                    this.gridShow = true,
                    this.gridImg = null,
                    this.visible = !0,
                    this.alpha = 0,
                    this.scaleX = 1,
                    this.scaleY = 1,
                    this.mode = JTopo.SceneMode.normal,
                    this.translate = !0,
                    this.translateX = 0,
                    this.translateY = 0,
                    this.lastTranslateX = 0,
                    this.lastTranslateY = 0,
                    this.mouseDown = !1,
                    this.mouseDownX = null ,
                    this.mouseDownY = null ,
                    this.mouseDownEvent = null ,
                    this.areaSelect = !0,
                    this.operations = [],
                    this.selectedElements = [],
                    this.paintAll = !1;
                var c = "translateX,translateY,scaleX,scaleY,totalLevel".split(",");
                this.serializedProperties = this.serializedProperties.concat(c)
            }
                ,
                this.initialize(),
                this.setBackground = function(a) {
                    this.background = a
                }
                ,
                this.addTo = function(a) {
                    this.stage !== a && null  != a && (this.stage = a)
                }
                ,
            null  != c && (c.add(this),
                this.addTo(c)),
                this.show = function() {
                    this.visible = !0
                }
                ,
                this.hide = function() {
                    this.visible = !1
                }
                ,
                this.paint = function(a) {
                    if (0 != this.visible && null  != this.stage) {
                        if (a.save(),
                                this.paintBackgroud(a),
                                this.paintGrid(a),
                                a.restore(),
                                a.save(),
                                a.scale(this.scaleX, this.scaleY),
                            1 == this.translate) {
                            var b = this.getOffsetTranslate(a);
                            a.translate(b.translateX, b.translateY)
                        }
                        this.paintChilds(a),
                            a.restore(),
                            a.save(),
                            this.paintOperations(a, this.operations),
                            a.restore()
                    }
                }
                ,
                this.repaint = function(a) {
                    0 != this.visible && this.paint(a)
                }
                ,
                this.paintGrid = function (a){
                    if(this.gridShow && this.gridImg){
                        a.save();
                        var bg = a.createPattern(this.gridImg,'repeat');
                        a.fillStyle = bg;
                        a.fillRect(0,0,a.canvas.width,a.canvas.height);
                        a.restore();
                    }
                }
                this.paintBackgroud = function(a) {
                    this.backgroundRepeat&&this.background ? this.paintRepeatBackground(a):
                    null  != this.background ? a.drawImage(this.background, 0, 0, a.canvas.width, a.canvas.height) : (a.beginPath(),
                        a.fillStyle = "rgba(" + this.backgroundColor + "," + this.alpha + ")",
                        a.fillRect(0, 0, a.canvas.width, a.canvas.height),
                        a.closePath())
                },
                this.paintRepeatBackground = function (a){
                    a.save();
                    var bg = a.createPattern(this.background,this.backgroundRepeat);
                    a.fillStyle = bg;
                    a.fillRect(0,0,a.canvas.width,a.canvas.height);
                    a.restore();
                }
                ,
                this.getDisplayedElements = function() {
                    for (var a = [], b = 0; b < this.zIndexArray.length; b++)
                        for (var c = this.zIndexArray[b], d = this.zIndexMap[c], e = 0; e < d.length; e++) {
                            var f = d[e];
                            this.isVisiable(f) && a.push(f)
                        }
                    return a
                }
                ,
                this.getDisplayedNodes = function() {
                    for (var b = [], c = 0; c < this.childs.length; c++) {
                        var d = this.childs[c];
                        d instanceof JTopo.Node && this.isVisiable(d) && b.push(d)
                    }
                    return b
                }
                ,
                this.getAllNodes = function() {
                    for (var b = [], c = 0; c < this.childs.length; c++) {
                        var d = this.childs[c];
                        d instanceof JTopo.Node && b.push(d)
                    }
                    return b
                }
                ,
                this.paintChilds = function(b) {
                    for (var c = 0; c < this.zIndexArray.length; c++)
                        for (var d = this.zIndexArray[c], e = this.zIndexMap[d], f = 0; f < e.length; f++) {
                            var g = e[f];
                            if (1 == this.paintAll || this.isVisiable(g)) {
                                if (b.save(),
                                    1 == g.transformAble) {
                                    var h = g.getCenterLocation();
                                    b.translate(h.x, h.y),
                                    g.rotate && b.rotate(g.rotate),
                                        g.scaleX && g.scaleY ? b.scale(g.scaleX, g.scaleY) : g.scaleX ? b.scale(g.scaleX, 1) : g.scaleY && b.scale(1, g.scaleY)
                                }
                                1 == g.shadow && (b.shadowBlur = g.shadowBlur,
                                    b.shadowColor = g.shadowColor,
                                    b.shadowOffsetX = g.shadowOffsetX,
                                    b.shadowOffsetY = g.shadowOffsetY),
                                g instanceof JTopo.InteractiveElement && (g.selected && 1 == g.showSelected && g.paintSelected(b),
                                1 == g.isMouseOver && g.paintMouseover(b)),
                                    g.paint(b),
                                    b.restore()
                            }
                        }
                },
                this.reZIndex = function() {
                    this.zIndexMap = {};
                    this.zIndexArray = [];
                    for(var i=0;i<this.childs.length;i++){
                        var a = this.childs[i];
                        null  == this.zIndexMap[a.zIndex] && (this.zIndexMap[a.zIndex] = [],
                        this.zIndexArray.push(a.zIndex),
                        this.zIndexArray.sort(function(a, b) {
                                return a - b
                            }
                        )),
                        this.zIndexMap["" + a.zIndex].push(a)
                    }
                }
                ,
                this.getOffsetTranslate = function(a) {
                    var b = this.stage.canvas.width
                        ,
                        c = this.stage.canvas.height;
                    null  != a && "move" != a && (b = a.canvas.width,
                        c = a.canvas.height);
                    var d = b / this.scaleX / 2
                        ,
                        e = c / this.scaleY / 2
                        ,
                        f = {
                            translateX: this.translateX + (d - d * this.scaleX),
                            translateY: this.translateY + (e - e * this.scaleY)
                        };
                    return f
                }
                ,
                this.isVisiable = function(b) {
                    if (1 != b.visible)
                        return !1;
                    if (b instanceof JTopo.Link)
                        return !0;
                    var c = this.getOffsetTranslate()
                        ,
                        d = b.x + c.translateX
                        ,
                        e = b.y + c.translateY;
                    d *= this.scaleX,
                        e *= this.scaleY;
                    var f = d + b.width * this.scaleX
                        ,
                        g = e + b.height * this.scaleY;
                    return d > this.stage.canvas.width || e > this.stage.canvas.height || 0 > f || 0 > g ? !1 : !0
                }
                ,
                this.paintOperations = function(a, b) {
                    for (var c = 0; c < b.length; c++)
                        b[c](a)
                }
                ,
                this.findElements = function(a) {
                    for (var b = [], c = 0; c < this.childs.length; c++)
                        1 == a(this.childs[c]) && b.push(this.childs[c]);
                    return b
                }
                ,
                this.getElementsByClass = function(a) {
                    return this.findElements(function(b) {
                            return b instanceof a
                        }
                    )
                }
                ,
                this.addOperation = function(a) {
                    return this.operations.push(a),
                        this
                }
                ,
                this.clearOperations = function() {
                    return this.operations = [],
                        this
                }
                ,
                this.getElementByXY = function(b, c) {
                    for (var d = null , e = this.zIndexArray.length - 1; e >= 0; e--)
                        for (var f = this.zIndexArray[e], g = this.zIndexMap[f], h = g.length - 1; h >= 0; h--) {
                            var i = g[h];
                            if (i instanceof JTopo.InteractiveElement && this.isVisiable(i) && i.isInBound(b, c))
                                return d = i
                        }
                    return d
                }
                ,
                this.add = function(a) {
                    this.childs.push(a),
                    null  == this.zIndexMap[a.zIndex] && (this.zIndexMap[a.zIndex] = [],
                        this.zIndexArray.push(a.zIndex),
                        this.zIndexArray.sort(function(a, b) {
                                return a - b
                            }
                        )),
                        this.zIndexMap["" + a.zIndex].push(a)
                }
                ,
                this.remove = function(b) {
                    this.childs = JTopo.util.removeFromArray(this.childs, b);
                    var c = this.zIndexMap[b.zIndex];
                    c && (this.zIndexMap[b.zIndex] = JTopo.util.removeFromArray(c, b)),
                        b.removeHandler(this)
                }
                ,
                this.clear = function() {
                    var a = this;
                    this.childs.forEach(function(b) {
                            b.removeHandler(a)
                        }
                    ),
                        this.childs = [],
                        this.operations = [],
                        this.zIndexArray = [],
                        this.zIndexMap = {}
                }
                ,
                this.addToSelected = function(a) {
                    this.selectedElements.push(a)
                }
                ,
                this.cancleAllSelected = function(a) {
                    for (var b = 0; b < this.selectedElements.length; b++)
                        this.selectedElements[b].unselectedHandler(a);
                    //编辑器当前节点设置为空
                    // editor.currentNode = null ;
                    this.selectedElements = [];
                }
                ,
                this.notInSelectedNodes = function(a) {
                    for (var b = 0; b < this.selectedElements.length; b++)
                        if (a === this.selectedElements[b])
                            return !1;
                    return !0
                }
                ,
                this.removeFromSelected = function(a) {
                    for (var b = 0; b < this.selectedElements.length; b++) {
                        var c = this.selectedElements[b];
                        a === c && (this.selectedElements = this.selectedElements.del(b))
                    }
                }
                ,
                this.toSceneEvent = function(b) {
                    var c = JTopo.util.clone(b);
                    if (c.x /= this.scaleX,
                            c.y /= this.scaleY,
                        1 == this.translate) {
                        var d = this.getOffsetTranslate();
                        c.x -= d.translateX,
                            c.y -= d.translateY
                    }
                    return null  != c.dx && (c.dx /= this.scaleX,
                        c.dy /= this.scaleY),
                    null  != this.currentElement && (c.target = this.currentElement),
                        c.scene = this,
                        c
                }
                ,
                this.selectElement = function(a) {
                    var b = e.getElementByXY(a.x, a.y);
                    if (null  != b)
                        if (a.target = b,
                                b.mousedownHander(a),
                                b.selectedHandler(a),
                                e.notInSelectedNodes(b))
                            a.ctrlKey || e.cancleAllSelected(),
                                e.addToSelected(b);
                        else {
                            1 == a.ctrlKey && (b.unselectedHandler(),
                                this.removeFromSelected(b));
                            for (var c = 0; c < this.selectedElements.length; c++) {
                                var d = this.selectedElements[c];
                                d.selectedHandler(a)
                            }
                        }
                    else
                        a.ctrlKey || e.cancleAllSelected();
                    this.currentElement = b
                }
                ,
                this.mousedownHandler = function(b) {
                    var c = this.toSceneEvent(b);
                    if (this.mouseDown = !0,
                            this.mouseDownX = c.x,
                            this.mouseDownY = c.y,
                            this.mouseDownEvent = c,
                        this.mode == JTopo.SceneMode.normal)
                        this.selectElement(c),
                        (null  == this.currentElement || this.currentElement instanceof JTopo.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX,
                            this.lastTranslateY = this.translateY);
                    else {
                        if (this.mode == JTopo.SceneMode.drag && 1 == this.translate)
                            return this.lastTranslateX = this.translateX,
                                void (this.lastTranslateY = this.translateY);
                        this.mode == JTopo.SceneMode.select ? this.selectElement(c) : this.mode == JTopo.SceneMode.edit && (this.selectElement(c),
                        (null  == this.currentElement || this.currentElement instanceof JTopo.Link) && 1 == this.translate && (this.lastTranslateX = this.translateX,
                            this.lastTranslateY = this.translateY))
                    }
                    e.dispatchEvent("mousedown", c)
                }
                ,
                this.mouseupHandler = function(b) {
                    this.stage.cursor != JTopo.MouseCursor.normal && (this.stage.cursor = JTopo.MouseCursor.normal),
                        e.clearOperations();
                    var c = this.toSceneEvent(b);
                    null  != this.currentElement && (c.target = e.currentElement,
                        this.currentElement.mouseupHandler(c)),
                        this.dispatchEvent("mouseup", c),
                        this.mouseDown = !1
                }
                ,
                this.dragElements = function(b) {
                    if (null  != this.currentElement && 1 == this.currentElement.dragable)
                        for (var c = 0; c < this.selectedElements.length; c++) {
                            var d = this.selectedElements[c];
                            if (0 != d.dragable) {
                                var e = JTopo.util.clone(b);
                                e.target = d,
                                    d.mousedragHandler(e)
                            }
                        }
                }
                ,
                this.mousedragHandler = function(b) {
                    var c = this.toSceneEvent(b);
                    this.mode == JTopo.SceneMode.normal ? null  == this.currentElement || this.currentElement instanceof JTopo.Link ? 1 == this.translate && (this.stage.cursor = JTopo.MouseCursor.closed_hand,
                        this.translateX = this.lastTranslateX + c.dx,
                        this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c) : this.mode == JTopo.SceneMode.drag ? 1 == this.translate && (this.stage.cursor = JTopo.MouseCursor.closed_hand,
                        this.translateX = this.lastTranslateX + c.dx,
                        this.translateY = this.lastTranslateY + c.dy) : this.mode == JTopo.SceneMode.select ? null  != this.currentElement ? 1 == this.currentElement.dragable && this.dragElements(c) : 1 == this.areaSelect && this.areaSelectHandle(c) : this.mode == JTopo.SceneMode.edit && (null  == this.currentElement || this.currentElement instanceof JTopo.Link ? 1 == this.translate && (this.stage.cursor = JTopo.MouseCursor.closed_hand,
                        this.translateX = this.lastTranslateX + c.dx,
                        this.translateY = this.lastTranslateY + c.dy) : this.dragElements(c)),
                        this.dispatchEvent("mousedrag", c)
                }
                ,
                this.areaSelectHandle = function(a) {
                    var b = a.offsetLeft
                        ,
                        c = a.offsetTop
                        ,
                        f = this.mouseDownEvent.offsetLeft
                        ,
                        g = this.mouseDownEvent.offsetTop
                        ,
                        h = b >= f ? f : b
                        ,
                        i = c >= g ? g : c
                        ,
                        j = Math.abs(a.dx) * this.scaleX
                        ,
                        k = Math.abs(a.dy) * this.scaleY
                        ,
                        l = new d(h,i,j,k);
                    e.clearOperations().addOperation(l),
                        b = a.x,
                        c = a.y,
                        f = this.mouseDownEvent.x,
                        g = this.mouseDownEvent.y,
                        h = b >= f ? f : b,
                        i = c >= g ? g : c,
                        j = Math.abs(a.dx),
                        k = Math.abs(a.dy);
                    for (var m = h + j, n = i + k, o = 0; o < e.childs.length; o++) {
                        var p = e.childs[o];
                        p.x > h && p.x + p.width < m && p.y > i && p.y + p.height < n && e.notInSelectedNodes(p) && (p.selectedHandler(a),
                            e.addToSelected(p))
                    }
                }
                ,
                this.mousemoveHandler = function(b) {
                    this.mousecoord = {
                        x: b.x,
                        y: b.y
                    };
                    var c = this.toSceneEvent(b);
                    if (this.mode == JTopo.SceneMode.drag)
                        return void (this.stage.cursor = JTopo.MouseCursor.open_hand);
                    this.mode == JTopo.SceneMode.normal ? this.stage.cursor = JTopo.MouseCursor.normal : this.mode == JTopo.SceneMode.select && (this.stage.cursor = JTopo.MouseCursor.normal);
                    var d = e.getElementByXY(c.x, c.y);
                    null  != d ? (e.mouseOverelement && e.mouseOverelement !== d && (c.target = d,
                        e.mouseOverelement.mouseoutHandler(c)),
                        e.mouseOverelement = d,
                        0 == d.isMouseOver ? (c.target = d,
                            d.mouseoverHandler(c),
                            e.dispatchEvent("mouseover", c)) : (c.target = d,
                            d.mousemoveHandler(c),
                            e.dispatchEvent("mousemove", c))) : e.mouseOverelement ? (c.target = d,
                        e.mouseOverelement.mouseoutHandler(c),
                        e.mouseOverelement = null ,
                        e.dispatchEvent("mouseout", c)) : (c.target = null ,
                        e.dispatchEvent("mousemove", c))
                }
                ,
                this.mouseoverHandler = function(a) {
                    var b = this.toSceneEvent(a);
                    this.dispatchEvent("mouseover", b)
                }
                ,
                this.mouseoutHandler = function(a) {
                    var b = this.toSceneEvent(a);
                    this.dispatchEvent("mouseout", b)
                }
                ,
                this.clickHandler = function(a) {
                    var b = this.toSceneEvent(a);
                    this.currentElement && (b.target = this.currentElement,
                        this.currentElement.clickHandler(b)),
                        this.dispatchEvent("click", b)
                }
                ,
                this.dbclickHandler = function(a) {
                    var b = this.toSceneEvent(a);
                    this.currentElement ? (b.target = this.currentElement,
                        this.currentElement.dbclickHandler(b)) : e.cancleAllSelected(),
                        this.dispatchEvent("dbclick", b)
                }
                ,
                this.mousewheelHandler = function(a) {
                    var b = this.toSceneEvent(a);
                    this.dispatchEvent("mousewheel", b)
                }
                ,
                this.touchstart = this.mousedownHander,
                this.touchmove = this.mousedragHandler,
                this.touchend = this.mousedownHander,
                this.keydownHandler = function(a) {
                    this.dispatchEvent("keydown", a)
                }
                ,
                this.keyupHandler = function(a) {
                    this.dispatchEvent("keyup", a)
                }
                ,
                this.addEventListener = function(a, b) {
                    var c = this
                        ,
                        d = function(a) {
                            b.call(c, a)
                        }
                        ;
                    return this.messageBus.subscribe(a, d),
                        this
                }
                ,
                this.removeEventListener = function(a) {
                    this.messageBus.unsubscribe(a)
                }
                ,
                this.removeAllEventListener = function() {
                    this.messageBus = new JTopo.util.MessageBus
                }
                ,
                this.dispatchEvent = function(a, b) {
                    return this.messageBus.publish(a, b),
                        this
                }
            ;
            var f = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,touchstart,touchmove,touchend,keydown,keyup".split(",")
                ,
                g = this;
            return f.forEach(function(a) {
                    g[a] = function(b) {
                        null  != b ? this.addEventListener(a, b) : this.dispatchEvent(a)
                    }
                }
            ),
                this.zoom = function(a, b) {
                    null  != a && 0 != a && (this.scaleX = a),
                    null  != b && 0 != b && (this.scaleY = b)
                }
                ,
                this.zoomOut = function(a) {
                    0 != a && (null  == a && (a = .8),
                        this.scaleX /= a,
                        this.scaleY /= a)
                }
                ,
                this.zoomIn = function(a) {
                    0 != a && (null  == a && (a = .8),
                        this.scaleX *= a,
                        this.scaleY *= a)
                }
                ,
                this.getBound = function() {
                    return {
                        left: 0,
                        top: 0,
                        right: this.stage.canvas.width,
                        bottom: this.stage.canvas.height,
                        width: this.stage.canvas.width,
                        height: this.stage.canvas.height
                    }
                }
                ,
                this.getElementsBound = function() {
                    return JTopo.util.getElementsBound(this.childs)
                }
                ,
                this.translateToCenter = function(a) {
                    var b = this.getElementsBound()
                        ,
                        c = this.stage.canvas.width / 2 - (b.left + b.right) / 2
                        ,
                        d = this.stage.canvas.height / 2 - (b.top + b.bottom) / 2;
                    a && (c = a.canvas.width / 2 - (b.left + b.right) / 2,
                        d = a.canvas.height / 2 - (b.top + b.bottom) / 2),
                        this.translateX = c,
                        this.translateY = d
                }
                ,
                this.setCenter = function(a, b) {
                    var c = a - this.stage.canvas.width / 2
                        ,
                        d = b - this.stage.canvas.height / 2;
                    this.translateX = -c,
                        this.translateY = -d
                }
                ,
                this.centerAndZoom = function(a, b, c) {
                    if (this.translateToCenter(c),
                        null  == a || null  == b) {
                        var d = this.getElementsBound();
                        if(!isNaN(this.centerAndZoomPadding)&&Number(this.centerAndZoomPadding)>0){
                            d.right = d.right + this.centerAndZoomPadding;
                            d.left = d.left - this.centerAndZoomPadding >=0? d.left - this.centerAndZoomPadding : 0;
                            d.bottom = d.bottom + this.centerAndZoomPadding;
                            d.top = d.top - this.centerAndZoomPadding >=0? d.top - this.centerAndZoomPadding : 0;
                        }
                        var e = d.right - d.left
                            ,
                            f = d.bottom - d.top
                            ,
                            g = this.stage.canvas.width / e
                            ,
                            h = this.stage.canvas.height / f;
                        c && (g = c.canvas.width / e,
                            h = c.canvas.height / f);
                        var i = Math.min(g, h);
                        if (i > 1)
                            return;
                        this.zoom(i, i)
                    }
                    this.zoom(a, b)
                }
                ,
                this.getCenterLocation = function() {
                    return {
                        x: e.stage.canvas.width / 2,
                        y: e.stage.canvas.height / 2
                    }
                }
                ,
                this.doLayout = function(a) {
                    a && a(this, this.childs)
                }
                ,
                this.toJson = function() {
                    {
                        var a = this
                            ,
                            b = "{";
                        this.serializedProperties.length
                    }
                    this.serializedProperties.forEach(function(c) {
                            var d = a[c];
                            if (typeof d == "number") {
                                if (c == "width" || c == "height") {
                                    d = Math.round(d);
                                } else {
                                    d = Math.round(d * 100) / 100;
                                }
                            }
                            //TODO modify 2014/11/18 ---  更改背景图为空序列化报错
                            /*"background" == c && (d = a._background.src), */
                            "string" == typeof d && (d = '"' + d + '"'),
                                b += '"' + c + '":' + d + ","
                        }
                    ),
                        b += '"childs":[';
                    var c = this.childs.length;
                    return this.childs.forEach(function(a, d) {
                            b += a.toJson(),
                            c > d + 1 && (b += ",")
                        }
                    ),
                        b += "]",
                        b += "}"
                }
                ,
                e
        }
        Scene.prototype = new JTopo.Element;
        var c = {};
        Object.defineProperties(Scene.prototype, {
            background: {
                get: function() {
                    return this._background
                },
                set: function(a) {
                    if ("string" == typeof a) {
                        var b = c[a];
                        null  == b && (b = new Image,
                                b.src = a,
                                b.onload = function() {
                                    c[a] = b
                                }
                        ),
                            this._background = b
                    } else
                        this._background = a
                }
            }
        }),
            JTopo.Scene = Scene
    }
    (JTopo),
    /*mark : element*/
    function(a) {
        function b() {
            this.initialize = function() {
                b.prototype.initialize.apply(this, arguments),
                    this.elementType = "displayElement",
                    this.x = 0,
                    this.y = 0,
                    this.width = 32,
                    this.height = 32,
                    this.visible = !0,
                    this.alpha = 1,
                    this.rotate = 0,
                    this.scaleX = 1,
                    this.scaleY = 1,
                    this.strokeColor = "22,124,255",
                    this.borderColor = "22,124,255",
                    this.fillColor = "22,124,255",
                    this.shadow = !1,
                    this.shadowBlur = 5,
                    this.shadowColor = "rgba(0,0,0,0.5)",
                    this.shadowOffsetX = 3,
                    this.shadowOffsetY = 6,
                    this.transformAble = !1,
                    this.zIndex = 0;
                var a = "x,y,width,height,visible,rotate,scaleX,scaleY,zIndex".split(",");
                this.serializedProperties = this.serializedProperties.concat(a)
            }
                ,
                this.initialize(),
                this.paint = function(a) {
                    a.beginPath(),
                        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")",
                        a.rect(-this.width / 2, -this.height / 2, this.width, this.height),
                        a.fill(),
                        a.stroke(),
                        a.closePath()
                }
                ,
                this.getLocation = function() {
                    return {
                        x: this.x,
                        y: this.y
                    }
                }
                ,
                this.setLocation = function(a, b) {
                    return this.x = a,
                        this.y = b,
                        this
                }
                ,
                this.getCenterLocation = function() {
                    return {
                        x: this.x + this.width / 2,
                        y: this.y + this.height / 2
                    }
                }
                ,
                this.setCenterLocation = function(a, b) {
                    return this.x = a - this.width / 2,
                        this.y = b - this.height / 2,
                        this
                }
                ,
                this.getSize = function() {
                    return {
                        width: this.width,
                        height: this.height
                    }
                }
                ,
                this.setSize = function(a, b) {
                    return this.width = a,
                        this.height = b,
                        this
                }
                ,
                this.getBound = function() {
                    return {
                        left: this.x,
                        top: this.y,
                        right: this.x + this.width,
                        bottom: this.y + this.height,
                        width: this.width,
                        height: this.height
                    }
                }
                ,
                this.setBound = function(a, b, c, d) {
                    return this.setLocation(a, b),
                        this.setSize(c, d),
                        this
                }
                ,
                this.getDisplayBound = function() {
                    return {
                        left: this.x,
                        top: this.y,
                        right: this.x + this.width * this.scaleX,
                        bottom: this.y + this.height * this.scaleY
                    }
                }
                ,
                this.getDisplaySize = function() {
                    return {
                        width: this.width * this.scaleX,
                        height: this.height * this.scaleY
                    }
                }
                ,
                this.getPosition = function(a) {
                    var b, c = this.getBound();
                    return "Top_Left" == a ? b = {
                        x: c.left,
                        y: c.top
                    } : "Top_Center" == a ? b = {
                        x: this.cx,
                        y: c.top
                    } : "Top_Right" == a ? b = {
                        x: c.right,
                        y: c.top
                    } : "Middle_Left" == a ? b = {
                        x: c.left,
                        y: this.cy
                    } : "Middle_Center" == a ? b = {
                        x: this.cx,
                        y: this.cy
                    } : "Middle_Right" == a ? b = {
                        x: c.right,
                        y: this.cy
                    } : "Bottom_Left" == a ? b = {
                        x: c.left,
                        y: c.bottom
                    } : "Bottom_Center" == a ? b = {
                        x: this.cx,
                        y: c.bottom
                    } : "Bottom_Right" == a && (b = {
                        x: c.right,
                        y: c.bottom
                    }),
                        b
                }
        }
        function c() {
            this.initialize = function() {
                c.prototype.initialize.apply(this, arguments),
                    this.elementType = "interactiveElement",
                    this.dragable = !1,
                    this.selected = !1,
                    this.showSelected = !0,
                    this.selectedLocation = null ,
                    this.isMouseOver = !1;
                //var a = "".split(",");
                //this.serializedProperties = this.serializedProperties.concat(a)
            }
                ,
                this.initialize(),
                this.paintSelected = function(a) {
                    0 != this.showSelected && (a.save(),
                        a.beginPath(),
                        a.strokeStyle = "rgba(168,202,255, 0.9)",
                        a.fillStyle = "rgba(168,202,236,0.7)",
                        a.rect(-this.width / 2 - 3, -this.height / 2 - 3, this.width + 6, this.height + 6),
                        a.fill(),
                        a.stroke(),
                        a.closePath(),
                        a.restore())
                }
                ,
                this.paintMouseover = function(a) {
                    return this.paintSelected(a)
                }
                ,
                this.isInBound = function(a, b) {
                    return a > this.x && a < this.x + this.width * Math.abs(this.scaleX) && b > this.y && b < this.y + this.height * Math.abs(this.scaleY)
                }
                ,
                this.selectedHandler = function() {
                    this.selected = !0,
                        this.selectedLocation = {
                            x: this.x,
                            y: this.y
                        }
                }
                ,
                this.unselectedHandler = function() {
                    this.selected = !1,
                        this.selectedLocation = null
                }
                ,
                this.dbclickHandler = function(a) {
                    this.dispatchEvent("dbclick", a)
                }
                ,
                this.clickHandler = function(a) {
                    this.dispatchEvent("click", a)
                }
                ,
                this.mousedownHander = function(a) {
                    this.dispatchEvent("mousedown", a)
                }
                ,
                this.mouseupHandler = function(a) {
                    this.dispatchEvent("mouseup", a)
                }
                ,
                this.mouseoverHandler = function(a) {
                    this.isMouseOver = !0,
                        this.dispatchEvent("mouseover", a)
                }
                ,
                this.mousemoveHandler = function(a) {
                    this.dispatchEvent("mousemove", a)
                }
                ,
                this.mouseoutHandler = function(a) {
                    this.isMouseOver = !1,
                        this.dispatchEvent("mouseout", a)
                }
                ,
                this.mousedragHandler = function(a) {
                    var b = this.selectedLocation.x + a.dx
                        ,
                        c = this.selectedLocation.y + a.dy;
                    this.setLocation(b, c),
                        this.dispatchEvent("mousedrag", a)
                }
                ,
                this.addEventListener = function(b, c) {
                    var d = this
                        ,
                        e = function(a) {
                            c.call(d, a)
                        }
                        ;
                    return this.messageBus || (this.messageBus = new a.util.MessageBus),
                        this.messageBus.subscribe(b, e),
                        this
                }
                ,
                this.dispatchEvent = function(a, b) {
                    return this.messageBus ? (this.messageBus.publish(a, b),
                        this) : null
                }
                ,
                this.removeEventListener = function(a) {
                    this.messageBus.unsubscribe(a)
                }
                ,
                this.removeAllEventListener = function() {
                    this.messageBus = new a.util.MessageBus
                }
            ;
            var b = "click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(",")
                ,
                d = this;
            b.forEach(function(a) {
                    d[a] = function(b) {
                        null  != b ? this.addEventListener(a, b) : this.dispatchEvent(a)
                    }
                }
            )
        }
        function d() {
            this.initialize = function() {
                d.prototype.initialize.apply(this, arguments),
                    this.editAble = !1,
                    this.selectedPoint = null
            }
                ,
                this.getCtrlPosition = function(a) {
                    var b = 5
                        ,
                        c = 5
                        ,
                        d = this.getPosition(a);
                    return {
                        left: d.x - b,
                        top: d.y - c,
                        right: d.x + b,
                        bottom: d.y + c
                    }
                }
                ,
                this.selectedHandler = function(b) {
                    d.prototype.selectedHandler.apply(this, arguments),
                        this.selectedSize = {
                            width: this.width,
                            height: this.height
                        },
                    b.scene.mode == a.SceneMode.edit && (this.editAble = !0)
                }
                ,
                this.unselectedHandler = function() {
                    d.prototype.unselectedHandler.apply(this, arguments),
                        this.selectedSize = null ,
                        this.editAble = !1
                }
            ;
            var b = ["Top_Left", "Top_Center", "Top_Right", "Middle_Left", "Middle_Right", "Bottom_Left", "Bottom_Center", "Bottom_Right"];
            this.paintCtrl = function(a) {
                if (0 != this.editAble) {
                    a.save();
                    for (var c = 0; c < b.length; c++) {
                        var d = this.getCtrlPosition(b[c]);
                        d.left -= this.cx,
                            d.right -= this.cx,
                            d.top -= this.cy,
                            d.bottom -= this.cy;
                        var e = d.right - d.left
                            ,
                            f = d.bottom - d.top;
                        a.beginPath(),
                            a.strokeStyle = "rgba(0,0,0,0.8)",
                            a.rect(d.left, d.top, e, f),
                            a.stroke(),
                            a.closePath(),
                            a.beginPath(),
                            a.strokeStyle = "rgba(255,255,255,0.3)",
                            a.rect(d.left + 1, d.top + 1, e - 2, f - 2),
                            a.stroke(),
                            a.closePath()
                    }
                    a.restore()
                }
            }
                ,
                this.isInBound = function(a, c) {
                    if (this.selectedPoint = null ,
                        1 == this.editAble)
                        for (var e = 0; e < b.length; e++) {
                            var f = this.getCtrlPosition(b[e]);
                            if (a > f.left && a < f.right && c > f.top && c < f.bottom)
                                return this.selectedPoint = b[e],
                                    !0
                        }
                    return d.prototype.isInBound.apply(this, arguments)
                }
                ,
                this.mousedragHandler = function(a) {
                    var dragedNode = this;
                    if (null  == this.selectedPoint) {
                        var b = this.selectedLocation.x + a.dx
                            ,
                            c = this.selectedLocation.y + a.dy;
                        //画标尺线
                        // editor.utils.createRuleLines(b + this.width / 2, c + this.height / 2);
                        //应用自动布局
                        if (this.layout && this.layout.on && this.layout.type == "auto")
                            JTopo.layout.layoutNode(JTopo.stage.childs[0], this, true, a);
                        this.setLocation(b, c),
                            this.dispatchEvent("mousedrag", a);
                    } else {
                        if ("Top_Left" == this.selectedPoint) {
                            var d = this.selectedSize.width - a.dx
                                ,
                                e = this.selectedSize.height - a.dy
                                ,
                                b = this.selectedLocation.x + a.dx
                                ,
                                c = this.selectedLocation.y + a.dy;
                            b < this.x + this.width && (this.x = b,
                                this.width = d),
                            c < this.y + this.height && (this.y = c,
                                this.height = e)
                        } else if ("Top_Center" == this.selectedPoint) {
                            var e = this.selectedSize.height - a.dy
                                ,
                                c = this.selectedLocation.y + a.dy;
                            c < this.y + this.height && (this.y = c,
                                this.height = e)
                        } else if ("Top_Right" == this.selectedPoint) {
                            var d = this.selectedSize.width + a.dx
                                ,
                                c = this.selectedLocation.y + a.dy;
                            c < this.y + this.height && (this.y = c,
                                this.height = this.selectedSize.height - a.dy),
                            d > 1 && (this.width = d)
                        } else if ("Middle_Left" == this.selectedPoint) {
                            var d = this.selectedSize.width - a.dx
                                ,
                                b = this.selectedLocation.x + a.dx;
                            b < this.x + this.width && (this.x = b),
                            d > 1 && (this.width = d)
                        } else if ("Middle_Right" == this.selectedPoint) {
                            var d = this.selectedSize.width + a.dx;
                            d > 1 && (this.width = d)
                        } else if ("Bottom_Left" == this.selectedPoint) {
                            var d = this.selectedSize.width - a.dx
                                ,
                                b = this.selectedLocation.x + a.dx;
                            d > 1 && (this.x = b,
                                this.width = d);
                            var e = this.selectedSize.height + a.dy;
                            e > 1 && (this.height = e)
                        } else if ("Bottom_Center" == this.selectedPoint) {
                            var e = this.selectedSize.height + a.dy;
                            e > 1 && (this.height = e)
                        } else if ("Bottom_Right" == this.selectedPoint) {
                            var d = this.selectedSize.width + a.dx;
                            d > 1 && (this.width = d);
                            var e = this.selectedSize.height + a.dy;
                            e > 1 && (this.height = e)
                        }
                        this.dispatchEvent("resize", a)
                    }
                }
        }
        b.prototype = new a.Element,
            Object.defineProperties(b.prototype, {
                cx: {
                    get: function() {
                        return this.x + this.width / 2
                    },
                    set: function(a) {
                        this.x = a - this.width / 2
                    }
                },
                cy: {
                    get: function() {
                        return this.y + this.height / 2
                    },
                    set: function(a) {
                        this.y = a - this.height / 2
                    }
                }
            }),
            c.prototype = new b,
            d.prototype = new c,
            a.DisplayElement = b,
            a.InteractiveElement = c,
            a.EditableElement = d
    }
    (JTopo),
    /*mark : node*/
    function(a) {
        function b(c) {
            this.initialize = function(c) {
                b.prototype.initialize.apply(this, arguments),
                    this.elementType = "node",
                    this.zIndex = a.zIndex_Node,
                    this.text = c,
                    this.font = "12px Consolas",
                    this.fontColor = "255,255,255",
                    this.borderWidth = 0,
                    this.borderColor = "255,255,255",
                    this.borderRadius = null ,
                    this.dragable = !0,
                    this.textPosition = "Bottom_Center",
                    this.textOffsetX = 0,
                    this.textOffsetY = 0,
                    this.transformAble = !0,
                    this.shadowBlur = 0,
                    this.shadowColor = 'rgba(255,255,255,1)',
                    this.shadowOffsetX = 0,
                    this.shadowOffsetY = 0,
                    this.inLinks = [],
                    this.outLinks = [];
                var d = "deviceId,dataType,nodeImage,text,textPosition,templateId".split(",");
                this.serializedProperties = this.serializedProperties.concat(d);
                this.maxHistoryStep = 20;
                this.currStep = 0;
                this.historyStack = new Array();
            }
                ,
                this.initialize(c),
                this.paint = function(a) {
                    if(this.myTopoStyle){
                        if(this.eventlevel=='2'||this.eventlevel=='3'||this.eventlevel=='1'){
                            this.paintAlarmBackground(a);
                        }
                        if (this.image) {
                            var b = a.globalAlpha;
                            a.globalAlpha = this.alpha,
                            a.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height),
                            a.globalAlpha = b
                        } else a.beginPath(),
                        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")",
                        null == this.borderRadius || 0 == this.borderRadius ? a.rect( - this.width / 2, -this.height / 2, this.width, this.height) : a.JTopoRoundRect( - this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius),
                        a.fill(),
                        a.closePath();
                        this.paintText(a),
                        this.paintBorder(a),
                        this.paintCtrl(a),
                        this.paintAlarmIcon(a)
                    }else {
                        if (this.image) {
                            var b = a.globalAlpha;
                            a.globalAlpha = this.alpha,
                            null != this.alarmImage && null != this.alarm ? a.drawImage(this.alarmImage, -this.width / 2, -this.height / 2, this.width, this.height) : a.drawImage(this.image, -this.width / 2, -this.height / 2, this.width, this.height),
                            a.globalAlpha = b
                        } else a.beginPath(),
                        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")",
                        null == this.borderRadius || 0 == this.borderRadius ? a.rect( - this.width / 2, -this.height / 2, this.width, this.height) : a.JTopoRoundRect( - this.width / 2, -this.height / 2, this.width, this.height, this.borderRadius),
                        a.fill(),
                        a.closePath();
                        this.paintText(a),
                        this.paintBorder(a),
                        this.paintCtrl(a),
                        this.paintAlarmText(a)
                    }
                },
                this.paintAlarmBackground = function (a){
                    var w = this.width*this.alarmBackground_scale;
                    var h = this.height*this.alarmBackground_scale;
                    var b = a.globalAlpha;
                    var backFillStyle = a.fillStyle;
                    a.globalAlpha = this.alarmAlpha;
                    a.fillStyle = this.alarmBackground_color;
                    a.beginPath();
                    var r = Math.max(w,h)/2;
                    a.arc(0,0,r,0*Math.PI,2*Math.PI);
                    a.fill();
                    a.closePath();
                    a.globalAlpha = b;
                    a.fillStyle = backFillStyle;
                },
                this.paintAlarmIcon = function(a){//myTopoStyle新加方法
                    function drawFault(w,h,alpha){
                    	try{
                            var faultHeight = h * 0.3 ;
                            var faultWidth = w * 0.3 ;
                            var b = a.globalAlpha;
                            a.globalAlpha = alpha,
                            a.drawImage(JTopo.imgRepo.faultEventImage, faultWidth / 2, faultHeight / 2, faultWidth, faultHeight),
                            a.globalAlpha = b
                    	}catch(e){
                    		
                    	}

                    }
                    function drawPerfrom(w,h,alpha){
                        var faultHeight = h * 0.3 ;
                        var faultWidth = w * 0.3 ;
                        var b = a.globalAlpha;
                        a.globalAlpha = alpha,
                        a.drawImage(JTopo.imgRepo.performEventImage, -faultWidth / 2*3, faultHeight / 2, faultWidth, faultHeight),
                        a.globalAlpha = b
                    }
                    function drawHealthlevel(w,h,alpha,src){
                        var faultHeight = h * 0.3 ;
                        var faultWidth = w * 0.3 ;
                        var b = a.globalAlpha;
                        var w = (faultWidth>faultHeight?faultHeight:faultWidth);
                        a.globalAlpha = alpha,
                        a.drawImage(src, faultWidth / 2, -faultHeight / 2*3, w, w),
                        a.globalAlpha = b
                    }
                    if(this.myTopoStyle&&this.eventlevel){
                        if(this.eventlevel=='3'){//性能&故障
                            drawFault(this.width,this.height,this.alpha);
                            drawPerfrom(this.width,this.height,this.alpha);
                        }else if(this.eventlevel=='2'){
                            drawFault(this.width,this.height,this.alpha);
                        }else if(this.eventlevel=='1'){
                            drawPerfrom(this.width,this.height,this.alpha);
                        }
                    }else if(this.myTopoStyle&&this.healthlevel){
                        if(this.healthlevel=='2'){//正常
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.normalImage);
                        }else if(this.healthlevel=='1'){//性能
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.performImage);
                        }else if(this.healthlevel=='0'){//故障
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.faultImage);
                        }else if(this.healthlevel=='-1'){//未知
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.unknownImage);
                        }else if(this.healthlevel=='-2'){//凭证
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.authorImage);
                        }
                    }else if(this.myTopoStyle&&this.status){
                        if(this.status=='UNCONFIG'){
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.unconfigImage);
                        }else {
                            drawHealthlevel(this.width,this.height,this.alpha,JTopo.imgRepo.configImage);
                        }
                    }
                }
                ,
                this.paintAlarmText = function(a) {
                    if (null  != this.alarm && "" != this.alarm) {
                        var b = this.alarmColor || "255,0,0"
                            ,
                            c = this.alarmAlpha || .5;
                        a.beginPath(),
                            a.font = this.alarmFont || "10px 微软雅黑";
                        var d = a.measureText(this.alarm).width + 6
                            ,
                            e = a.measureText("田").width + 6
                            ,
                            f = this.width / 2 - d / 2
                            ,
                            g = -this.height / 2 - e - 8;
                        a.strokeStyle = "rgba(" + b + ", " + c + ")",
                            a.fillStyle = "rgba(" + b + ", " + c + ")",
                            a.lineCap = "round",
                            a.lineWidth = 1,
                            a.moveTo(f, g),
                            a.lineTo(f + d, g),
                            a.lineTo(f + d, g + e),
                            a.lineTo(f + d / 2 + 6, g + e),
                            a.lineTo(f + d / 2, g + e + 8),
                            a.lineTo(f + d / 2 - 6, g + e),
                            a.lineTo(f, g + e),
                            a.lineTo(f, g),
                            a.fill(),
                            a.stroke(),
                            a.closePath(),
                            a.beginPath(),
                            a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                            a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                            a.fillText(this.alarm, f + 2, g + e - 4),
                            a.closePath()
                    }
                }
                ,
                this.paintText = function(a) {
                    var b = this.text;
                    if (null  != b && "" != b) {
                        a.beginPath(),
                            a.font = this.font;
                        var c = a.measureText(b).width
                            ,
                            d = a.measureText("田").width;
                        a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";
                        var e = this.getTextPostion(this.textPosition, c, d);
                        if(this.shadowBlur >0){
                            a.shadowOffsetX = this.shadowOffsetX;
                            a.shadowOffsetY = this.shadowOffsetY;
                            a.shadowBlur    = this.shadowBlur;
                            a.shadowColor   = this.shadowColor;
                        }
                        a.fillText(b, e.x, e.y);
                        a.closePath()
                    }
                }
                ,
                this.paintBorder = function(a) {
                    if (0 != this.borderWidth) {
                        a.beginPath(),
                            a.lineWidth = this.borderWidth,
                            a.strokeStyle = "rgba(" + this.borderColor + "," + this.alpha + ")";
                        var b = this.borderWidth / 2;
                        null  == this.borderRadius || 0 == this.borderRadius ? a.rect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth) : a.JTopoRoundRect(-this.width / 2 - b, -this.height / 2 - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius),
                            a.stroke(),
                            a.closePath()
                    }
                }
                ,
                this.getTextPostion = function(a, b, c) {
                    var d = null ;
                    return null  == a || "Bottom_Center" == a ? d = {
                        x: -this.width / 2 + (this.width - b) / 2,
                        y: this.height / 2 + c
                    } : "Top_Center" == a ? d = {
                        x: -this.width / 2 + (this.width - b) / 2,
                        y: -this.height / 2 - c / 2
                    } : "Top_Right" == a ? d = {
                        x: this.width / 2,
                        y: -this.height / 2 - c / 2
                    } : "Top_Left" == a ? d = {
                        x: -this.width / 2 - b,
                        y: -this.height / 2 - c / 2
                    } : "Bottom_Right" == a ? d = {
                        x: this.width / 2,
                        y: this.height / 2 + c
                    } : "Bottom_Left" == a ? d = {
                        x: -this.width / 2 - b,
                        y: this.height / 2 + c
                    } : "Middle_Center" == a ? d = {
                        x: -this.width / 2 + (this.width - b) / 2,
                        y: c / 2
                    } : "Middle_Right" == a ? d = {
                        x: this.width / 2,
                        y: c / 2
                    } : "Middle_Left" == a && (d = {
                        x: -this.width / 2 - b,
                        y: c / 2
                    }),
                    null  != this.textOffsetX && (d.x += this.textOffsetX),
                    null  != this.textOffsetY && (d.y += this.textOffsetY),
                        d
                }
                ,
                this.setImage = function(a, b) {
                    if (null == a) throw new Error("Node.setImage(): 参数Image对象为空!");
                    var c = this;
                    if ("string" == typeof a) {
                        var d = j[a];
                        null == d ? (d = new Image,d.crossOrigin='', d.onload = function() {
                            j[a] = d,
                            1 == b && c.setSize(d.width, d.height),
                            c.image = d,
                            c.alarmColor = null == c.alarmColor ? "255,0,0": c.alarmColor
                        },d.onerror = function(e){
                            1 == b && c.setSize(d.width, d.height);
                            c.image = JTopo.imgRepo.defaultImg;
                            c.alarmColor = null == c.alarmColor ? "255,0,0": c.alarmColor;
                        },d.src = a) : (b && this.setSize(d.width, d.height), c.image = d, c.alarmColor = null == c.alarmColor ? "255,0,0": c.alarmColor)
                    } else this.image = a,
                    c.alarmColor = null == c.alarmColor ? "255,0,0": c.alarmColor,
                    1 == b && this.setSize(a.width, a.height)
                },
                this.removeHandler = function(a) {
                    var b = this;
                    this.outLinks && (this.outLinks.forEach(function(c) {
                            c.nodeA === b && a.remove(c)
                        }
                    ),
                        this.outLinks = null ),
                    this.inLinks && (this.inLinks.forEach(function(c) {
                            c.nodeZ === b && a.remove(c)
                        }
                    ),
                        this.inLinks = null )
                }
        }
        function c() {
            c.prototype.initialize.apply(this, arguments)
        }
        function d(a) {
            this.initialize(),
                this.text = a,
                this.elementType = "TextNode",
                this.paint = function(a) {
                    a.beginPath(),
                        a.font = this.font,
                        this.width = a.measureText(this.text).width,
                        this.height = a.measureText("田").width,
                        a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                        a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                        a.fillText(this.text, -this.width / 2, this.height / 2),
                        a.closePath(),
                        this.paintBorder(a),
                        this.paintCtrl(a),
                        this.paintAlarmText(a)
                }
        }
        function e(a, b, c) {
            this.initialize(),
                this.text = a,
                this.href = b,
                this.target = c,
                this.elementType = "LinkNode",
                this.isVisited = !1,
                this.visitedColor = null ,
                this.paint = function(a) {
                    a.beginPath(),
                        a.font = this.font,
                        this.width = a.measureText(this.text).width,
                        this.height = a.measureText("田").width,
                        this.isVisited && null  != this.visitedColor ? (a.strokeStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")",
                            a.fillStyle = "rgba(" + this.visitedColor + ", " + this.alpha + ")") : (a.strokeStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                            a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")"),
                        a.fillText(this.text, -this.width / 2, this.height / 2),
                    this.isMouseOver && (a.moveTo(-this.width / 2, this.height),
                        a.lineTo(this.width / 2, this.height),
                        a.stroke()),
                        a.closePath(),
                        this.paintBorder(a),
                        this.paintCtrl(a),
                        this.paintAlarmText(a)
                }
                ,
                this.mousemove(function() {
                        var a = document.getElementsByTagName("canvas");
                        if (a && a.length > 0)
                            for (var b = 0; b < a.length; b++)
                                a[b].style.cursor = "pointer"
                    }
                ),
                this.mouseout(function() {
                        var a = document.getElementsByTagName("canvas");
                        if (a && a.length > 0)
                            for (var b = 0; b < a.length; b++)
                                a[b].style.cursor = "default"
                    }
                ),
                this.click(function() {
                        "_blank" == this.target ? window.open(this.href) : location = this.href,
                            this.isVisited = !0
                    }
                )
        }
        function f(a) {
            this.initialize(arguments),
                this._radius = 20,
                this.beginDegree = 0,
                this.endDegree = 2 * Math.PI,
                this.text = a,
                this.paint = function(a) {
                    a.save(),
                        a.beginPath(),
                        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")",
                        a.arc(0, 0, this.radius, this.beginDegree, this.endDegree, !0),
                        a.fill(),
                        a.closePath(),
                        a.restore(),
                        this.paintText(a),
                        this.paintBorder(a),
                        this.paintCtrl(a),
                        this.paintAlarmText(a)
                }
                ,
                this.paintSelected = function(a) {
                    a.save(),
                        a.beginPath(),
                        a.strokeStyle = "rgba(168,202,255, 0.9)",
                        a.fillStyle = "rgba(168,202,236,0.7)",
                        a.arc(0, 0, this.radius + 3, this.beginDegree, this.endDegree, !0),
                        a.fill(),
                        a.stroke(),
                        a.closePath(),
                        a.restore()
                }
        }
        function g(a, b, c) {
            this.initialize(),
                this.frameImages = a || [],
                this.frameIndex = 0,
                this.isStop = !0;
            var d = b || 1e3;
            this.repeatPlay = !1;
            var e = this;
            this.nextFrame = function() {
                if (!this.isStop && null  != this.frameImages.length) {
                    if (this.frameIndex++,
                        this.frameIndex >= this.frameImages.length) {
                        if (!this.repeatPlay)
                            return;
                        this.frameIndex = 0
                    }
                    this.setImage(this.frameImages[this.frameIndex], c),
                        setTimeout(function() {
                                e.nextFrame()
                            }
                            , d / a.length)
                }
            }
        }
        function h(a, b, c, d, e) {
            this.initialize();
            var f = this;
            this.setImage(a),
                this.frameIndex = 0,
                this.isPause = !0,
                this.repeatPlay = !1;
            var g = d || 1e3;
            e = e || 0,
                this.paint = function(a) {
                    if (this.image) {
                        var b = this.width
                            ,
                            d = this.height;
                        a.save(),
                            a.beginPath(),
                            a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")";
                        var f = (Math.floor(this.frameIndex / c) + e) * d
                            ,
                            g = Math.floor(this.frameIndex % c) * b;
                        a.drawImage(this.image, g, f, b, d, -b / 2, -d / 2, b, d),
                            a.fill(),
                            a.closePath(),
                            a.restore(),
                            this.paintText(a),
                            this.paintBorder(a),
                            this.paintCtrl(a),
                            this.paintAlarmText(a)
                    }
                }
                ,
                this.nextFrame = function() {
                    if (!this.isStop) {
                        if (this.frameIndex++,
                            this.frameIndex >= b * c) {
                            if (!this.repeatPlay)
                                return;
                            this.frameIndex = 0
                        }
                        setTimeout(function() {
                                f.isStop || f.nextFrame()
                            }
                            , g / (b * c))
                    }
                }
        }
        function i() {
            var a = null ;
            return a = arguments.length <= 3 ? new g(arguments[0],arguments[1],arguments[2]) : new h(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),
                a.stop = function() {
                    a.isStop = !0
                }
                ,
                a.play = function() {
                    a.isStop = !1,
                        a.frameIndex = 0,
                        a.nextFrame()
                }
                ,
                a
        }
        var j = {};
        b.prototype = new a.EditableElement,
            c.prototype = new b,
            Object.defineProperties(c.prototype, {
                alarmColor: {
                    get: function() {
                        return this._alarmColor
                    },
                    set: function(b) {
                        if (this._alarmColor = b, null != this.image) {
                            var c = a.util.genImageAlarm(this.image, b);
                            c && (this.alarmImage = c)
                        }
                    }
                }
            }),
            d.prototype = new c,
            e.prototype = new d,
            f.prototype = new c,
            Object.defineProperties(f.prototype, {
                radius: {
                    get: function() {
                        return this._radius
                    },
                    set: function(a) {
                        this._radius = a;
                        var b = 2 * this.radius
                            ,
                            c = 2 * this.radius;
                        this.width = b,
                            this.height = c
                    }
                },
                width: {
                    get: function() {
                        return this._width
                    },
                    set: function(a) {
                        this._radius = a / 2,
                            this._width = a
                    }
                },
                height: {
                    get: function() {
                        return this._height
                    },
                    set: function(a) {
                        this._radius = a / 2,
                            this._height = a
                    }
                }
            }),
            g.prototype = new c,
            h.prototype = new c,
            i.prototype = new c,
            a.Node = c,
            a.TextNode = d,
            a.LinkNode = e,
            a.CircleNode = f,
            a.AnimateNode = i
    }
    (JTopo),
    /*mark : link*/
    function(a) {
        function b(a, b) {//返回a开始节点b结束节点的link数组
            var c = [];
            if (null  == a || null  == b)
                return c;
            if (a && b && a.outLinks && b.inLinks)
                for (var d = 0; d < a.outLinks.length; d++)
                    for (var e = a.outLinks[d], f = 0; f < b.inLinks.length; f++) {
                        var g = b.inLinks[f];
                        e === g && c.push(g)
                    }
            return c
        }
        function c(a, c) {//返回两端分别是a，c的link数组
            var d = b(a, c)
                ,
                e = b(c, a)
                ,
                f = d.concat(e);
            return f
        }
        function d(a) {//返回与入参a完全相同的对象
            var b = c(a.nodeA, a.nodeZ);
            return b = b.filter(function(b) {
                    return a !== b
                }
            )
        }
        function e(a, b) {
            return c(a, b).length
        }
        function f(b, c, g) {
            function h(b, c) {
                var d = a.util.lineF(b.cx, b.cy, c.cx, c.cy)
                    ,
                    e = b.getBound()
                    ,
                    f = a.util.intersectionLineBound(d, e);
                return f
            }
            this.initialize = function(b, c, d) {
                if (f.prototype.initialize.apply(this, arguments),
                        this.elementType = "link",
                        this.zIndex = a.zIndex_Link,
                    0 != arguments.length) {
                    this.text = d;
                        this.nodeA = b;
                        this.nodeZ = c;
                    this.nodeA && null  == this.nodeA.outLinks && (this.nodeA.outLinks = []);
                    this.nodeA && null  == this.nodeA.inLinks && (this.nodeA.inLinks = []);
                    this.nodeZ && null  == this.nodeZ.inLinks && (this.nodeZ.inLinks = []);
                    this.nodeZ && null  == this.nodeZ.outLinks && (this.nodeZ.outLinks = []);
                    null  != this.nodeA && this.nodeA.outLinks.push(this);
                    null  != this.nodeZ && this.nodeZ.inLinks.push(this);
                        this.caculateIndex();
                        this.font = "12px Consolas";
                        this.fontColor = "255,255,255";
                        this.lineWidth = 2;
                        this.lineJoin = "miter";
                        this.transformAble = !1;
                        this.bundleOffset = 20;
                        this.bundleGap = 12;
                        this.textOffsetX = 0;
                        this.textOffsetY = 0;
                        this.arrowsRadius = null;
                        this.arrowsOffset = 0;
                        this.dashedPattern = null;
                        this.path = [];
                    var e = "deviceA,deviceZ,lineType,text".split(",");
                    this.serializedProperties = this.serializedProperties.concat(e);
                }
            }
                ,
                this.caculateIndex = function() {
                    var a = e(this.nodeA, this.nodeZ);
                    a > 0 && (this.nodeIndex = a - 1)
                }
                ,
                this.initialize(b, c, g),
                this.removeHandler = function() {
                    var a = this;
                    this.nodeA && this.nodeA.outLinks && (this.nodeA.outLinks = this.nodeA.outLinks.filter(function(b) {
                            return b !== a
                        }
                    )),
                    this.nodeZ && this.nodeZ.inLinks && (this.nodeZ.inLinks = this.nodeZ.inLinks.filter(function(b) {
                            return b !== a
                        }
                    ));
                    var b = d(this);
                    b.forEach(function(a, b) {
                            a.nodeIndex = b
                        }
                    )
                }
                ,
                this.getStartPosition = function() {
                    var a = {
                        x: this.nodeA.cx,
                        y: this.nodeA.cy
                    };
                    return a
                }
                ,
                this.getEndPosition = function() {
                    var a;
                    return null  != this.arrowsRadius && (a = h(this.nodeZ, this.nodeA)),
                    null  == a && (a = {
                        x: this.nodeZ.cx,
                        y: this.nodeZ.cy
                    }),
                        a
                }
                ,
                this.getPath = function() {
                    function rename_B(a, b) {//返回a开始节点b结束节点的link数组
                        var c = [];
                        if (null  == a || null  == b)
                            return c;
                        if (a && b && a.outLinks && b.inLinks)
                            for (var d = 0; d < a.outLinks.length; d++)
                                for (var e = a.outLinks[d], f = 0; f < b.inLinks.length; f++) {
                                    var g = b.inLinks[f];
                                    e === g && c.push(g)
                                }
                                return c
                    }
                    var a = []
                        ,
                        b = this.getStartPosition()
                        ,
                        c = this.getEndPosition();
                    if (this.nodeA === this.nodeZ)
                        return [b, c];
                    var d = e(this.nodeA, this.nodeZ);
                    if (1 == d)
                        return [b, c];
                    var links1 = rename_B(this.nodeA,this.nodeZ);
                    var links2 = rename_B(this.nodeZ,this.nodeA);
                    var exchangeFlag = links2.length>links1.length||(links2.length==links1.length&&this.nodeA.id+''<this.nodeZ.id+'');
                    if(exchangeFlag){
                        var temp = b;
                        b = c;
                        c = temp;
                    }
                    var f = Math.atan2(c.y - b.y, c.x - b.x)
                        ,
                        g = {
                            x: b.x + this.bundleOffset * Math.cos(f),
                            y: b.y + this.bundleOffset * Math.sin(f)
                        }
                        ,
                        h = {
                            x: c.x + this.bundleOffset * Math.cos(f - Math.PI),
                            y: c.y + this.bundleOffset * Math.sin(f - Math.PI)
                        }
                        ,
                        i = f - Math.PI / 2
                        ,
                        j = f - Math.PI / 2
                        ,
                        k = d * this.bundleGap / 2 - this.bundleGap / 2
                        ,
                        l = this.bundleGap * this.nodeIndex
                        ,
                        m = {
                            x: g.x + l * Math.cos(i),
                            y: g.y + l * Math.sin(i)
                        }
                        ,
                        n = {
                            x: h.x + l * Math.cos(j),
                            y: h.y + l * Math.sin(j)
                        };
                        if(exchangeFlag||this.arrowsReverse){
                            return m = {
                                x: m.x + k * Math.cos(i - Math.PI),
                                y: m.y + k * Math.sin(i - Math.PI)
                            },
                            n = {
                                x: n.x + k * Math.cos(j - Math.PI),
                                y: n.y + k * Math.sin(j - Math.PI)
                            },
                            a.push({
                                x: c.x,
                                y: c.y
                            }),
                            a.push({
                                x: n.x,
                                y: n.y
                            }),
                            a.push({
                                x: m.x,
                                y: m.y
                            }),
                            a.push({
                                x: b.x,
                                y: b.y
                            }),
                            a
                        }else {
                            return m = {
                                x: m.x + k * Math.cos(i - Math.PI),
                                y: m.y + k * Math.sin(i - Math.PI)
                            },
                            n = {
                                x: n.x + k * Math.cos(j - Math.PI),
                                y: n.y + k * Math.sin(j - Math.PI)
                            },
                            a.push({
                                x: b.x,
                                y: b.y
                            }),
                            a.push({
                                x: m.x,
                                y: m.y
                            }),
                            a.push({
                                x: n.x,
                                y: n.y
                            }),
                            a.push({
                                x: c.x,
                                y: c.y
                            }),
                            a
                        }
                }
                ,
                this.paintPath = function(a, b) {
                    if (this.nodeA === this.nodeZ)
                        return void this.paintLoop(a);
                    a.beginPath(),
                        a.moveTo(b[0].x, b[0].y);
                    for (var c = 1; c < b.length; c++)
                        null  == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);
                    if (a.stroke(),
                            a.closePath(),
                        null  != this.arrowsRadius) {
                        var d = b[b.length - 2]
                            ,
                            e = b[b.length - 1];
                        //反向箭头功能添加
                        if(this.arrowsReverse===true){
                            d = b[1];
                            e = b[0];
                        }
                        this.paintArrow(a, d, e)
                    }
                }
                ,
                this.paintLoop = function(a) {
                    a.beginPath();
                    {
                        var b = this.bundleGap * (this.nodeIndex + 1) / 2;
                        Math.PI + Math.PI / 2
                    }
                    a.arc(this.nodeA.x, this.nodeA.y, b, Math.PI / 2, 2 * Math.PI),
                        a.stroke(),
                        a.closePath()
                }
                ,
                this.paintArrow = function(b, c, d) {
                    var e = this.arrowsOffset
                        ,
                        f = this.arrowsRadius / 2
                        ,
                        g = c
                        ,
                        h = d
                        ,
                        i = Math.atan2(h.y - g.y, h.x - g.x)
                        ,
                        j = a.util.getDistance(g, h) - this.arrowsRadius
                        ,
                        k = g.x + (j + e) * Math.cos(i)
                        ,
                        l = g.y + (j + e) * Math.sin(i)
                        ,
                        m = h.x + e * Math.cos(i)
                        ,
                        n = h.y + e * Math.sin(i);
                    i -= Math.PI / 2;
                    var o = {
                            x: k + f * Math.cos(i),
                            y: l + f * Math.sin(i)
                        }
                        ,
                        p = {
                            x: k + f * Math.cos(i - Math.PI),
                            y: l + f * Math.sin(i - Math.PI)
                        };
                    b.beginPath(),
                        b.fillStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")",
                        b.moveTo(o.x, o.y),
                        b.lineTo(m, n),
                        b.lineTo(p.x, p.y),
                        b.stroke(),
                        b.closePath()
                }
                ,
                this.paint = function(a) {
                    if (null  != this.nodeA && null  != !this.nodeZ) {
                        var b = this.getPath(this.nodeIndex);
                        this.path = b,
                            a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")",
                            a.lineWidth = this.lineWidth,
                            this.paintPath(a, b),
                        b && b.length > 0 && this.paintText(a, b)
                    }
                }
            ;
            var i = -(Math.PI / 2 + Math.PI / 4);
            this.paintText = function(a, b) {
            	//如果myTopoStyle属性为true text偏移量为0
            	if(this.myTopoStyle){
            		this.textOffsetX = 0;
            		this.textOffsetY =0;
            	}
            	
                var c = b[0]
                    ,
                    d = b[b.length - 1];
                if (4 == b.length && (c = b[1],
                        d = b[2]),
                    this.text && this.text.length > 0) {
                    var e = (d.x + c.x) / 2 + this.textOffsetX
                        ,
                        f = (d.y + c.y) / 2 + this.textOffsetY;
                    a.save(),
                        // a.beginPath(),
                        a.font = this.font;
                    var g = a.measureText(this.text).width
                        ,
                        h = a.measureText("田").width;
                    a.restore();
                    var backupX,backupY,backupSX,backupSY,backupEX,backupEY,delt=50,deltX,deltY;
                    var angle = Math.atan2(d.y - c.y, d.x - c.x);
                    if(angle>Math.PI/2||angle<-Math.PI/2)
                        angle += Math.PI;
                    if (this.nodeA === this.nodeZ) {
                        var j = this.bundleGap * (this.nodeIndex + 1) / 2
                            ,
                            e = this.nodeA.x + j * Math.cos(i)
                            ,
                            f = this.nodeA.y + j * Math.sin(i);
                        backupX = e;
                        backupY = f;
                    } else {

                        backupX=e - g / 2,
                        backupY=f - h / 2;
                        if(b.length==4){
                            // backupSX=c.x,backupSY = c.y, backupEX=d.x, backupEY=d.y;
                            a.save();
                            // a.font = this.font;
                            var deltS = this.deltS?this.deltS:0;
                            var delts = a.measureText(this.textS).width/2 + deltS;
                            a.restore();
                            backupSX = c.x + delts*Math.cos(Math.atan2(d.y - c.y, d.x - c.x));
                            backupSY = c.y + delts*Math.sin(Math.atan2(d.y - c.y, d.x - c.x));
                            a.save();
                            // a.font = this.font;
                            var deltE = this.deltE?this.deltE:0;
                            var delte = a.measureText(this.textE).width/2 + deltE;
                            a.restore();
                            backupEX = d.x + delte*Math.cos(Math.atan2(c.y - d.y, c.x - d.x));
                            backupEY = d.y + delte*Math.sin(Math.atan2(c.y - d.y, c.x - d.x));
                        }else {
                            backupSX = c.x + delt*Math.cos(Math.atan2(d.y - c.y, d.x - c.x));
                            backupSY = c.y + delt*Math.sin(Math.atan2(d.y - c.y, d.x - c.x));
                            backupEX = d.x + delt*Math.cos(Math.atan2(c.y - d.y, c.x - d.x));
                            backupEY = d.y + delt*Math.sin(Math.atan2(c.y - d.y, c.x - d.x));
                        }
                        
                    }
                    if(this.myTopoStyle){
                        //以下为绘制线中部文字
                        if(this.text&&backupX){
                            backupX = e;
                            backupY = f;
                            a.save();
                            a.translate(backupX,backupY);
                            if(this.textRotate==true)
                                a.rotate(angle);
                            a.beginPath();
                            a.font = this.font;
                            a.fillStyle="rgba(" + this.strokeColor + ","+this.alpha+")";
                            a.JTopoRoundRect(-g/2-2,-h/2-2,g+4,h+4,3);
                            a.fill();
                            a.closePath();
                            a.beginPath();
                            a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";
                            a.fillText(this.text, -g/2, -h/2+h-2);
                            a.stroke();
                            a.closePath();
                            a.restore();
                        }
                        if(this.textS&&backupSX) 
                        {
                            a.save()
                            a.translate(backupSX,backupSY);
                            if(this.textRotate==true)
                                a.rotate(angle);
                            a.beginPath();
                            // a.font = this.font;
                            a.fillStyle="rgba(" + this.strokeColor + ","+this.alpha+")";
                            a.JTopoRoundRect(-a.measureText(this.textS).width/2-2,-a.measureText("田").width/2-2,a.measureText(this.textS).width+4,a.measureText("田").width+4,3);
                            a.fill();
                            a.closePath();
                            a.beginPath();
                            a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";
                            a.fillText(this.textS, -a.measureText(this.textS).width/2, a.measureText("田").width/2-2);
                            a.stroke();
                            a.closePath();
                            a.restore();
                        }
                        if(this.textE&&backupEX){
                            a.save();
                            a.translate(backupEX,backupEY);
                            if(this.textRotate==true)
                                a.rotate(angle);
                            a.beginPath();
                            // a.font = this.font;
                            a.fillStyle="rgba(" + this.strokeColor + ","+this.alpha+")";
                            a.JTopoRoundRect(-a.measureText(this.textE).width/2-2,-a.measureText("田").width/2-2,a.measureText(this.textE).width+4,a.measureText("田").width+4,3);
                            a.fill();
                            a.closePath();
                            a.beginPath();
                            a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";
                            a.fillText(this.textE, -a.measureText(this.textE).width/2, a.measureText("田").width/2-2);
                            a.stroke();
                            a.closePath();
                            a.restore();
                        }
                        return ;
                    }
                    a.save(),
                    a.beginPath(),
                    a.font = this.font;
                    a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")";
                    a.fillText(this.text, backupX, backupY);
                    a.stroke(),
                    a.closePath(),
                    a.restore()
                }
            }
                ,
                this.paintSelected = function(a) {
                    a.shadowBlur = 10,
                        a.shadowColor = "rgba(0,0,0,1)",
                        a.shadowOffsetX = 0,
                        a.shadowOffsetY = 0
                }
                ,
                this.isInBound = function(b, c) {
                    if (this.nodeA === this.nodeZ) {
                        var d = this.bundleGap * (this.nodeIndex + 1) / 2
                            ,
                            e = a.util.getDistance(this.nodeA, {
                                    x: b,
                                    y: c
                                }) - d;
                        return Math.abs(e) <= 3
                    }
                    for (var f = !1, g = 1; g < this.path.length; g++) {
                        var h = this.path[g - 1]
                            ,
                            i = this.path[g];
                        if (1 == a.util.isPointInLine({
                                x: b,
                                y: c
                            }, h, i)) {
                            f = !0;
                            break
                        }
                    }
                    return f
                }
        }
        function g(a, b, c) {
            this.initialize = function() {
                g.prototype.initialize.apply(this, arguments),
                    this.direction = "horizontal";
                this.serializedProperties.push("direction");
            }
                ,
                this.initialize(a, b, c),
                this.getStartPosition = function() {
                    var a = {
                        x: this.nodeA.cx,
                        y: this.nodeA.cy
                    };
                    return "horizontal" == this.direction ? this.nodeZ.cx > a.x ? a.x += this.nodeA.width / 2 : a.x -= this.nodeA.width / 2 : this.nodeZ.cy > a.y ? a.y += this.nodeA.height / 2 : a.y -= this.nodeA.height / 2,
                        a
                }
                ,
                this.getEndPosition = function() {
                    var a = {
                        x: this.nodeZ.cx,
                        y: this.nodeZ.cy
                    };
                    return "horizontal" == this.direction ? this.nodeA.cy < a.y ? a.y -= this.nodeZ.height / 2 : a.y += this.nodeZ.height / 2 : a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width,
                        a
                }
                ,
                this.getPath = function(a) {
                    var b = []
                        ,
                        c = this.getStartPosition()
                        ,
                        d = this.getEndPosition();
                    if (this.nodeA === this.nodeZ)
                        return [c, d];
                    var f, g, h = e(this.nodeA, this.nodeZ),
                        i = (h - 1) * this.bundleGap,
                        j = this.bundleGap * a - i / 2;
                    return "horizontal" == this.direction ? (f = d.x + j,
                        g = c.y - j,
                        b.push({
                            x: c.x,
                            y: g
                        }),
                        b.push({
                            x: f,
                            y: g
                        }),
                        b.push({
                            x: f,
                            y: d.y
                        })) : (f = c.x + j,
                        g = d.y - j,
                        b.push({
                            x: f,
                            y: c.y
                        }),
                        b.push({
                            x: f,
                            y: g
                        }),
                        b.push({
                            x: d.x,
                            y: g
                        })),
                        b
                }
                ,
                this.paintText = function(a, b) {
                    if (this.text && this.text.length > 0) {
                        var c = b[1]
                            ,
                            d = c.x + this.textOffsetX
                            ,
                            e = c.y + this.textOffsetY;
                        a.save(),
                            a.beginPath(),
                            a.font = this.font;
                        var f = a.measureText(this.text).width
                            ,
                            g = a.measureText("田").width;
                        a.fillStyle = "rgba(" + this.fontColor + ", " + this.alpha + ")",
                            a.fillText(this.text, d - f / 2, e - g / 2),
                            a.stroke(),
                            a.closePath(),
                            a.restore()
                    }
                }
        }
        function h(a, b, c) {
            this.initialize = function() {
                h.prototype.initialize.apply(this, arguments),
                    this.direction = "vertical",
                    this.offsetGap = 44;
                this.serializedProperties.push("direction");
            }
                ,
                this.initialize(a, b, c),
                this.getStartPosition = function() {
                    var a = {
                        x: this.nodeA.cx,
                        y: this.nodeA.cy
                    };
                    return "horizontal" == this.direction ? a.x = this.nodeZ.cx < a.x ? this.nodeA.x : this.nodeA.x + this.nodeA.width : a.y = this.nodeZ.cy < a.y ? this.nodeA.y : this.nodeA.y + this.nodeA.height,
                        a
                }
                ,
                this.getEndPosition = function() {
                    var a = {
                        x: this.nodeZ.cx,
                        y: this.nodeZ.cy
                    };
                    return "horizontal" == this.direction ? a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width : a.y = this.nodeA.cy < a.y ? this.nodeZ.y : this.nodeZ.y + this.nodeZ.height,
                        a
                }
                ,
                this.getPath = function(a) {
                    var b = this.getStartPosition()
                        ,
                        c = this.getEndPosition();
                    if (this.nodeA === this.nodeZ)
                        return [b, c];
                    var d = []
                        ,
                        f = e(this.nodeA, this.nodeZ)
                        ,
                        g = (f - 1) * this.bundleGap
                        ,
                        h = this.bundleGap * a - g / 2
                        ,
                        i = this.offsetGap;
                    return "horizontal" == this.direction ? (this.nodeA.cx > this.nodeZ.cx && (i = -i),
                        d.push({
                            x: b.x,
                            y: b.y + h
                        }),
                        d.push({
                            x: b.x + i,
                            y: b.y + h
                        }),
                        d.push({
                            x: c.x - i,
                            y: c.y + h
                        }),
                        d.push({
                            x: c.x,
                            y: c.y + h
                        })) : (this.nodeA.cy > this.nodeZ.cy && (i = -i),
                        d.push({
                            x: b.x + h,
                            y: b.y
                        }),
                        d.push({
                            x: b.x + h,
                            y: b.y + i
                        }),
                        d.push({
                            x: c.x + h,
                            y: c.y - i
                        }),
                        d.push({
                            x: c.x + h,
                            y: c.y
                        })),
                        d
                }
        }
        function i(a, b, c) {
            this.initialize = function() {
                i.prototype.initialize.apply(this, arguments)
            }
                ,
                this.initialize(a, b, c),
                this.paintPath = function(a, b) {
                    if (this.nodeA === this.nodeZ)
                        return void this.paintLoop(a);
                    a.beginPath(),
                        a.moveTo(b[0].x, b[0].y);
                    for (var c = 1; c < b.length; c++) {
                        var d = b[c - 1]
                            ,
                            e = b[c]
                            ,
                            f = (d.x + e.x) / 2
                            ,
                            g = (d.y + e.y) / 2;
                        g += (e.y - d.y) / 2,
                            a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")",
                            a.lineWidth = this.lineWidth,
                            a.moveTo(d.x, d.cy),
                            a.quadraticCurveTo(f, g, e.x, e.y),
                            a.stroke()
                    }
                    if (a.stroke(),
                            a.closePath(),
                        null  != this.arrowsRadius) {
                        var h = b[b.length - 2]
                            ,
                            i = b[b.length - 1];
                        this.paintArrow(a, h, i)
                    }
                }
        }
        function j(a,b,c){
            this.initialize = function() {
                i.prototype.initialize.apply(this, arguments)
            };
            this.initialize(a, b, c);
            this.paintPath = function(a, b) {
                if (this.nodeA === this.nodeZ)
                    return void this.paintLoop(a);
                if(b.length==4){
                    // a.beginPath();
                    createCurve(b,b.length,a);
                    // a.moveTo(b[0].x, b[0].y);
                    // a.bezierCurveTo(b[1].x, b[1].y, b[2].x, b[2].y,b[3].x,b[3].y);
                    // a.stroke();
                    // a.closePath();
                }else if(b.length==3){
                    a.beginPath();
                    a.moveTo(b[0].x, b[0].y);
                    a.quadraticCurveTo(b[1].x, b[1].y, b[2].x, b[2].y);
                    a.stroke();
                    a.closePath();
                }else {
                    a.beginPath();
                    a.moveTo(b[0].x, b[0].y);
                    for (var c = 1; c < b.length; c++)
                        null  == this.dashedPattern ? a.lineTo(b[c].x, b[c].y) : a.JTopoDashedLineTo(b[c - 1].x, b[c - 1].y, b[c].x, b[c].y, this.dashedPattern);
                    a.stroke();
                    a.closePath();
                }
                if (null  != this.arrowsRadius) {
                    var h = b[b.length - 2]
                        ,
                        i = b[b.length - 1];
                    this.paintArrow(a, h, i)
                }
                function createCurve(originPoint, originCount ,a){
                    //控制点收缩系数 ，经调试0.6较好
                    var scale = 1;  
                    var midpoints = [];
                    //生成中点       
                    for(var i = 0 ;i < originCount ; i++){      
                        var nexti = (i + 1) % originCount;
                        var midpoint = {};
                        midpoint.x = (originPoint[i].x + originPoint[nexti].x)/2.0;
                        midpoint.y = (originPoint[i].y + originPoint[nexti].y)/2.0;
                        midpoints.push(midpoint);
                    }
                      
                    //平移中点  
                    var extrapoints = [];   
                    for(var i=0;i<2 * originCount;i++){
                        var obj = {};
                        extrapoints.push(obj);
                    }
                    for(var i = 0 ;i < originCount ; i++){  
                         var nexti = (i + 1) % originCount;  
                         var backi = (i + originCount - 1) % originCount;  
                         //计算距离比例
                         // var proportion1 = 
                         var midinmid = {};  
                         midinmid.x = (midpoints[i].x + midpoints[backi].x)/2.0;  
                         midinmid.y = (midpoints[i].y + midpoints[backi].y)/2.0;  
                         var offsetx = originPoint[i].x - midinmid.x;  
                         var offsety = originPoint[i].y - midinmid.y;  
                         var extraindex = 2 * i;  
                         extrapoints[extraindex] = {};
                         extrapoints[extraindex].x = midpoints[backi].x + offsetx;  
                         extrapoints[extraindex].y = midpoints[backi].y + offsety;  
                         //朝 originPoint[i]方向收缩   
                         var addx = (extrapoints[extraindex].x - originPoint[i].x) * scale;  
                         var addy = (extrapoints[extraindex].y - originPoint[i].y) * scale;  
                         extrapoints[extraindex].x = originPoint[i].x + addx;  
                         extrapoints[extraindex].y = originPoint[i].y + addy;  
                           
                         var extranexti = (extraindex + 1)%(2 * originCount);  
                         extrapoints[extranexti].x = midpoints[i].x + offsetx;  
                         extrapoints[extranexti].y = midpoints[i].y + offsety;  
                         //朝 originPoint[i]方向收缩   
                         addx = (extrapoints[extranexti].x - originPoint[i].x) * scale;  
                         addy = (extrapoints[extranexti].y - originPoint[i].y) * scale;  
                         extrapoints[extranexti].x = originPoint[i].x + addx;  
                         extrapoints[extranexti].y = originPoint[i].y + addy;
                    }
                      
                    var controlPoint = [{},{},{},{}];
                    //生成4控制点，产生贝塞尔曲线
                    a.beginPath();
                    a.strokeStyle = "rgba(" + this.strokeColor + "," + this.alpha + ")";
                    a.lineWidth = this.lineWidth;
                    for(var i = 0;i < originCount ; i++){  
                           controlPoint[0] = originPoint[i];  
                           var extraindex = 2 * i;  
                           controlPoint[1] = extrapoints[extraindex + 1];  
                           var extranexti = (extraindex + 2) % (2 * originCount);  
                           controlPoint[2] = extrapoints[extranexti];
                           var nexti = (i + 1) % originCount;
                           controlPoint[3] = originPoint[nexti];
                           if(i==0){
                                a.moveTo(controlPoint[0].x,controlPoint[0].y);
                                // controlPoint[1] = controlPoint[0];
                                a.bezierCurveTo(controlPoint[1].x,controlPoint[1].y,controlPoint[2].x,controlPoint[2].y,controlPoint[3].x,controlPoint[3].y);
                           }else if(i==originCount-1){

                           }else if(i==originCount-2){
                                // controlPoint[2] = controlPoint[3];
                                a.bezierCurveTo(controlPoint[1].x,controlPoint[1].y,controlPoint[2].x,controlPoint[2].y,controlPoint[3].x,controlPoint[3].y);
                           }else {
                                a.bezierCurveTo(controlPoint[1].x,controlPoint[1].y,controlPoint[2].x,controlPoint[2].y,controlPoint[3].x,controlPoint[3].y);
                           }
                    }
                    a.stroke();
                    a.closePath();
                }
            }

        }
        function SquarelyFlexionalLink(a, b, c){
            this.initialize = function() {
                h.prototype.initialize.apply(this, arguments),
                    this.direction = "vertical",
                    this.offsetGap = 44;
                this.serializedProperties.push("direction");
            }
                ,
                this.initialize(a, b, c),
                this.getStartPosition = function() {
                    var a = {
                        x: this.nodeA.cx,
                        y: this.nodeA.cy
                    };
                    return "horizontal" == this.direction ? a.x = this.nodeZ.cx < a.x ? this.nodeA.x : this.nodeA.x + this.nodeA.width : a.y = this.nodeZ.cy < a.y ? this.nodeA.y : this.nodeA.y + this.nodeA.height,
                        a
                }
                ,
                this.getEndPosition = function() {
                    var a = {
                        x: this.nodeZ.cx,
                        y: this.nodeZ.cy
                    };
                    return "horizontal" == this.direction ? a.x = this.nodeA.cx < a.x ? this.nodeZ.x : this.nodeZ.x + this.nodeZ.width : a.y = this.nodeA.cy < a.y ? this.nodeZ.y : this.nodeZ.y + this.nodeZ.height,
                        a
                }
                ,
                this.getPath = function(a) {
                    var b = this.getStartPosition()
                        ,
                        c = this.getEndPosition();
                    if (this.nodeA === this.nodeZ)
                        return [b, c];
                    var d = []
                        ,
                        f = e(this.nodeA, this.nodeZ)
                        ,
                        g = (f - 1) * this.bundleGap
                        ,
                        h = this.bundleGap * a - g / 2
                        ,
                        i = this.offsetGap;
                    return "horizontal" == this.direction ? (this.nodeA.cx > this.nodeZ.cx && (i = -i),
                        d.push({
                            x: b.x,
                            y: b.y + h
                        }),
                        d.push({
                            x: b.x + Number(i),
                            y: b.y + h
                        }),
                        d.push({
                            x: c.x - (c.x-b.x-i),
                            y: c.y + h
                        }),
                        d.push({
                            x: c.x,
                            y: c.y + h
                        })) : (this.nodeA.cy > this.nodeZ.cy && (i = -i),
                        d.push({
                            x: b.x + h,
                            y: b.y
                        }),
                        d.push({
                            x: b.x + h,
                            y: b.y + Number(i)
                        }),
                        d.push({
                            x: c.x + h,
                            y: c.y - (c.y-b.y-i)
                        }),
                        d.push({
                            x: c.x + h,
                            y: c.y
                        })),
                        d
                }
        }
        f.prototype = new a.InteractiveElement,
            g.prototype = new f,
            h.prototype = new f,
            i.prototype = new f,
            j.prototype = new f,
            SquarelyFlexionalLink.prototype = new f,
            a.Link = f,
            a.FoldLink = g,
            a.FlexionalLink = h,
            a.CurveLink = i,
            a.BezierLink = j,
            a.SquarelyFlexionalLink = SquarelyFlexionalLink
    }
    (JTopo),
    /*mark : container*/
    function(a) {
        function b(c) {
            this.initialize = function(c) {
                b.prototype.initialize.apply(this, null ),
                    this.elementType = "container",
                    this.id = "",
                    this.zIndex = a.zIndex_Container,
                    this.width = 100,
                    this.height = 100,
                    this.childs = [],
                    this.alpha = .5,
                    this.dragable = !0,
                    this.childDragble = !0,
                    this.visible = !0,
                    this.fillColor = "10,100,80",
                    this.borderWidth = 0,
                    this.borderColor = "255,255,255",
                    this.borderAlpha = .5,
                    this.borderRadius = 0,
                    this.font = "12px Consolas",
                    this.fontColor = "255,255,255",
                    this.fontAlpha = .5,
                    this.text = c,
                    this.textPosition = "Bottom_Center",
                    this.textOffsetX = 0,
                    this.textOffsetY = 0,
                    this.dashedPattern = 0,
                    this.layout = new a.layout.AutoBoundLayout;
                var e = "childNodes,textPosition,text,id,topoLevel,parentLevel,nextLevel".split(",");
                this.serializedProperties = this.serializedProperties.concat(e)
            }
                ,
                this.initialize(c),
                this.add = function(a) {
                    this.childs.push(a),
                        a.dragable = this.childDragble
                }
                ,
                this.remove = function(a) {
                    for (var b = 0; b < this.childs.length; b++)
                        if (this.childs[b] === a) {
                            a.parentContainer = null ,
                                this.childs = this.childs.del(b),
                                a.lastParentContainer = this;
                            break
                        }
                }
                ,
                this.removeAll = function() {
                    this.childs = []
                }
                ,
                this.setLocation = function(a, b) {
                    var c = a - this.x
                        ,
                        d = b - this.y;
                    this.x = a,
                        this.y = b;
                    for (var e = 0; e < this.childs.length; e++) {
                        var f = this.childs[e];
                        f.setLocation(f.x + c, f.y + d)
                    }
                }
                ,
                this.doLayout = function(a) {
                    a && a(this, this.childs)
                }
                ,
                this.paint = function(a) {
                    this.visible && (this.layout && this.layout(this, this.childs),
                        a.beginPath(),
                        a.fillStyle = "rgba(" + this.fillColor + "," + this.alpha + ")",
                        null  == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x, this.y, this.width, this.height) : a.JTopoRoundRect(this.x, this.y, this.width, this.height, this.borderRadius),
                        a.fill(),
                        a.closePath(),
                        this.paintText(a),
                        this.paintBorder(a))
                }
                ,
                this.paintBorder = function(a) {
                    if (0 != this.borderWidth) {
                        a.beginPath();
                        a.lineWidth = this.borderWidth;
                        a.strokeStyle = "rgba(" + this.borderColor + "," + this.borderAlpha + ")";
                        var b = this.borderWidth / 2;
                        if(null  == this.borderRadius || 0 == this.borderRadius){
                            if(this.dashedPattern && this.dashedPattern !=0){
                                a.JTopoRoundDashedRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, 0, this.dashedPattern)
                            }else {
                                a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth)
                            }
                        }else {
                            if(this.dashedPattern && this.dashedPattern !=0){
                                a.JTopoRoundDashedRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius, this.dashedPattern)
                            }else {
                                a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius)
                            }
                        }
                        // null  == this.borderRadius || 0 == this.borderRadius ? a.rect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth) : this.dashedPattern? a.JTopoRoundDashedRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius, this.dashedPattern) : a.JTopoRoundRect(this.x - b, this.y - b, this.width + this.borderWidth, this.height + this.borderWidth, this.borderRadius),
                        a.stroke();
                        a.closePath();
                    }
                }
                ,
                this.paintText = function(a) {
                    var b = this.text;
                    if (null  != b && "" != b) {
                        a.beginPath(),
                            a.font = this.font;
                        var c = a.measureText(b).width
                            ,
                            d = a.measureText("田").width;
                        a.fillStyle = "rgba(" + this.fontColor + ", " + this.fontAlpha + ")";
                        var e = this.getTextPostion(this.textPosition, c, d);
                        a.fillText(b, e.x, e.y),
                            a.closePath()
                    }
                }
                ,
                this.getTextPostion = function(a, b, c) {
                    var d = null ;
                    return null  == a || "Bottom_Center" == a ? d = {
                        x: this.x + this.width / 2 - b / 2,
                        y: this.y + this.height + c
                    } : "Top_Center" == a ? d = {
                        x: this.x + this.width / 2 - b / 2,
                        y: this.y - c / 2
                    } : "Top_Right" == a ? d = {
                        x: this.x + this.width - b,
                        y: this.y - c / 2
                    } : "Top_Left" == a ? d = {
                        x: this.x,
                        y: this.y - c / 2
                    } : "Bottom_Right" == a ? d = {
                        x: this.x + this.width - b,
                        y: this.y + this.height + c
                    } : "Bottom_Left" == a ? d = {
                        x: this.x,
                        y: this.y + this.height + c
                    } : "Middle_Center" == a ? d = {
                        x: this.x + this.width / 2 - b / 2,
                        y: this.y + this.height / 2 + c / 2
                    } : "Middle_Right" == a ? d = {
                        x: this.x + this.width - b,
                        y: this.y + this.height / 2 + c / 2
                    } : "Middle_Left" == a && (d = {
                        x: this.x,
                        y: this.y + this.height / 2 + c / 2
                    }),
                    null  != this.textOffsetX && (d.x += this.textOffsetX),
                    null  != this.textOffsetY && (d.y += this.textOffsetY),
                        d
                }
                ,
                this.paintMouseover = function() {
                }
                ,
                this.paintSelected = function(a) {
                    a.shadowBlur = 10,
                        a.shadowColor = "rgba(0,0,0,1)",
                        a.shadowOffsetX = 0,
                        a.shadowOffsetY = 0
                }
        }
        b.prototype = new a.InteractiveElement,
            a.Container = b
    }
    (JTopo),
    /*mark : layout*/
    function(a) {
        function getNodesCenter(a) {
            var b = 0
                ,
                c = 0;
            a.forEach(function(a) {
                    b += a.cx,
                        c += a.cy
                }
            );
            var d = {
                x: b / a.length,
                y: c / a.length
            };
            return d
        }
        function circleLayoutNodes(c, d) {
            null  == d && (d = {});
            {
                var e = d.cx
                    ,
                    f = d.cy
                    ,
                    g = d.minRadius
                    ,
                    h = d.nodeDiameter
                    ,
                    i = d.hScale || 1
                    ,
                    j = d.vScale || 1;
                d.beginAngle || 0,
                d.endAngle || 2 * Math.PI
            }
            if (null  == e || null  == f) {
                var k = getNodesCenter(c);
                e = k.x,
                    f = k.y
            }
            var l = 0
                ,
                m = []
                ,
                n = [];
            c.forEach(function(a) {
                    null  == d.nodeDiameter ? (a.diameter && (h = a.diameter),
                        h = a.radius ? 2 * a.radius : Math.sqrt(2 * a.width * a.height),
                        n.push(h)) : n.push(h),
                        l += h
                }
            ),
                c.forEach(function(a, b) {
                        var c = n[b] / l;
                        m.push(Math.PI * c)
                    }
                );
            var o = (c.length,
                m[0] + m[1])
                ,
                p = n[0] / 2 + n[1] / 2
                ,
                q = p / 2 / Math.sin(o / 2);
            null  != g && g > q && (q = g);
            var r = q * i
                ,
                s = q * j
                ,
                t = d.animate;
            if (t) {
                var u = t.time || 1e3
                    ,
                    v = 0;
                c.forEach(function(b, c) {
                        v += 0 == c ? m[c] : m[c - 1] + m[c];
                        var d = e + Math.cos(v) * r
                            ,
                            g = f + Math.sin(v) * s;
                        a.Animate.stepByStep(b, {
                            x: d - b.width / 2,
                            y: g - b.height / 2
                        }, u).start()
                    }
                )
            } else {
                var v = 0;
                c.forEach(function(a, b) {
                        v += 0 == b ? m[b] : m[b - 1] + m[b];
                        var c = e + Math.cos(v) * r
                            ,
                            d = f + Math.sin(v) * s;
                        a.cx = c,
                            a.cy = d
                    }
                )
            }
            return {
                cx: e,
                cy: f,
                radius: r,
                radiusA: r,
                radiusB: s
            }
        }
        function gridLayout(a, b) {
            return function(c) {
                var d = c.childs;
                if (!(d.length <= 0))
                    for (var e = c.getBound(), f = d[0], g = (e.width - f.width) / b, h = (e.height - f.height) / a, i = (d.length,
                        0), j = 0; a > j; j++)
                        for (var k = 0; b > k; k++) {
                            var l = d[i++]
                                ,
                                m = e.left + g / 2 + k * g
                                ,
                                n = e.top + h / 2 + j * h;
                            if (l.setLocation(m, n),
                                i >= d.length)
                                return
                        }
            }
        }
        function flowLayout(a, b) {
            return null  == a && (a = 0),
            null  == b && (b = 0),
                function(c) {
                    var d = c.childs;
                    if (!(d.length <= 0))
                        for (var e = c.getBound(), f = e.left, g = e.top, h = 0; h < d.length; h++) {
                            var i = d[h];
                            f + i.width >= e.right && (f = e.left,
                                g += b + i.height),
                                i.setLocation(f, g),
                                f += a + i.width
                        }
                }
        }
        function autoBoundLayout() {
            return function(a, b) {
                if (b.length > 0) {
                    var leftNode = b[0],rightNode = b[0],topNode = b[0],bottomNode = b[0];
                    for (var c = 1e7, d = -1e7, e = 1e7, f = -1e7, g = d - c, h = f - e, i = 0; i < b.length; i++) {
                        var j = b[i];
                        // j.x <= c && (c = j.x),
                        // j.x >= d && (d = j.x),
                        // j.y <= e && (e = j.y),
                        // j.y >= f && (f = j.y),
                            // g = d - c + j.width,
                            // h = f - e + j.height
                        j.x <= leftNode.x && (leftNode = j),
                        j.x+j.width >= rightNode.x+rightNode.width && (rightNode = j),
                        j.y <= topNode.y && (topNode = j),
                        j.y+j.height >= bottomNode.y+bottomNode.height && (bottomNode = j);
                    }
                    // a.x = c,
                    //     a.y = e,
                    //     a.width = g,
                    //     a.height = h;
                    a.x = leftNode.x;
                    a.y = topNode.y;
                    a.width = rightNode.x-leftNode.x + rightNode.width;
                    a.height = bottomNode.y-topNode.y + bottomNode.height;
                        if(a.padding && typeof a.padding == 'number'){
                            a.x = a.x - a.padding;
                            a.y = a.y - a.padding;
                            a.width = a.width + a.padding*2;
                            a.height = a.height + a.padding*2;
                        }
                }
            }
        }
        function getRootNodes(b) {
            var c = []
                ,
                d = b.filter(function(b) {
                        return b instanceof a.Link ? !0 : (c.push(b),
                            !1)
                    }
                );
            return b = c.filter(function(a) {
                    for (var b = 0; b < d.length; b++)
                        if (d[b].nodeZ === a)
                            return !1;
                    return !0
                }
            ),
                b = b.filter(function(a) {
                        for (var b = 0; b < d.length; b++)
                            if (d[b].nodeA === a)
                                return !0;
                        return !1
                    }
                )
        }
        function h(a) {
            var b = 0
                ,
                c = 0;
            return a.forEach(function(a) {
                    b += a.width,
                        c += a.height
                }
            ),
            {
                width: b / a.length,
                height: c / a.length
            }
        }
        function i(a, b, c, d) {
            b.x += c,
                b.y += d;
            for (var e = getNodeChilds(a, b), f = 0; f < e.length; f++)
                i(a, e[f], c, d)
        }
        function j(a, b) {
            function c(b, e) {
                var f = getNodeChilds(a, b);
                null  == d[e] && (d[e] = {},
                    d[e].nodes = [],
                    d[e].childs = []),
                    d[e].nodes.push(b),
                    d[e].childs.push(f);
                for (var g = 0; g < f.length; g++)
                    c(f[g], e + 1),
                        f[g].parent = b
            }
            var d = [];
            return c(b, 0),
                d
        }
        function treeLayout(b, c, d) {
            return function(e) {
                function f(f, g) {
                    for (var h = a.layout.getTreeDeep(f, g), k = j(f, g), l = k["" + h].nodes, m = 0; m < l.length; m++) {
                        var n = l[m]
                            ,
                            o = (m + 1) * (c + 10)
                            ,
                            p = h * d;
                        "down" == b || ("up" == b ? p = -p : "left" == b ? (o = -h * d,
                            p = (m + 1) * (c + 10)) : "right" == b && (o = h * d,
                            p = (m + 1) * (c + 10))),
                            n.setLocation(o, p)
                    }
                    for (var q = h - 1; q >= 0; q--)
                        for (var r = k["" + q].nodes, s = k["" + q].childs, m = 0; m < r.length; m++) {
                            var t = r[m]
                                ,
                                u = s[m];
                            if ("down" == b ? t.y = q * d : "up" == b ? t.y = -q * d : "left" == b ? t.x = -q * d : "right" == b && (t.x = q * d),
                                    u.length > 0 ? "down" == b || "up" == b ? t.x = (u[0].x + u[u.length - 1].x) / 2 : ("left" == b || "right" == b) && (t.y = (u[0].y + u[u.length - 1].y) / 2) : m > 0 && ("down" == b || "up" == b ? t.x = r[m - 1].x + r[m - 1].width + c : ("left" == b || "right" == b) && (t.y = r[m - 1].y + r[m - 1].height + c)),
                                m > 0)
                                if ("down" == b || "up" == b) {
                                    if (t.x < r[m - 1].x + r[m - 1].width)
                                        for (var v = r[m - 1].x + r[m - 1].width + c, w = Math.abs(v - t.x), x = m; x < r.length; x++)
                                            i(e.childs, r[x], w, 0)
                                } else if (("left" == b || "right" == b) && t.y < r[m - 1].y + r[m - 1].height)
                                    for (var y = r[m - 1].y + r[m - 1].height + c, z = Math.abs(y - t.y), x = m; x < r.length; x++)
                                        i(e.childs, r[x], 0, z)
                        }
                }
                var g = null ;
                null  == c && (g = h(e.childs),
                    c = g.width,
                ("left" == b || "right" == b) && (c = g.width + 10)),
                null  == d && (null  == g && (g = h(e.childs)),
                    d = 2 * g.height),
                null  == b && (b = "down");
                var k = a.layout.getRootNodes(e.childs);
                if (k.length > 0) {
                    f(e.childs, k[0]);
                    var l = a.util.getElementsBound(e.childs)
                        ,
                        m = e.getCenterLocation()
                        ,
                        n = m.x - (l.left + l.right) / 2
                        ,
                        o = m.y - (l.top + l.bottom) / 2;
                    e.childs.forEach(function(b) {
                            b instanceof a.Node && (b.x += n,
                                b.y += o)
                        }
                    )
                }
            }
        }
        function circleLayout(b) {
            return function(c) {
                function d(a, c, e) {
                    var f = getNodeChilds(a, c);
                    if (0 != f.length) {
                        null  == e && (e = b);
                        var g = 2 * Math.PI / f.length;
                        f.forEach(function(b, f) {
                                var h = c.x + e * Math.cos(g * f)
                                    ,
                                    i = c.y + e * Math.sin(g * f);
                                b.setLocation(h, i);
                                var j = e / 2;
                                d(a, b, j)
                            }
                        )
                    }
                }
                var e = a.layout.getRootNodes(c.childs);
                if (e.length > 0) {
                    d(c.childs, e[0]);
                    var f = a.util.getElementsBound(c.childs)
                        ,
                        g = c.getCenterLocation()
                        ,
                        h = g.x - (f.left + f.right) / 2
                        ,
                        i = g.y - (f.top + f.bottom) / 2;
                    c.childs.forEach(function(b) {
                            b instanceof a.Node && (b.x += h,
                                b.y += i)
                        }
                    )
                }
            }
        }
        function m(a, b, c, d, e, f) {
            for (var g = [], h = 0; c > h; h++)
                for (var i = 0; d > i; i++)
                    g.push({
                        x: a + i * e,
                        y: b + h * f
                    });
            return g
        }
        function n(a, b, c, d, e, f) {
            var g = e ? e : 0
                ,
                h = f ? f : 2 * Math.PI
                ,
                i = h - g
                ,
                j = i / c
                ,
                k = [];
            g += j / 2;
            for (var l = g; h >= l; l += j) {
                var m = a + Math.cos(l) * d
                    ,
                    n = b + Math.sin(l) * d;
                k.push({
                    x: m,
                    y: n
                })
            }
            return k
        }
        function o(a, b, c, d, e, f) {
            var g = f || "bottom"
                ,
                h = [];
            if ("bottom" == g)
                for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)
                    h.push({
                        x: i + j * d,
                        y: b + e
                    });
            else if ("top" == g)
                for (var i = a - c / 2 * d + d / 2, j = 0; c >= j; j++)
                    h.push({
                        x: i + j * d,
                        y: b - e
                    });
            else if ("right" == g)
                for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)
                    h.push({
                        x: a + e,
                        y: i + j * d
                    });
            else if ("left" == g)
                for (var i = b - c / 2 * d + d / 2, j = 0; c >= j; j++)
                    h.push({
                        x: a - e,
                        y: i + j * d
                    });
            return h
        }
        function m(a, b, c, d, e, f) {
            for (var g = [], h = 0; c > h; h++)
                for (var i = 0; d > i; i++)
                    g.push({
                        x: a + i * e,
                        y: b + h * f
                    });
            return g
        }
        function adjustPosition(a, b) {
            if (a.layout) {
                var c = a.layout,
                d = c.type,
                e = null;
                if ("circle" == d) {
                    var f = c.radius || Math.max(a.width, a.height);
                    e = n(a.cx, a.cy, b.length, f, a.layout.beginAngle, a.layout.endAngle)
                } else if ("tree" == d) {
                    var g = c.width || 50,
                    h = c.height || 50,
                    i = c.direction;
                    e = o(a.cx, a.cy, b.length, g, h, i)
                } else {
                    if ("grid" != d) return;
                    e = m(a.x, a.y, c.rows, c.cols, c.horizontal || 0, c.vertical || 0)
                }
                for (var j = 0; j < b.length; j++) b[j].setCenterLocation(e[j].x, e[j].y)
            }
        }
        function getNodeChilds(scene, rootNode) {
            for (var d = [], e = 0; e < scene.length; e++)
                scene[e] instanceof a.Link && scene[e].nodeA === rootNode && d.push(scene[e].nodeZ);
            return d
        }
        function layoutNode(scene, rootNode, isRecursion, event) {
            //获取节点b有连线指向的节点集合
            var d = getNodeChilds(scene.childs, rootNode);
            if (0 == d.length)
                return null ;
            if (adjustPosition(rootNode, d, event),
                1 == isRecursion)
                for (var e = 0; e < d.length; e++)
                    layoutNode(scene, d[e], isRecursion, event);
            return null
        }
        function springLayout(b, c) {
            function d(a, b) {
                var c = a.x - b.x
                    ,
                    d = a.y - b.y;
                i += c * f,
                    j += d * f,
                    i *= g,
                    j *= g,
                    j += h,
                    b.x += i,
                    b.y += j
            }
            function e() {
                if (!(++k > 150)) {
                    for (var a = 0; a < l.length; a++)
                        l[a] != b && d(b, l[a], l);
                    setTimeout(e, 1e3 / 24)
                }
            }
            var f = .01
                ,
                g = .95
                ,
                h = -5
                ,
                i = 0
                ,
                j = 0
                ,
                k = 0
                ,
                l = c.getElementsByClass(a.Node);
            e()
        }
        function getTreeDeep(a, b) {
            function c(a, b, e) {
                var f = getNodeChilds(a, b);
                e > d && (d = e);
                for (var g = 0; g < f.length; g++)
                    c(a, f[g], e + 1)
            }
            var d = 0;
            return c(a, b, 0),
                d
        }
        a.layout = a.Layout = {
            layoutNode: layoutNode,
            getNodeChilds: getNodeChilds,
            adjustPosition: adjustPosition,
            springLayout: springLayout,
            getTreeDeep: getTreeDeep,
            getRootNodes: getRootNodes,
            GridLayout: gridLayout,
            FlowLayout: flowLayout,
            AutoBoundLayout: autoBoundLayout,
            CircleLayout: circleLayout,
            TreeLayout: treeLayout,
            getNodesCenter: getNodesCenter,
            circleLayoutNodes: circleLayoutNodes
        }
    }
    (JTopo),
    /*mark : chart*/
    function(a) {
        function b() {
            var b = new a.CircleNode;
            return b.radius = 150,
                b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"],
                b.datas = [.3, .3, .4],
                b.titles = ["A", "B", "C"],
                b.paint = function(a) {
                    var c = 2 * b.radius
                        ,
                        d = 2 * b.radius;
                    b.width = c,
                        b.height = d;
                    for (var e = 0, f = 0; f < this.datas.length; f++) {
                        var g = this.datas[f] * Math.PI * 2;
                        a.save(),
                            a.beginPath(),
                            a.fillStyle = b.colors[f],
                            a.moveTo(0, 0),
                            a.arc(0, 0, this.radius, e, e + g, !1),
                            a.fill(),
                            a.closePath(),
                            a.restore(),
                            a.beginPath(),
                            a.font = this.font;
                        var h = this.titles[f] + ": " + (100 * this.datas[f]).toFixed(2) + "%"
                            ,
                            i = a.measureText(h).width
                            ,
                            j = (a.measureText("田").width,
                            (e + e + g) / 2)
                            ,
                            k = this.radius * Math.cos(j)
                            ,
                            l = this.radius * Math.sin(j);
                        j > Math.PI / 2 && j <= Math.PI ? k -= i : j > Math.PI && j < 2 * Math.PI * 3 / 4 ? k -= i : j > 2 * Math.PI * .75,
                            a.fillStyle = "#FFFFFF",
                            a.fillText(h, k, l),
                            a.moveTo(this.radius * Math.cos(j), this.radius * Math.sin(j)),
                        j > Math.PI / 2 && j < 2 * Math.PI * 3 / 4 && (k -= i),
                        j > Math.PI,
                            a.fill(),
                            a.stroke(),
                            a.closePath(),
                            e += g
                    }
                }
                ,
                b
        }
        function c() {
            var b = new a.Node;
            return b.showSelected = !1,
                b.width = 250,
                b.height = 180,
                b.colors = ["#3666B0", "#2CA8E0", "#77D1F6"],
                b.datas = [.3, .3, .4],
                b.titles = ["A", "B", "C"],
                b.paint = function(a) {
                    var c = 3
                        ,
                        d = (this.width - c) / this.datas.length;
                    a.save(),
                        a.beginPath(),
                        a.fillStyle = "#FFFFFF",
                        a.strokeStyle = "#FFFFFF",
                        a.moveTo(-this.width / 2 - 1, -this.height / 2),
                        a.lineTo(-this.width / 2 - 1, this.height / 2 + 3),
                        a.lineTo(this.width / 2 + c + 1, this.height / 2 + 3),
                        a.stroke(),
                        a.closePath(),
                        a.restore();
                    for (var e = 0; e < this.datas.length; e++) {
                        a.save(),
                            a.beginPath(),
                            a.fillStyle = b.colors[e];
                        var f = this.datas[e]
                            ,
                            g = e * (d + c) - this.width / 2
                            ,
                            h = this.height - f - this.height / 2;
                        a.fillRect(g, h, d, f);
                        var i = "" + parseInt(this.datas[e])
                            ,
                            j = a.measureText(i).width
                            ,
                            k = a.measureText("田").width;
                        a.fillStyle = "#FFFFFF",
                            a.fillText(i, g + (d - j) / 2, h - k),
                            a.fillText(this.titles[e], g + (d - j) / 2, this.height / 2 + k),
                            a.fill(),
                            a.closePath(),
                            a.restore()
                    }
                }
                ,
                b
        }
        a.BarChartNode = c,
            a.PieChartNode = b
    }
    (JTopo),
    /*mark : Animate*/
    function(a) {
        function b(b, c) {
            var d, e = null ;
            return {
                stop: function() {
                    return d ? (window.clearInterval(d),
                    e && e.publish("stop"),
                        this) : this
                },
                start: function() {
                    var a = this;
                    return d = setInterval(function() {
                            b.call(a)
                        }
                        , c),
                        this
                },
                onStop: function(b) {
                    return null  == e && (e = new a.util.MessageBus),
                        e.subscribe("stop", b),
                        this
                }
            }
        }
        function c(a, c) {
            c = c || {};
            var d = c.gravity || .1
                ,
                e = c.dx || 0
                ,
                f = c.dy || 5
                ,
                g = c.stop
                ,
                h = c.interval || 30
                ,
                i = new b(function() {
                        g && g() ? (f = .5,
                            this.stop()) : (f += d,
                            a.setLocation(a.x + e, a.y + f))
                    }
                    ,h);
            return i
        }
        function d(a, c, d, e, f) {
            var g = 1e3 / 24
                ,
                h = {};
            for (var i in c) {
                var j = c[i]
                    ,
                    k = j - a[i];
                h[i] = {
                    oldValue: a[i],
                    targetValue: j,
                    step: k / d * g,
                    isDone: function(b) {
                        var c = this.step > 0 && a[b] >= this.targetValue || this.step < 0 && a[b] <= this.targetValue;
                        return c
                    }
                }
            }
            var l = new b(function() {
                    var b = !0;
                    for (var d in c)
                        h[d].isDone(d) || (a[d] += h[d].step,
                            b = !1);
                    if (b) {
                        if (!e)
                            return this.stop();
                        for (var d in c)
                            if (f) {
                                var g = h[d].targetValue;
                                h[d].targetValue = h[d].oldValue,
                                    h[d].oldValue = g,
                                    h[d].step = -h[d].step
                            } else
                                a[d] = h[d].oldValue
                    }
                    return this
                }
                ,g);
            return l
        }
        function e(a) {
            null  == a && (a = {});
            var b = a.spring || .1
                ,
                c = a.friction || .8
                ,
                d = a.grivity || 0
                ,
                e = (a.wind || 0,
                a.minLength || 0);
            return {
                items: [],
                timer: null ,
                isPause: !1,
                addNode: function(a, b) {
                    var c = {
                        node: a,
                        target: b,
                        vx: 0,
                        vy: 0
                    };
                    return this.items.push(c),
                        this
                },
                play: function(a) {
                    this.stop(),
                        a = null  == a ? 1e3 / 24 : a;
                    var b = this;
                    this.timer = setInterval(function() {
                            b.nextFrame()
                        }
                        , a)
                },
                stop: function() {
                    null  != this.timer && window.clearInterval(this.timer)
                },
                nextFrame: function() {
                    for (var a = 0; a < this.items.length; a++) {
                        var f = this.items[a]
                            ,
                            g = f.node
                            ,
                            h = f.target
                            ,
                            i = f.vx
                            ,
                            j = f.vy
                            ,
                            k = h.x - g.x
                            ,
                            l = h.y - g.y
                            ,
                            m = Math.atan2(l, k);
                        if (0 != e) {
                            var n = h.x - Math.cos(m) * e
                                ,
                                o = h.y - Math.sin(m) * e;
                            i += (n - g.x) * b,
                                j += (o - g.y) * b
                        } else
                            i += k * b,
                                j += l * b;
                        i *= c,
                            j *= c,
                            j += d,
                            g.x += i,
                            g.y += j,
                            f.vx = i,
                            f.vy = j
                    }
                }
            }
        }
        function f(a, b) {
            function c() {
                return e = setInterval(function() {
                        return o ? void f.stop() : (a.rotate += g || .2,
                            void (a.rotate > 2 * Math.PI && (a.rotate = 0)))
                    }
                    , 100),
                    f
            }
            function d() {
                return window.clearInterval(e),
                f.onStop && f.onStop(a),
                    f
            }
            var e = (b.context,
                    null )
                ,
                f = {}
                ,
                g = b.v;
            return f.run = c,
                f.stop = d,
                f.onStop = function(a) {
                    return f.onStop = a,
                        f
                }
                ,
                f
        }
        function g(a, b) {
            function c() {
                return window.clearInterval(g),
                h.onStop && h.onStop(a),
                    h
            }
            function d() {
                var d = b.dx || 0
                    ,
                    i = b.dy || 2;
                return g = setInterval(function() {
                        return o ? void h.stop() : (i += f,
                            void (a.y + a.height < e.stage.canvas.height ? a.setLocation(a.x + d, a.y + i) : (i = 0,
                                c())))
                    }
                    , 20),
                    h
            }
            var e = b.context
                ,
                f = b.gravity || .1
                ,
                g = null
                ,
                h = {};
            return h.run = d,
                h.stop = c,
                h.onStop = function(a) {
                    return h.onStop = a,
                        h
                }
                ,
                h
        }
        function h(b, c) {
            function d(c, d, e, f, g) {
                var h = new a.Node;
                return h.setImage(b.image),
                    h.setSize(b.width, b.height),
                    h.setLocation(c, d),
                    h.showSelected = !1,
                    h.dragable = !1,
                    h.paint = function(a) {
                        a.save(),
                            a.arc(0, 0, e, f, g),
                            a.clip(),
                            a.beginPath(),
                            null  != this.image ? a.drawImage(this.image, -this.width / 2, -this.height / 2) : (a.fillStyle = "rgba(" + this.style.fillStyle + "," + this.alpha + ")",
                                a.rect(-this.width / 2, -this.height / 2, this.width / 2, this.height / 2),
                                a.fill()),
                            a.closePath(),
                            a.restore()
                    }
                    ,
                    h
            }
            function e(c, e) {
                var f = c
                    ,
                    g = c + Math.PI
                    ,
                    h = d(b.x, b.y, b.width, f, g)
                    ,
                    j = d(b.x - 2 + 4 * Math.random(), b.y, b.width, f + Math.PI, f);
                b.visible = !1,
                    e.add(h),
                    e.add(j),
                    a.Animate.gravity(h, {
                        context: e,
                        dx: .3
                    }).run().onStop(function() {
                            e.remove(h),
                                e.remove(j),
                                i.stop()
                        }
                    ),
                    a.Animate.gravity(j, {
                        context: e,
                        dx: -.2
                    }).run()
            }
            function f() {
                return e(c.angle, h),
                    i
            }
            function g() {
                return i.onStop && i.onStop(b),
                    i
            }
            var h = c.context
                ,
                i = (b.style,
                {});
            return i.onStop = function(a) {
                return i.onStop = a,
                    i
            }
                ,
                i.run = f,
                i.stop = g,
                i
        }
        function i(a, b) {
            function c(a) {
                a.visible = !0,
                    a.rotate = Math.random();
                var b = g.stage.canvas.width / 2;
                a.x = b + Math.random() * (b - 100) - Math.random() * (b - 100),
                    a.y = g.stage.canvas.height,
                    a.vx = 5 * Math.random() - 5 * Math.random(),
                    a.vy = -25
            }
            function d() {
                return c(a),
                    h = setInterval(function() {
                            return o ? void i.stop() : (a.vy += f,
                                a.x += a.vx,
                                a.y += a.vy,
                                void ((a.x < 0 || a.x > g.stage.canvas.width || a.y > g.stage.canvas.height) && (i.onStop && i.onStop(a),
                                    c(a))))
                        }
                        , 50),
                    i
            }
            function e() {
                window.clearInterval(h)
            }
            var f = .8
                ,
                g = b.context
                ,
                h = null
                ,
                i = {};
            return i.onStop = function(a) {
                return i.onStop = a,
                    i
            }
                ,
                i.run = d,
                i.stop = e,
                i
        }
        function j() {
            o = !0
        }
        function k() {
            o = !1
        }
        function l(b, c) {
            function d() {
                return n = setInterval(function() {
                        if (o)
                            return void m.stop();
                        var a = f.y + h + Math.sin(k) * j;
                        b.setLocation(b.x, a),
                            k += l
                    }
                    , 100),
                    m
            }
            function e() {
                window.clearInterval(n)
            }
            var f = c.p1
                ,
                g = c.p2
                ,
                h = (c.context,
                f.x + (g.x - f.x) / 2)
                ,
                i = f.y + (g.y - f.y) / 2
                ,
                j = a.util.getDistance(f, g) / 2
                ,
                k = Math.atan2(i, h)
                ,
                l = c.speed || .2
                ,
                m = {}
                ,
                n = null ;
            return m.run = d,
                m.stop = e,
                m
        }
        function m(a, b) {
            function c() {
                return h = setInterval(function() {
                        if (o)
                            return void g.stop();
                        var b = e.x - a.x
                            ,
                            c = e.y - a.y
                            ,
                            h = b * f
                            ,
                            i = c * f;
                        a.x += h,
                            a.y += i,
                        .01 > h && .1 > i && d()
                    }
                    , 100),
                    g
            }
            function d() {
                window.clearInterval(h)
            }
            var e = b.position
                ,
                f = (b.context,
                b.easing || .2)
                ,
                g = {}
                ,
                h = null ;
            return g.onStop = function(a) {
                return g.onStop = a,
                    g
            }
                ,
                g.run = c,
                g.stop = d,
                g
        }
        function n(a, b) {
            function c() {
                return j = setInterval(function() {
                        a.scaleX += f,
                            a.scaleY += f,
                        a.scaleX >= e && d()
                    }
                    , 100),
                    i
            }
            function d() {
                i.onStop && i.onStop(a),
                    a.scaleX = g,
                    a.scaleY = h,
                    window.clearInterval(j)
            }
            var e = (b.position,
                    b.context,
                b.scale || 1)
                ,
                f = .06
                ,
                g = a.scaleX
                ,
                h = a.scaleY
                ,
                i = {}
                ,
                j = null ;
            return i.onStop = function(a) {
                return i.onStop = a,
                    i
            }
                ,
                i.run = c,
                i.stop = d,
                i
        }
        a.Animate = {},
            a.Effect = {};
        var o = !1;
        a.Effect.spring = e,
            a.Effect.gravity = c,
            a.Animate.stepByStep = d,
            a.Animate.rotate = f,
            a.Animate.scale = n,
            a.Animate.move = m,
            a.Animate.cycle = l,
            a.Animate.repeatThrow = i,
            a.Animate.dividedTwoPiece = h,
            a.Animate.gravity = g,
            a.Animate.startAll = k,
            a.Animate.stopAll = j
    }
    (JTopo),
    /*mark : find*/
    function(a) {
        function b(a, b) {
            var c = [];
            if (0 == a.length)
                return c;
            var d = b.match(/^\s*(\w+)\s*$/);
            if (null  != d) {
                var e = a.filter(function(a) {
                        return a.elementType == d[1]
                    }
                );
                null  != e && e.length > 0 && (c = c.concat(e))
            } else {
                var f = !1;
                if (d = b.match(/\s*(\w+)\s*\[\s*(\w+)\s*([>=<])\s*['"](\S+)['"]\s*\]\s*/),
                    (null  == d || d.length < 5) && (d = b.match(/\s*(\w+)\s*\[\s*(\w+)\s*([>=<])\s*(\d+(\.\d+)?)\s*\]\s*/),
                        f = !0),
                    null  != d && d.length >= 5) {
                    var g = d[1]
                        ,
                        h = d[2]
                        ,
                        i = d[3]
                        ,
                        j = d[4];
                    e = a.filter(function(a) {
                            if (a.elementType != g)
                                return !1;
                            var b = a[h];
                            return 1 == f && (b = parseInt(b)),
                                "=" == i ? b == j : ">" == i ? b > j : "<" == i ? j > b : "<=" == i ? j >= b : ">=" == i ? b >= j : "!=" == i ? b != j : !1
                        }
                    ),
                    null  != e && e.length > 0 && (c = c.concat(e))
                }
            }
            return c
        }
        function c(a) {
            if (a.find = function(a) {
                    return d.call(this, a)
                }
                    ,
                    e.forEach(function(b) {
                            a[b] = function(a) {
                                for (var c = 0; c < this.length; c++)
                                    this[c][b](a);
                                return this
                            }
                        }
                    ),
                a.length > 0) {
                var b = a[0];
                for (var c in b) {
                    var f = b[c];
                    "function" == typeof f && !
                        function(b) {
                            a[c] = function() {
                                for (var c = [], d = 0; d < a.length; d++)
                                    c.push(b.apply(a[d], arguments));
                                return c
                            }
                        }
                        (f)
                }
            }
            return a.attr = function(a, b) {
                if (null  != a && null  != b)
                    for (var c = 0; c < this.length; c++)
                        this[c][a] = b;
                else {
                    if (null  != a && "string" == typeof a) {
                        for (var d = [], c = 0; c < this.length; c++)
                            d.push(this[c][a]);
                        return d
                    }
                    if (null  != a)
                        for (var c = 0; c < this.length; c++)
                            for (var e in a)
                                this[c][e] = a[e]
                }
                return this
            }
                ,
                a
        }
        function d(d) {
            var e = []
                ,
                f = [];
            this instanceof a.Stage ? (e = this.childs,
                f = f.concat(e)) : this instanceof a.Scene ? e = [this] : f = this,
                e.forEach(function(a) {
                        f = f.concat(a.childs)
                    }
                );
            var g = null ;
            return g = "function" == typeof d ? f.filter(d) : b(f, d),
                g = c(g)
        }
        var e = "click,mousedown,mouseup,mouseover,mouseout,mousedrag,keydown,keyup".split(",");
        a.Stage.prototype.find = d,
            a.Scene.prototype.find = d
    }
    (JTopo),
    /*mark : logo*/
    function(a) {
        function b(a, b) {
            this.x = a,
                this.y = b
        }
        function c(a) {
            this.p = new b(0,0),
                this.w = new b(1,0),
                this.paint = a
        }
        function d(a, b, c) {
            return function(d) {
                for (var e = 0; b > e; e++)
                    a(),
                    c && d.turn(c),
                        d.move(3)
            }
        }
        function e(a, b) {
            var c = 2 * Math.PI;
            return function(d) {
                for (var e = 0; b > e; e++)
                    a(),
                        d.turn(c / b)
            }
        }
        function f(a, b, c) {
            return function(d) {
                for (var e = 0; b > e; e++)
                    a(),
                        d.resize(c)
            }
        }
        function g(a) {
            var b = 2 * Math.PI;
            return function(c) {
                for (var d = 0; a > d; d++)
                    c.forward(1),
                        c.turn(b / a)
            }
        }
        function h(a) {
            var b = 4 * Math.PI;
            return function(c) {
                for (var d = 0; a > d; d++)
                    c.forward(1),
                        c.turn(b / a)
            }
        }
        function i(a, b, c, d) {
            return function(e) {
                for (var f = 0; b > f; f++)
                    a(),
                        e.forward(1),
                        e.turn(c),
                        e.resize(d)
            }
        }
        var j = {};
        c.prototype.forward = function(a) {
            var b = this.p
                ,
                c = this.w;
            return b.x = b.x + a * c.x,
                b.y = b.y + a * c.y,
            this.paint && this.paint(b.x, b.y),
                this
        }
            ,
            c.prototype.move = function(a) {
                var b = this.p
                    ,
                    c = this.w;
                return b.x = b.x + a * c.x,
                    b.y = b.y + a * c.y,
                    this
            }
            ,
            c.prototype.moveTo = function(a, b) {
                return this.p.x = a,
                    this.p.y = b,
                    this
            }
            ,
            c.prototype.turn = function(a) {
                var b = (this.p,
                        this.w)
                    ,
                    c = Math.cos(a) * b.x - Math.sin(a) * b.y
                    ,
                    d = Math.sin(a) * b.x + Math.cos(a) * b.y;
                return b.x = c,
                    b.y = d,
                    this
            }
            ,
            c.prototype.resize = function(a) {
                var b = this.w;
                return b.x = b.x * a,
                    b.y = b.y * a,
                    this
            }
            ,
            c.prototype.save = function() {
                return null  == this._stack && (this._stack = []),
                    this._stack.push([this.p, this.w]),
                    this
            }
            ,
            c.prototype.restore = function() {
                if (null  != this._stack && this._stack.length > 0) {
                    var a = this._stack.pop();
                    this.p = a[0],
                        this.w = a[1]
                }
                return this
            }
            ,
            j.Tortoise = c,
            j.shift = d,
            j.spin = e,
            j.polygon = g,
            j.spiral = i,
            j.star = h,
            j.scale = f,
            a.Logo = j
    }
    (window);